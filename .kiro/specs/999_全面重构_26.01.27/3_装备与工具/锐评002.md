我是编码助手（锐评专家形态）。

🔒 专家私有备注：致老大
老大，Kiro 这次反应很快，而且是对的。

作为架构师，我通常追求完美（清理 ItemData），但作为开发者，Kiro 指出了 Unity 开发中最痛的一个点：修改 ScriptableObject 基类极其危险。 如果我们现在强行把 ItemData 里的字段删了或移走，Unity 可能会丢弃所有现有资产（几百个 SO 文件）里的数据，或者导致引用丢失。那时候我们就不是在“重构”，而是在“灾后重建”了。

Kiro 选择**“增量更新（Option A）”**是目前风险最小、收益最快的路径。他保住了现有的资产，同时开辟了装备的新战场。

我的决策： 批准他的选项 A。 但这不代表他可以偷懒。EquipmentData 必须设计得足够好，EquipmentService 的持久化必须一次做对。

✂️ 给执行智能体 (Kiro) 的回复与指令
指令来源： 架构审查委员会 (Code Reaper) 任务代号： Operation Arsenal (军火库行动) - Tactical Adjustment 状态回复： 异议有效，批准选项 A (Objection Valid, Option A Approved)

Kiro，警觉性不错。

你对修改 ItemData 基类风险的评估是准确的。在 Unity 中大规模重构 ScriptableObject 继承关系确实容易导致现有资产数据丢失。我们现在的首要目标是**“上线装备系统”，而不是“炸毁现有资产”**。

我批准执行【选项 A：渐进式重构】。

但请注意，虽然我们在基类上妥协了，但在新功能上必须寸步不让。

更新后的执行指令 (Revised Orders):

请立即按照 选项 A 更新你的文档 (requirements.md, design.md, tasks.md)，重点关注以下细节：

1. 关于 EquipmentData (新增)
继承关系：public class EquipmentData : ItemData

要求：虽然继承了臃肿的 ItemData，但你的 EquipmentData 必须包含装备特有的字段：

EquipmentType equipmentType (覆盖基类的通用定义，或者复用枚举但要在逻辑中强制检查)

int defense (防御力)

List<StatModifier> attributes (预留给力量/敏捷等属性)

GameObject equipmentModel (预留给纸娃娃系统)

2. 关于 Tool_BatchItemSOGenerator (扩展)
要求：

不要重写整个工具，但在 DrawTypeSpecificSettings 中必须新增 EquipmentData 的绘制逻辑。

必须实现：在生成装备 SO 时，自动设置其 equipmentType 字段（例如：生成“皮帽”时，自动设为 Helmet）。不要让策划手动去选。

3. 关于 EquipmentService (核心)
这是 P0 级任务：

必须将内部存储结构从 ItemStack 升级为 InventoryItem。

必须实现 IPersistentObject。

槽位限制：在 EquipItem 方法中，必须检查 item.Data.equipmentType 是否匹配目标槽位（例如：戒指不能戴在头上）。

立即执行动作：

更新文档：根据上述妥协方案，更新 3_装备与工具 目录下的三份文档。

提交审核：文档更新后告诉我。

待命：审核通过后开始代码实现。

别磨蹭了，去写文档。