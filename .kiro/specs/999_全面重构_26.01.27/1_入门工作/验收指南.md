# Operation Backpack 验收指南

## 场景配置（必须先做！）

### 1. 添加 SaveManager
1. 在场景中创建空 GameObject，命名为 `[SaveManager]`
2. 添加组件：`SaveManager`（位于 `FarmGame.Data.Core` 命名空间）
3. 配置：
   - `Show Debug Info`: ✅ 勾选
   - `Pretty Print Json`: ✅ 勾选

### 2. 添加调试 UI
1. 在场景中创建空 GameObject，命名为 `[DebugUI]`
2. 添加组件：`SaveLoadDebugUI`
3. 添加组件：`DurabilityTestUI`

运行游戏后，左上角会出现两个调试面板。

---

## 验收测试流程

### 测试 1：耐久度显示

1. **运行游戏**
2. **确保 Hotbar 第一格有工具**（如斧头、锄头）
3. **点击"给工具添加耐久度"按钮**
4. **预期结果**：
   - [ ] Hotbar 槽位底部出现绿色耐久度条
   - [ ] 调试面板显示 `100/100 (100%)`

### 测试 2：耐久度消耗

1. **点击"消耗耐久"按钮**（或按 U 键）
2. **预期结果**：
   - [ ] 耐久度条变短
   - [ ] 颜色从绿色逐渐变为黄色、红色
   - [ ] 调试面板显示 `90/100 (90%)`

### 测试 3：存档功能

1. **消耗几次耐久度**，让耐久度降到 50% 左右
2. **点击"保存"按钮**（或按 F5）
3. **预期结果**：
   - [ ] 状态显示"已保存到 slot1"
   - [ ] Console 输出保存成功日志

### 测试 4：读档功能

1. **停止游戏**
2. **重新运行游戏**
3. **点击"加载"按钮**（或按 F9）
4. **预期结果**：
   - [ ] 状态显示"已加载 slot1"
   - [ ] 耐久度条恢复到保存时的状态（50% 左右）
   - [ ] 颜色与保存时一致

---

## 快捷键

| 按键 | 功能 |
|------|------|
| F5 | 保存游戏 |
| F9 | 加载游戏 |
| U | 消耗当前工具耐久度 |

---

## 存档文件位置

存档保存在：
```
%USERPROFILE%\AppData\LocalLow\{公司名}\{项目名}\Saves\slot1.json
```

可以在 SaveManager 组件上右键 → "打开存档目录" 查看。

---

## 已知限制

1. **耐久度需要手动添加**：目前物品默认没有耐久度，需要通过调试 UI 添加
2. **工具使用不会自动消耗耐久**：需要后续接入工具使用逻辑
3. **TimeManager 数据暂未保存**：时间系统的存档/读档待实现

---

## 故障排除

### 问题：看不到调试 UI
- 检查是否添加了 `SaveLoadDebugUI` 和 `DurabilityTestUI` 组件
- 检查 Canvas 是否被其他 UI 遮挡

### 问题：保存失败
- 检查是否添加了 `SaveManager` 组件
- 查看 Console 的错误日志

### 问题：耐久度条不显示
- 确保物品有耐久度（点击"添加耐久度"按钮）
- 检查 `InventorySlotUI` 和 `ToolbarSlotUI` 是否正确更新

---

**文档更新**: 2026-01-28
