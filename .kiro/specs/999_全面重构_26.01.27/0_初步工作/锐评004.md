指令来源： 架构审查委员会 (Code Reaper) 情报更新： 已通过全量代码快照核实依赖关系 状态回复： 批准手术方案 (Surgical Plan Approved)

Kiro，你的侦察非常准确。

我已核实了 TreeController.cs 和 OcclusionTransparency.cs 的源码。简单地删除旧文件确实会导致 OcclusionTransparency 崩溃，因为它在使用 tree.GetCurrentStage() == GrowthStage.Seed 这种旧式写法。

现在执行 Phase 1: 第二战场（树木系统）的终结行动。请严格按以下步骤操作，这将涉及代码逻辑的移植，而不仅仅是文件操作。

Step 1: 枚举保全 (Extraction)
在 Assets/YYY_Scripts/Data/Enums/ 下创建新文件 TreeEnums.cs。

将旧版 TreeController.cs 中的 public enum GrowthStage 和 public enum TreeState 剪切/复制到这个新文件中。

注意：保留原本的枚举值，确保其他系统（如存档数据）如果用了枚举名不会断裂。

Step 2: 逻辑适配 (Adaptation)
在执行重命名之前，你需要先通过修改代码来适配逻辑。

打开 Assets/YYY_Scripts/Service/Rendering/OcclusionTransparency.cs。

定位：找到 OnTriggerEnter2D 和 OnTriggerExit2D 中引用 TreeController 的部分。

预判修改：

你即将把 TreeControllerV2 重命名为 TreeController。

新的 TreeController (原 V2) 使用 currentStageIndex (int) 而不是 GetCurrentStage() (enum)。

因此，你需要将 tree.GetCurrentStage() == GrowthStage.Seed 修改为判断 tree.currentStageIndex == 0 (假设 0 是种子阶段，请在 V2 代码中确认)。

提示：如果不想现在改逻辑，可以暂时注释掉相关行，标记 // TODO: Fix occlusion logic for new TreeController，首要目标是编译通过。

Step 3: 处决与正位 (Execution)
物理删除：删除旧版 Assets/YYY_Scripts/Controller/TreeController.cs。

正位重构：将 Assets/YYY_Scripts/Controller/TreeControllerV2.cs 重命名为 -> TreeController.cs (类名同步修改)。

清理战场：确保没有 TreeControllerV2 的残留引用。

最终任务：结项汇报
完成上述操作后，请触发 Unity 编译（或模拟编译检查）。 如果所有红色的错误都消失了，请向我提交：

Operation Clean Slate 结项报告

放置系统：已清理

树木系统：已清理（枚举已提取）

农田系统：已清理

编译状态：PASS

动手吧，Kiro。这是最后的障碍。