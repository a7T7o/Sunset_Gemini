# Specs å·¥ä½œåŒºç»“æ„å·¡æ£€æŠ¥å‘Š

## æœ€åå·¡æ£€æ—¥æœŸï¼š2026-01-24

---

## ä¸€ã€å·¡æ£€æ ‡å‡†

åŸºäº `.kiro/steering/maintenance-guidelines.md` ç¬¬åç« ï¼š

- âœ… memory.md å­—ç¬¦æ•° â‰¤ 3,000
- âœ… æœ‰åˆ†å±‚ç»“æ„ï¼ˆdesign / phases / reviews ç­‰ï¼‰
- âœ… ä¼šè¯æ‘˜è¦åªæœ‰ 2-3 è¡Œ + é“¾æ¥
- âœ… è·¨å·¥ä½œåŒºé—®é¢˜æœ‰ç´¢å¼•ï¼Œæ— å…¨æ–‡ç²˜è´´

---

## äºŒã€å·¥ä½œåŒºçŠ¶æ€æ±‡æ€»

### 2.1 æ´»è·ƒå·¥ä½œåŒºï¼ˆ002_After_26.1.21 ä¹‹åï¼‰

| å·¥ä½œåŒº | æœ€æ–°å­ä»»åŠ¡ | çŠ¶æ€ | memory å­—ç¬¦æ•° | ç»“æ„ |
|--------|-----------|------|--------------|------|
| ç‰©å“æ”¾ç½®ç³»ç»Ÿ | 8_æ”¾ç½®ç³»ç»Ÿå¤šé—®é¢˜ä¿®å¤ | âœ… å·²å®Œæˆ | ~8,000 | âœ… åˆ†å±‚ |
| ç®±å­ç³»ç»Ÿ | 8_æˆ˜åæ¸…æ‰« | âœ… å·²å®Œæˆ | ~2,800 | âœ… åˆ†å±‚ |
| UIç³»ç»Ÿ | 4_ä»£ç å®¡æ ¸ä¸ä¼˜åŒ– | âœ… å·²å®Œæˆ | ~2,500 | âœ… åˆ†å±‚ |
| å†œç”°ç³»ç»Ÿ | 1_å†œç”°ç³»ç»Ÿå…¨é¢è°ƒç ” | ğŸ”„ è°ƒç ”ä¸­ | ~1,500 | âœ… åˆ†å±‚ |
| SOè®¾è®¡ç³»ç»Ÿ | 1_IDè§„èŒƒå’Œç®¡ç†å™¨ä¿®å¤ | âœ… å·²å®Œæˆ | ~1,200 | âœ… åˆ†å±‚ |

### 2.2 å½’æ¡£å·¥ä½œåŒºï¼ˆ001_BeFore_26.1.21ï¼‰

| å·¥ä½œåŒº | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|
| å¯¼èˆªç³»ç»Ÿé‡æ„ | âœ… å·²å®Œæˆ | å« NavGrid2D é‡æ„ã€å³é”®äº¤äº’ä¿®å¤ |
| æ ‘æœ¨ç³»ç»Ÿ | âœ… å·²å®Œæˆ | 6é˜¶æ®µç”Ÿé•¿ã€ç ä¼ã€å¯¼èˆªåŒæ­¥ |
| ç æ ‘ç³»ç»Ÿ | âœ… å·²å®Œæˆ | åˆå¹¶åˆ°æ ‘æœ¨ç³»ç»Ÿ |
| ç æ ‘ç³»ç»Ÿä¼˜åŒ– | âœ… å·²å®Œæˆ | æˆé•¿è¾¹è·æ£€æµ‹é‡æ„ |
| çŸ¿çŸ³ç³»ç»Ÿ | âœ… å·²å®Œæˆ | StoneController ä¼˜åŒ– |
| é®æŒ¡ä¸å¯¼èˆª | âœ… å·²å®Œæˆ | OcclusionManager å®ç° |
| ç‰©å“æ‰è½æ‹¾å– | âœ… å·²å®Œæˆ | WorldItemDrop/Pickup |
| ä¸–ç•Œç‰©å“ç³»ç»Ÿ | âœ… å·²å®Œæˆ | ä¸¢å¼ƒç‰©é¢„åˆ¶ä½“ç»Ÿä¸€ |
| èƒŒåŒ…å›¾æ ‡æ—‹è½¬ | âœ… å·²å®Œæˆ | UIItemIconScaler |
| èƒŒåŒ…æ³¨å…¥ç³»ç»Ÿä¼˜åŒ– | âœ… å·²å®Œæˆ | InventoryBootstrap |
| å·¥å…·åŠ¨ç”»é‡æ„ | âœ… å·²å®Œæˆ | åŠ¨ç”»ç³»ç»Ÿ Mode A++ |
| åŠ¨ç”»ç³»ç»Ÿ | âœ… å·²å®Œæˆ | å¸§åŒæ­¥æœºåˆ¶ |
| æ‘„åƒå¤´æ­»åŒºåŒæ­¥ | âœ… å·²å®Œæˆ | Cinemachine é…ç½® |
| ç¼–è¾‘å™¨å·¥å…· | âœ… å·²å®Œæˆ | æ‰¹é‡ SO ç”Ÿæˆå™¨ |
| å…¨å±€è°ƒè¯•ç³»ç»Ÿ | âœ… å·²å®Œæˆ | è°ƒè¯•å¼€å…³ç³»ç»Ÿ |
| ç‰©å“æ˜¾ç¤ºå°ºå¯¸ç»Ÿä¸€ | âœ… å·²å®Œæˆ | å›¾æ ‡ç¼©æ”¾è§„èŒƒ |

### 2.3 å¾…å¼€å‘å·¥ä½œåŒº

| å·¥ä½œåŒº | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|
| äº‘æœµé®æŒ¡ç³»ç»Ÿ | â¸ï¸ æš‚åœ | æœ‰ old æ–‡æ¡£ï¼Œå¾…é‡å¯ |
| åˆ¶ä½œå°ç³»ç»Ÿ | â¸ï¸ æš‚åœ | æœ‰ old æ–‡æ¡£ï¼Œå¾…é‡å¯ |
| æŠ€èƒ½ç­‰çº§ç³»ç»Ÿ | â¸ï¸ æš‚åœ | æœ‰ old æ–‡æ¡£ï¼Œå¾…é‡å¯ |
| Steeringè§„åˆ™åŒºä¼˜åŒ– | âœ… å·²å®Œæˆ | è§„åˆ™åˆ†å±‚å®Œæˆ |

---

## ä¸‰ã€ä»£ç æ¶æ„æ¦‚è§ˆ

### 3.1 æ ¸å¿ƒç›®å½•ç»“æ„

```
Assets/YYY_Scripts/
â”œâ”€â”€ Anim/                    # åŠ¨ç”»ç³»ç»Ÿ
â”‚   â”œâ”€â”€ Player/              # ç©å®¶åŠ¨ç”»æ§åˆ¶
â”‚   â””â”€â”€ NPC/                 # NPC åŠ¨ç”»æ§åˆ¶
â”‚
â”œâ”€â”€ Combat/                  # æˆ˜æ–—ç³»ç»Ÿ
â”‚   â”œâ”€â”€ PlayerToolHitEmitter.cs    # å·¥å…·å‘½ä¸­å‘å°„å™¨
â”‚   â””â”€â”€ ResourceNodeRegistry.cs    # èµ„æºèŠ‚ç‚¹æ³¨å†Œè¡¨
â”‚
â”œâ”€â”€ Controller/              # æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ Input/               # è¾“å…¥æ§åˆ¶
â”‚   â”‚   â””â”€â”€ GameInputManager.cs    # æ¸¸æˆè¾“å…¥ç®¡ç†å™¨
â”‚   â”œâ”€â”€ Player/              # ç©å®¶æ§åˆ¶
â”‚   â”œâ”€â”€ TreeControllerV2.cs  # æ ‘æœ¨æ§åˆ¶å™¨ï¼ˆ6é˜¶æ®µï¼‰
â”‚   â”œâ”€â”€ RockController.cs    # å²©çŸ³æ§åˆ¶å™¨
â”‚   â””â”€â”€ StoneController.cs   # çŸ¿çŸ³æ§åˆ¶å™¨
â”‚
â”œâ”€â”€ Core/                    # æ ¸å¿ƒæ¡†æ¶
â”‚   â”œâ”€â”€ Events/              # äº‹ä»¶ç³»ç»Ÿ
â”‚   â”œâ”€â”€ Pool/                # å¯¹è±¡æ± 
â”‚   â””â”€â”€ Services/            # æœåŠ¡åŸºç±»
â”‚
â”œâ”€â”€ Data/                    # æ•°æ®å®šä¹‰
â”‚   â”œâ”€â”€ Database/            # æ•°æ®åº“
â”‚   â”œâ”€â”€ Enums/               # æšä¸¾å®šä¹‰
â”‚   â”œâ”€â”€ Items/               # ç‰©å“ SO å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ ItemData.cs      # ç‰©å“åŸºç±»
â”‚   â”‚   â”œâ”€â”€ ToolData.cs      # å·¥å…·æ•°æ®
â”‚   â”‚   â”œâ”€â”€ SaplingData.cs   # æ ‘è‹—æ•°æ®
â”‚   â”‚   â”œâ”€â”€ StorageData.cs   # ç®±å­æ•°æ®
â”‚   â”‚   â”œâ”€â”€ PlaceableItemData.cs  # å¯æ”¾ç½®ç‰©å“åŸºç±»
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ Recipes/             # é…æ–¹æ•°æ®
â”‚
â”œâ”€â”€ Farm/                    # å†œç”°ç³»ç»Ÿ
â”‚   â”œâ”€â”€ FarmingManager.cs    # å†œç”°ç®¡ç†å™¨
â”‚   â”œâ”€â”€ CropController.cs    # ä½œç‰©æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ CropGrowthSystem.cs  # ä½œç‰©ç”Ÿé•¿ç³»ç»Ÿ
â”‚   â””â”€â”€ FarmTileData.cs      # å†œç”°æ ¼å­æ•°æ®
â”‚
â”œâ”€â”€ Service/                 # æœåŠ¡å±‚
â”‚   â”œâ”€â”€ Camera/              # æ‘„åƒå¤´æœåŠ¡
â”‚   â”œâ”€â”€ Crafting/            # åˆ¶ä½œæœåŠ¡
â”‚   â”œâ”€â”€ Equipment/           # è£…å¤‡æœåŠ¡
â”‚   â”œâ”€â”€ Inventory/           # èƒŒåŒ…æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ InventoryService.cs      # èƒŒåŒ…æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ChestInventory.cs        # ç®±å­èƒŒåŒ…
â”‚   â”‚   â”œâ”€â”€ InventorySortService.cs  # æ’åºæœåŠ¡
â”‚   â”‚   â””â”€â”€ IItemContainer.cs        # å®¹å™¨æ¥å£
â”‚   â”œâ”€â”€ Navigation/          # å¯¼èˆªæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ NavGrid2D.cs     # 2D å¯¼èˆªç½‘æ ¼
â”‚   â”‚   â””â”€â”€ INavigationUnit.cs
â”‚   â”œâ”€â”€ Placement/           # æ”¾ç½®æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ PlacementManagerV3.cs    # æ”¾ç½®ç®¡ç†å™¨ V3
â”‚   â”‚   â”œâ”€â”€ PlacementValidatorV3.cs  # æ”¾ç½®éªŒè¯å™¨ V3
â”‚   â”‚   â”œâ”€â”€ PlacementPreviewV3.cs    # æ”¾ç½®é¢„è§ˆ V3
â”‚   â”‚   â””â”€â”€ PlacementGridCalculator.cs
â”‚   â”œâ”€â”€ Player/              # ç©å®¶æœåŠ¡
â”‚   â”‚   â””â”€â”€ PlayerAutoNavigator.cs   # è‡ªåŠ¨å¯¼èˆª
â”‚   â”œâ”€â”€ Rendering/           # æ¸²æŸ“æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ OcclusionManager.cs      # é®æŒ¡ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ OcclusionTransparency.cs # é®æŒ¡é€æ˜ç»„ä»¶
â”‚   â”‚   â””â”€â”€ CloudShadowManager.cs    # äº‘æœµé˜´å½±
â”‚   â”œâ”€â”€ TimeManager.cs       # æ—¶é—´ç®¡ç†å™¨
â”‚   â”œâ”€â”€ SeasonManager.cs     # å­£èŠ‚ç®¡ç†å™¨
â”‚   â””â”€â”€ WeatherSystem.cs     # å¤©æ°”ç³»ç»Ÿ
â”‚
â”œâ”€â”€ UI/                      # UI ç³»ç»Ÿ
â”‚   â”œâ”€â”€ Box/                 # ç®±å­ UI
â”‚   â”‚   â””â”€â”€ BoxPanelUI.cs    # ç®±å­é¢æ¿
â”‚   â”œâ”€â”€ Crafting/            # åˆ¶ä½œ UI
â”‚   â”œâ”€â”€ Inventory/           # èƒŒåŒ… UI
â”‚   â”‚   â”œâ”€â”€ InventoryPanelUI.cs      # èƒŒåŒ…é¢æ¿
â”‚   â”‚   â”œâ”€â”€ InventorySlotUI.cs       # æ§½ä½ UI
â”‚   â”‚   â”œâ”€â”€ InventorySlotInteraction.cs  # æ§½ä½äº¤äº’
â”‚   â”‚   â”œâ”€â”€ InventoryInteractionManager.cs  # äº¤äº’ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ HeldItemDisplay.cs       # æ‰‹æŒç‰©å“æ˜¾ç¤º
â”‚   â”‚   â””â”€â”€ SlotDragContext.cs       # æ‹–æ‹½ä¸Šä¸‹æ–‡
â”‚   â”œâ”€â”€ Tabs/                # æ ‡ç­¾é¡µ
â”‚   â”‚   â””â”€â”€ PackagePanelTabsUI.cs    # é¢æ¿æ ‡ç­¾
â”‚   â”œâ”€â”€ Toolbar/             # å·¥å…·æ 
â”‚   â””â”€â”€ Utility/             # UI å·¥å…·
â”‚       â””â”€â”€ UIItemIconScaler.cs      # å›¾æ ‡ç¼©æ”¾å™¨
â”‚
â”œâ”€â”€ World/                   # ä¸–ç•Œç³»ç»Ÿ
â”‚   â”œâ”€â”€ Placeable/           # å¯æ”¾ç½®ç‰©å“
â”‚   â”‚   â”œâ”€â”€ ChestController.cs       # ç®±å­æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ ChestDropHandler.cs      # ç®±å­æ‰è½å¤„ç†
â”‚   â”œâ”€â”€ WorldItemDrop.cs     # ä¸–ç•Œç‰©å“æ‰è½
â”‚   â”œâ”€â”€ WorldItemPickup.cs   # ä¸–ç•Œç‰©å“æ‹¾å–
â”‚   â”œâ”€â”€ WorldItemPool.cs     # ä¸–ç•Œç‰©å“æ± 
â”‚   â””â”€â”€ WorldSpawnService.cs # ä¸–ç•Œç”ŸæˆæœåŠ¡
â”‚
â””â”€â”€ Interfaces/              # æ¥å£å®šä¹‰
    â”œâ”€â”€ IInteractable.cs     # å¯äº¤äº’æ¥å£
    â””â”€â”€ IResourceNode.cs     # èµ„æºèŠ‚ç‚¹æ¥å£
```

### 3.2 å…³é”®ç³»ç»Ÿä¾èµ–å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        UI å±‚                                â”‚
â”‚  PackagePanelTabsUI â”€â”€â”€ InventoryPanelUI â”€â”€â”€ BoxPanelUI    â”‚
â”‚         â”‚                    â”‚                   â”‚          â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                              â–¼                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      Service å±‚                             â”‚
â”‚  InventoryService â—„â”€â”€â”€ ChestInventory                      â”‚
â”‚         â”‚                    â”‚                              â”‚
â”‚         â–¼                    â–¼                              â”‚
â”‚  PlacementManagerV3 â”€â”€â”€ PlacementValidatorV3               â”‚
â”‚         â”‚                    â”‚                              â”‚
â”‚         â–¼                    â–¼                              â”‚
â”‚  NavGrid2D â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ OcclusionManager                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     Controller å±‚                           â”‚
â”‚  TreeControllerV2 â”€â”€â”€ ChestController â”€â”€â”€ RockController   â”‚
â”‚         â”‚                    â”‚                   â”‚          â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                              â–¼                              â”‚
â”‚                    ResourceNodeRegistry                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                       Data å±‚                               â”‚
â”‚  ItemData â—„â”€â”€ ToolData / SaplingData / StorageData / ...   â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  ItemDatabase (ScriptableObject)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å››ã€åœºæ™¯å±‚çº§ç»“æ„

### 4.1 å½“å‰åœºæ™¯ä¿¡æ¯

- **åœºæ™¯åç§°**: Primary.unity
- **NavGrid ä¿¡æ¯**: 128x152=19456 å•å…ƒï¼Œéšœç¢ç‰©=342
- **ä¸–ç•Œè¾¹ç•Œ**: Origin=(-46.00, -22.00), Size=(64.00, 76.00)

### 4.2 æ ‡å‡†åœºæ™¯å±‚çº§

```
Scene
â”œâ”€â”€ â”€â”€â”€ LAYER 1 â”€â”€â”€ ï¼ˆä¸€æ¥¼ï¼‰
â”‚   â”œâ”€â”€ Props/                    # åœºæ™¯ç‰©ä½“
â”‚   â”‚   â”œâ”€â”€ Trees/                # æ ‘æœ¨ï¼ˆTreeControllerV2ï¼‰
â”‚   â”‚   â”œâ”€â”€ Rocks/                # çŸ³å¤´ï¼ˆRockControllerï¼‰
â”‚   â”‚   â”œâ”€â”€ Chests/               # ç®±å­ï¼ˆChestControllerï¼‰
â”‚   â”‚   â””â”€â”€ Buildings/            # å»ºç­‘
â”‚   â””â”€â”€ Tilemaps/                 # åœ°é¢ Tilemap
â”‚       â”œâ”€â”€ GroundBase            # åœ°é¢åŸºç¡€
â”‚       â”œâ”€â”€ Grass                 # è‰åœ°è£…é¥°
â”‚       â”œâ”€â”€ Wall                  # å¢™å£/è¾¹ç•Œ
â”‚       â””â”€â”€ Farmland              # è€•åœ°
â”‚
â”œâ”€â”€ â”€â”€â”€ LAYER 2 â”€â”€â”€ ï¼ˆäºŒæ¥¼ï¼‰
â”‚   â””â”€â”€ [åŒ LAYER 1 ç»“æ„]
â”‚
â”œâ”€â”€ â”€â”€â”€ LAYER 3 â”€â”€â”€ ï¼ˆä¸‰æ¥¼ï¼‰
â”‚   â””â”€â”€ [åŒ LAYER 1 ç»“æ„]
â”‚
â”œâ”€â”€ â”€â”€â”€ DYNAMIC â”€â”€â”€
â”‚   â””â”€â”€ Player                    # ç©å®¶
â”‚       â”œâ”€â”€ PlayerController
â”‚       â”œâ”€â”€ PlayerAnimator
â”‚       â”œâ”€â”€ Collider2D
â”‚       â””â”€â”€ PlayerAutoNavigator
â”‚
â”œâ”€â”€ â”€â”€â”€ MANAGERS â”€â”€â”€
â”‚   â”œâ”€â”€ TimeManager               # æ—¶é—´ç®¡ç†
â”‚   â”œâ”€â”€ SeasonManager             # å­£èŠ‚ç®¡ç†
â”‚   â”œâ”€â”€ FarmingManager            # å†œç”°ç®¡ç†
â”‚   â”œâ”€â”€ NavGrid2D                 # å¯¼èˆªç½‘æ ¼
â”‚   â”œâ”€â”€ OcclusionManager          # é®æŒ¡ç®¡ç†
â”‚   â”œâ”€â”€ PlacementManagerV3        # æ”¾ç½®ç®¡ç†
â”‚   â”œâ”€â”€ ResourceNodeRegistry      # èµ„æºèŠ‚ç‚¹æ³¨å†Œ
â”‚   â””â”€â”€ WorldItemPool             # ä¸–ç•Œç‰©å“æ± 
â”‚
â””â”€â”€ â”€â”€â”€ UI â”€â”€â”€
    â””â”€â”€ Canvas
        â”œâ”€â”€ PackagePanel          # èƒŒåŒ…é¢æ¿
        â”‚   â”œâ”€â”€ TabButtons        # æ ‡ç­¾æŒ‰é’®
        â”‚   â”œâ”€â”€ InventoryPanel    # èƒŒåŒ…å†…å®¹
        â”‚   â””â”€â”€ BoxUIRoot         # ç®±å­ UI å®¹å™¨
        â”œâ”€â”€ Toolbar               # å·¥å…·æ 
        â”œâ”€â”€ ItemTooltip           # ç‰©å“æç¤º
        â””â”€â”€ HeldItemDisplay       # æ‰‹æŒç‰©å“æ˜¾ç¤º
```

### 4.3 å…³é”®ç‰©ä½“ç»„ä»¶æ¸…å•

#### Playerï¼ˆç©å®¶ï¼‰
| ç»„ä»¶ | è¯´æ˜ |
|------|------|
| Transform | ä½ç½®/æ—‹è½¬/ç¼©æ”¾ |
| Rigidbody2D | ç‰©ç†åˆšä½“ |
| CapsuleCollider2D | ç¢°æ’ä½“ï¼ˆç”¨äºä½ç½®ä¸­å¿ƒè®¡ç®—ï¼‰ |
| Animator | åŠ¨ç”»æ§åˆ¶å™¨ |
| SpriteRenderer | ç²¾çµæ¸²æŸ“ |
| PlayerController | ç©å®¶æ§åˆ¶è„šæœ¬ |
| PlayerAutoNavigator | è‡ªåŠ¨å¯¼èˆªè„šæœ¬ |
| DynamicSortingOrder | åŠ¨æ€æ’åº |

#### TreeControllerV2ï¼ˆæ ‘æœ¨ï¼‰
| ç»„ä»¶ | è¯´æ˜ |
|------|------|
| Transform | ä½ç½® = æ ‘æ ¹ = ç§æ¤ç‚¹ |
| Rigidbody2D (Static) | é™æ€åˆšä½“ |
| CompositeCollider2D | å¤åˆç¢°æ’ä½“ |
| OcclusionTransparency | é®æŒ¡é€æ˜ |
| TreeControllerV2 | æ ‘æœ¨æ§åˆ¶è„šæœ¬ |
| å­ç‰©ä½“ Tree | SpriteRenderer + PolygonCollider2D |
| å­ç‰©ä½“ Shadow | SpriteRendererï¼ˆé˜´å½±ï¼‰ |

#### ChestControllerï¼ˆç®±å­ï¼‰
| ç»„ä»¶ | è¯´æ˜ |
|------|------|
| Transform | ä½ç½®ï¼ˆåº•éƒ¨å¯¹é½åï¼‰ |
| SpriteRenderer | ç²¾çµæ¸²æŸ“ |
| BoxCollider2D | ç¢°æ’ä½“ |
| ChestController | ç®±å­æ§åˆ¶è„šæœ¬ |
| ChestInventory | ç®±å­èƒŒåŒ… |
| OcclusionTransparency | é®æŒ¡é€æ˜ |

#### NavGrid2Dï¼ˆå¯¼èˆªç½‘æ ¼ï¼‰
| ç»„ä»¶ | è¯´æ˜ |
|------|------|
| NavGrid2D | å¯¼èˆªç½‘æ ¼è„šæœ¬ |
| cellSize | 0.5f |
| obstacleTags | Tree, Rock, Building, Chest |

#### OcclusionManagerï¼ˆé®æŒ¡ç®¡ç†å™¨ï¼‰
| ç»„ä»¶ | è¯´æ˜ |
|------|------|
| OcclusionManager | é®æŒ¡ç®¡ç†è„šæœ¬ |
| detectionInterval | 0.1s |
| detectionRadius | 8 å•ä½ |
| æ”¯æŒé¢„è§ˆé®æŒ¡æ£€æµ‹ | SetPreviewBounds() |

---

## äº”ã€Sorting Layers é…ç½®

| åºå· | Sorting Layer | ç”¨é€” |
|------|---------------|------|
| 1 | Background | èƒŒæ™¯ |
| 2 | Ground | åœ°é¢ Tilemap |
| 3 | Layer 1 | ä¸€æ¥¼ç‰©ä½“ |
| 4 | Layer 2 | äºŒæ¥¼ç‰©ä½“ |
| 5 | Layer 3 | ä¸‰æ¥¼ç‰©ä½“ |
| 6 | Effects | ç‰¹æ•ˆ |
| 7 | CloudShadow | äº‘æœµé˜´å½± |
| 8 | UI | ç”¨æˆ·ç•Œé¢ |

---

## å…­ã€Tags é…ç½®

| æ ‡ç­¾ | ç”¨é€” | ä½¿ç”¨ç»„ä»¶ |
|------|------|---------|
| Player | ç©å®¶ | PlayerController |
| Tree | æ ‘æœ¨ | TreeControllerV2 |
| Rock | å²©çŸ³ | RockController |
| Building | å»ºç­‘ | - |
| Chest | ç®±å­ | ChestController |
| Interactable | å¯äº¤äº’ç‰©ä½“ | IInteractable å®ç°ç±» |
| Placed | å·²æ”¾ç½®ç‰©å“ | æ”¾ç½®ç³»ç»Ÿæ ‡è®° |

---

## ä¸ƒã€ç³»ç»Ÿé—´å…³é”®æ¥å£

### 7.1 IInteractableï¼ˆå¯äº¤äº’æ¥å£ï¼‰

```csharp
public interface IInteractable
{
    bool CanInteract(Transform player);
    void OnInteract(Transform player);
    Vector3 GetInteractionPoint();
    float GetInteractionRadius();
}
```

**å®ç°ç±»**: ChestController, WorkstationController

### 7.2 IResourceNodeï¼ˆèµ„æºèŠ‚ç‚¹æ¥å£ï¼‰

```csharp
public interface IResourceNode
{
    void OnHit(HitContext ctx);
    Bounds GetBounds();
    bool IsAlive { get; }
}
```

**å®ç°ç±»**: TreeControllerV2, RockController, StoneController

### 7.3 IItemContainerï¼ˆç‰©å“å®¹å™¨æ¥å£ï¼‰

```csharp
public interface IItemContainer
{
    int Capacity { get; }
    ItemStack GetSlot(int index);
    bool SetSlot(int index, ItemStack stack);
    event Action<int> OnSlotChanged;
}
```

**å®ç°ç±»**: InventoryService, ChestInventory

---

## å…«ã€æœ€è¿‘é‡å¤§æ›´æ–°è®°å½•

### 2026-01-24ï¼šæ”¾ç½®ç³»ç»Ÿå¤šé—®é¢˜ä¿®å¤

**ä¿®å¤å†…å®¹**:
1. æ ‘è‹—é‡å¤æ”¾ç½®é—®é¢˜ - æ·»åŠ æ— ç¢°æ’ä½“ç‰©å“æ£€æµ‹
2. æ ¼å­ä¸­å¿ƒè®¡ç®—ä¿®å¤ - ç¡®ä¿åœ¨æ•´æ•°+0.5ä½ç½®
3. ç®±å­æ”¾ç½®ä½ç½®å¯¹é½ - ä½¿ç”¨ GetPlacementPosition()
4. éšœç¢ç‰©æ£€æµ‹é€»è¾‘ - æ”¹ç”¨æ ¼å­ç´¢å¼•æ¯”è¾ƒ
5. é¢„è§ˆé®æŒ¡é€æ˜æ•ˆæœ - æ‰©å±• OcclusionManager

**ä¿®æ”¹æ–‡ä»¶**:
- PlacementManagerV3.cs
- PlacementValidatorV3.cs
- PlacementGridCalculator.cs
- PlacementPreviewV3.cs
- OcclusionManager.cs

### 2026-01-22ï¼šç®±å­ç³»ç»Ÿç»ˆææ¸…ç®—

**ä¿®å¤å†…å®¹**:
1. BoxPanelUI å®Œæ•´é‡æ„
2. æ§½ä½ç»‘å®šé€»è¾‘ä¿®å¤
3. æ‹–æ‹½äº¤äº’ä¼˜åŒ–
4. æ—¥å¿—è§„èŒƒåŒ–

**ä¿®æ”¹æ–‡ä»¶**:
- BoxPanelUI.cs
- InventorySlotUI.cs
- InventorySlotInteraction.cs
- ChestController.cs

### 2026-01-21ï¼šUI ç³»ç»Ÿä»£ç å®¡æ ¸

**ä¼˜åŒ–å†…å®¹**:
1. é€‰ä¸­çŠ¶æ€äº¤äº’ä¼˜åŒ–
2. èƒŒåŒ…äº¤äº’é€»è¾‘ä¼˜åŒ–
3. è°ƒè¯•æ—¥å¿—è§„èŒƒåŒ–

---

## ä¹ã€ä¸‹æ¬¡å·¡æ£€è®¡åˆ’

- **æ—¥æœŸ**: 2026-02-24 æˆ–ä¸‹æ¬¡å¤§å‹é‡æ„å
- **é‡ç‚¹æ£€æŸ¥**:
  - [ ] å†œç”°ç³»ç»Ÿå¼€å‘è¿›åº¦
  - [ ] äº‘æœµé®æŒ¡ç³»ç»Ÿé‡å¯çŠ¶æ€
  - [ ] åˆ¶ä½œå°ç³»ç»Ÿé‡å¯çŠ¶æ€
  - [ ] memory.md å­—ç¬¦æ•°æ§åˆ¶
  - [ ] æ–°å¢å·¥ä½œåŒºç»“æ„è§„èŒƒæ€§

---

## åã€ç»´æŠ¤è¯´æ˜

æœ¬æ–‡æ¡£ç”± AI åŠ©æ‰‹è‡ªåŠ¨ç”Ÿæˆï¼ŒåŒ…å«ï¼š
1. æ‰€æœ‰ specs å·¥ä½œåŒºçŠ¶æ€æ±‡æ€»
2. ä»£ç æ¶æ„æ¦‚è§ˆ
3. åœºæ™¯å±‚çº§ç»“æ„
4. å…³é”®ç»„ä»¶æ¸…å•
5. ç³»ç»Ÿé—´ä¾èµ–å…³ç³»

**æ›´æ–°é¢‘ç‡**: æ¯æ¬¡å¤§å‹åŠŸèƒ½å®Œæˆåæˆ–æ¯æœˆä¸€æ¬¡

**æ–‡æ¡£ä½ç½®**: `.kiro/specs/specs-structure-audit.md`
