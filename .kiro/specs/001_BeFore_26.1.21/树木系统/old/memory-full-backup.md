# æ ‘æœ¨ç³»ç»Ÿ - å¼€å‘è®°å¿†

## æ¨¡å—æ¦‚è¿°
TreeControllerV2 æ ‘æœ¨æ§åˆ¶å™¨ç³»ç»Ÿï¼ŒåŒ…å«ï¼š
- 6é˜¶æ®µæˆé•¿ç³»ç»Ÿï¼ˆStage 0-5ï¼‰
- 5ç§æ¤è¢«å­£èŠ‚æ ·å¼ï¼ˆæ˜¥/å¤/æ—©ç§‹/æ™šç§‹/å†¬ï¼‰
- å­£èŠ‚æ¸å˜ç³»ç»Ÿ
- Inspector UI é‡æ„
- æˆé•¿ç©ºé—´æ£€æµ‹

## å½“å‰çŠ¶æ€
- **å®Œæˆåº¦**: 98%
- **æœ€åæ›´æ–°**: 2025-12-30
- **çŠ¶æ€**: å­£èŠ‚äº‹ä»¶å·²æš‚åœï¼ˆenableSeasonEvents=falseï¼‰ï¼Œç­‰å¾…åç»­åŠŸèƒ½å®Œæˆåé‡æ–°å¯ç”¨

---

## ğŸ”´ğŸ”´ğŸ”´ é‡è¦ï¼šå­£èŠ‚äº‹ä»¶æš‚åœé€šçŸ¥ ğŸ”´ğŸ”´ğŸ”´

### æš‚åœåŸå› 
ç”¨æˆ·è¦æ±‚æš‚åœæ‰€æœ‰å­£èŠ‚/å¤©æ°”äº‹ä»¶ï¼Œç­‰å¾…å…¶ä»–åŠŸèƒ½å¼€å‘å®Œæˆåå†é‡æ–°è§„åˆ’ã€‚

### æš‚åœæ–¹å¼
åœ¨ `TreeControllerV2.cs` ä¸­æ·»åŠ äº† `enableSeasonEvents` å¼€å…³ï¼ˆé»˜è®¤ä¸º `false`ï¼‰ã€‚

### è¢«æš‚åœçš„äº‹ä»¶
| äº‹ä»¶ | è¯´æ˜ |
|------|------|
| `SeasonManager.OnSeasonChanged` | æ—¥å†å­£èŠ‚å˜åŒ– |
| `SeasonManager.OnVegetationSeasonChanged` | æ¤è¢«å­£èŠ‚æ¸å˜ |
| `TimeManager.OnDayChanged` | æ¯æ—¥æˆé•¿ |
| `WeatherSystem.OnPlantsWither` | å¤©æ°”æ¯è |
| `WeatherSystem.OnPlantsRecover` | å¤©æ°”æ¢å¤ |
| `WeatherSystem.OnWinterSnow` | å†¬å­£ä¸‹é›ª |
| `WeatherSystem.OnWinterMelt` | å†¬å­£èåŒ– |

### å¦‚ä½•æ¢å¤
1. æ‰“å¼€ `Assets/YYY_Scripts/Controller/TreeControllerV2.cs`
2. æ‰¾åˆ° `enableSeasonEvents` å­—æ®µ
3. å°†é»˜è®¤å€¼ä» `false` æ”¹ä¸º `true`
4. æˆ–è€…åœ¨ Inspector ä¸­å‹¾é€‰"å¯ç”¨å­£èŠ‚äº‹ä»¶"

### æš‚åœæ—¥æœŸ
2025-12-30

---

## â˜…â˜…â˜… æ¤è¢«å­£èŠ‚ç³»ç»Ÿè®¾è®¡ï¼ˆæ ¸å¿ƒæ–‡æ¡£ï¼‰â˜…â˜…â˜…

### ç”¨æˆ·åŸå§‹éœ€æ±‚

> "ç°åœ¨å…¨ç›˜é‡æ–°å¸ƒå±€æ¤ç‰©çš„å­£èŠ‚å˜åŒ–ï¼Œç°åœ¨åˆ†ä¸ºï¼šæ—©æ˜¥ï¼ˆæ˜¥å­£ä¸ŠåŠéƒ¨åˆ†ï¼‰ã€æ™šæ˜¥æ—©å¤ï¼ˆæ˜¥å­£ä¸‹åŠéƒ¨åˆ†åŠ å¤å­£å‰åŠéƒ¨åˆ†ï¼‰ã€æ™šå¤æ—©ç§‹ï¼ˆå¤å­£å‰åŠéƒ¨åˆ†åŠ ç§‹å­£ä¸‹åŠéƒ¨åˆ†ï¼‰ã€æ™šç§‹ï¼ˆç§‹å­£ä¸‹åŠéƒ¨åˆ†ï¼‰ã€å†¬ï¼ˆæ•´ä¸ªå†¬å­£ï¼‰ï¼Œä»¥ä¸Šäº”ä¸ªé˜¶æ®µï¼Œå­£èŠ‚æ—¶é—´ä¸å˜ï¼Œåªæ˜¯å¯¹å­£èŠ‚çš„æ¤ç‰©è§„åˆ™è¿›è¡Œç»†åˆ†"

### å­—æ®µåç§°ä¸è§†è§‰æ ·å¼æ˜ å°„ï¼ˆé‡è¦ï¼ï¼‰â˜… 2025-12-30 æ›´æ–°

| å­—æ®µåç§°ï¼ˆæ–°ï¼‰ | å­—æ®µåç§°ï¼ˆæ—§ï¼‰ | å®é™…è§†è§‰æ ·å¼ | è¯´æ˜ |
|--------------|--------------|-------------|------|
| `spring` | `earlySpring` | **æ˜¥å­£æ ·å¼** | ç»¿è‰²èŒ‚ç›› |
| `summer` | `lateSpringEarlySummer` | **å¤å­£æ ·å¼** | æ·±ç»¿è‰² |
| `earlyFall` | `lateSummerEarlyFall` | **æ—©ç§‹æ ·å¼** | å¼€å§‹å˜é»„ |
| `lateFall` | `lateFall` | **æ™šç§‹æ ·å¼** | é»„è‰²/æ©™è‰² |
| `winter` | `winter` | **å†¬å­£æ ·å¼** | æŒ‚å†°/å…‰ç§ƒ |

### æ—¶é—´çº¿ä¸æ˜¾ç¤ºè§„åˆ™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ä¸€å¹´å››å­£æ—¶é—´çº¿                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ˜¥å­£                                                                     â”‚
â”‚ â”œâ”€ æ˜¥1-14å¤©ï¼š100% æ˜¥å­£æ ·å¼ï¼ˆSpringï¼‰                                     â”‚
â”‚ â””â”€ æ˜¥15-28å¤©ï¼šæ˜¥å­£æ ·å¼ â†’ å¤å­£æ ·å¼ æ¸å˜                                   â”‚
â”‚                                                                          â”‚
â”‚ å¤å­£                                                                     â”‚
â”‚ â”œâ”€ å¤1-14å¤©ï¼š100% å¤å­£æ ·å¼ï¼ˆSummerï¼‰                                     â”‚
â”‚ â””â”€ å¤15-28å¤©ï¼šå¤å­£æ ·å¼ â†’ æ—©ç§‹æ ·å¼ æ¸å˜                                   â”‚
â”‚                                                                          â”‚
â”‚ ç§‹å­£ï¼ˆç‰¹æ®Šï¼šä¸€è¿›å…¥å°±å¼€å§‹æ¸å˜ï¼‰                                           â”‚
â”‚ â”œâ”€ ç§‹1-14å¤©ï¼šæ—©ç§‹æ ·å¼ â†’ æ™šç§‹æ ·å¼ æ¸å˜ï¼ˆEarlyFallï¼‰                       â”‚
â”‚ â””â”€ ç§‹15-28å¤©ï¼š100% æ™šç§‹æ ·å¼ï¼ˆLateFallï¼‰                                  â”‚
â”‚                                                                          â”‚
â”‚ å†¬å­£                                                                     â”‚
â”‚ â””â”€ å†¬1-28å¤©ï¼š100% å†¬å­£æ ·å¼ï¼ˆWinterï¼‰                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¸å˜æœºåˆ¶

1. **åŸºäºæ ‘æœ¨IDçš„éšæœºç§å­**ï¼šæ¯æ£µæ ‘æœ‰å›ºå®šçš„éšæœºå€¼ï¼ˆ0-1ï¼‰
2. **è¿›åº¦æ¯”è¾ƒ**ï¼šå¦‚æœ `treeSeedValue < progress`ï¼Œæ˜¾ç¤ºä¸‹ä¸€å­£èŠ‚æ ·å¼
3. **çº¿æ€§æ¸å˜**ï¼šprogress ä» 0 çº¿æ€§å¢åŠ åˆ° 1ï¼ˆ14å¤©å†…ï¼‰
4. **æ•ˆæœ**ï¼šåœºæ™¯ä¸­çš„æ ‘æœ¨é€æ¸ä»å½“å‰å­£èŠ‚æ ·å¼è¿‡æ¸¡åˆ°ä¸‹ä¸€å­£èŠ‚æ ·å¼

### ç›¸å…³ä»£ç æ–‡ä»¶

| æ–‡ä»¶ | èŒè´£ |
|------|------|
| `SeasonManager.cs` | ç®¡ç†æ¤è¢«å­£èŠ‚å’Œæ¸å˜è¿›åº¦ |
| `TreeControllerV2.cs` | æ ¹æ®å­£èŠ‚é€‰æ‹© Sprite |
| `TreeSpriteData.cs` | å®šä¹‰ SeasonSpriteSet æ•°æ®ç»“æ„ |

---

## ä¼šè¯è®°å½•

### ä¼šè¯ 6 - 2025-12-30ï¼ˆå­£èŠ‚äº‹ä»¶æš‚åœï¼‰

**ç”¨æˆ·éœ€æ±‚**:
> ç°åœ¨æˆ‘è¦æ±‚ä½ å¯¹å½“å‰æ‰€æœ‰å­£èŠ‚äº‹ä»¶å…ˆå…¨éƒ¨æš‚åœï¼Œåç»­å®Œæˆå…¶ä»–éƒ¨åˆ†çš„åŠŸèƒ½åå†é‡æ–°è§„åˆ’è¿™ä¸€éƒ¨åˆ†ï¼Œæ„æ€å°±æ˜¯ç°åœ¨çš„å­£èŠ‚äº‹ä»¶å…¨éƒ¨åœæ­¢è®¢é˜…ï¼Œè¯·ä½ ç”¨å®‰å…¨çš„æ–¹æ³•è¿›è¡Œå®ç°å¹¶æ›´æ–°memoryï¼Œä»¥ä¾¿åç»­è§£å°ç›¸å…³å†…å®¹

**å®Œæˆä»»åŠ¡**:

#### æ·»åŠ å­£èŠ‚äº‹ä»¶å¼€å…³

åœ¨ `TreeControllerV2.cs` ä¸­æ·»åŠ  `enableSeasonEvents` å­—æ®µï¼š

```csharp
[Header("â”â”â”â” å­£èŠ‚äº‹ä»¶å¼€å…³ï¼ˆä¸´æ—¶ç¦ç”¨ï¼‰â”â”â”â”")]
[Tooltip("â˜… å…¨å±€å¼€å…³ï¼šæ˜¯å¦å¯ç”¨å­£èŠ‚/å¤©æ°”äº‹ä»¶è®¢é˜…\n" +
         "è®¾ä¸º false å¯æš‚åœæ‰€æœ‰å­£èŠ‚ç›¸å…³åŠŸèƒ½ï¼š\n" +
         "- å­£èŠ‚å˜åŒ–ï¼ˆOnSeasonChangedï¼‰\n" +
         "- æ¤è¢«å­£èŠ‚æ¸å˜ï¼ˆOnVegetationSeasonChangedï¼‰\n" +
         "- æ¯æ—¥æˆé•¿ï¼ˆOnDayChangedï¼‰\n" +
         "- å¤©æ°”æ¯è/æ¢å¤ï¼ˆOnPlantsWither/Recoverï¼‰\n" +
         "- å†¬å­£ä¸‹é›ª/èåŒ–ï¼ˆOnWinterSnow/Meltï¼‰\n" +
         "åç»­éœ€è¦æ—¶æ”¹ä¸º true å³å¯æ¢å¤")]
[SerializeField] private bool enableSeasonEvents = false;  // â˜… é»˜è®¤å…³é—­
```

#### ä¿®æ”¹äº‹ä»¶è®¢é˜…é€»è¾‘

**Start() æ–¹æ³•**ï¼š
- æ‰€æœ‰å­£èŠ‚/å¤©æ°”äº‹ä»¶è®¢é˜…éƒ½åŒ…è£¹åœ¨ `if (enableSeasonEvents)` æ¡ä»¶ä¸­
- æ¯æ—¥æˆé•¿äº‹ä»¶ä¹Ÿå—æ­¤å¼€å…³æ§åˆ¶
- ç¦ç”¨æ—¶è¾“å‡ºè°ƒè¯•æ—¥å¿—æç¤º

**OnDestroy() æ–¹æ³•**ï¼š
- åªæœ‰å¯ç”¨äº†å­£èŠ‚äº‹ä»¶æ‰å–æ¶ˆè®¢é˜…ï¼Œé¿å…å–æ¶ˆæœªè®¢é˜…çš„äº‹ä»¶

**ä¿®æ”¹æ–‡ä»¶**:
- `Assets/YYY_Scripts/Controller/TreeControllerV2.cs`
  - æ–°å¢ `enableSeasonEvents` å­—æ®µï¼ˆé»˜è®¤ falseï¼‰
  - ä¿®æ”¹ `Start()` æ–¹æ³•ï¼Œæ¡ä»¶è®¢é˜…äº‹ä»¶
  - ä¿®æ”¹ `OnDestroy()` æ–¹æ³•ï¼Œæ¡ä»¶å–æ¶ˆè®¢é˜…

**æ¢å¤æ–¹æ³•**:
1. å°† `enableSeasonEvents` é»˜è®¤å€¼æ”¹ä¸º `true`
2. æˆ–åœ¨ Inspector ä¸­å‹¾é€‰è¯¥é€‰é¡¹
3. é‡æ–°è¿›å…¥ Play æ¨¡å¼å³å¯ç”Ÿæ•ˆ

**é—ç•™é—®é¢˜**:
- [ ] åç»­éœ€è¦é‡æ–°è§„åˆ’å­£èŠ‚äº‹ä»¶ç³»ç»Ÿ
- [ ] éœ€è¦æµ‹è¯•æ¢å¤ååŠŸèƒ½æ˜¯å¦æ­£å¸¸

---

### ä¼šè¯ 5 - 2025-12-30ï¼ˆå­£èŠ‚ Sprite æ˜¾ç¤º BUG ä¿®å¤ï¼‰

**ç”¨æˆ·éœ€æ±‚**:
> æˆ‘å‘ç°ä½ çš„å­£èŠ‚ç®¡æ§ä¸­å¯¹æ ‘æœ¨spriteçš„æ›´æ–°å‡ºç°äº†é—®é¢˜...æ˜¥å¤©çš„ç¬¬15å¤©æˆªå›¾çš„å‚æ•°ï¼Œæˆ‘è¦çš„æ˜¯ä½ æ˜¥15-28æ˜¯æ¸å˜åˆ°æ™šæ˜¥æ—©å¤ï¼Œè€Œä¸æ˜¯å‡ºç°æ™šå¤æ—©ç§‹

**é—®é¢˜ç°è±¡**:
- æ˜¥å¤©ç¬¬15å¤©ï¼Œæ ‘æœ¨æ˜¾ç¤ºçš„æ˜¯ `Size_02_19`ã€`Size_03_8`ã€`Size_05_1`
- è¿™äº›æ˜¯ `lateSummerEarlyFall`ï¼ˆæ™šå¤æ—©ç§‹/æ—©ç§‹æ ·å¼ï¼‰å­—æ®µé…ç½®çš„ Sprite
- ä½†åº”è¯¥æ˜¾ç¤º `earlySpring`ï¼ˆæ˜¥å­£æ ·å¼ï¼‰æˆ–å¼€å§‹æ¸å˜åˆ° `lateSpringEarlySummer`ï¼ˆå¤å­£æ ·å¼ï¼‰

**é—®é¢˜æ ¹å› **:
`SeasonManager.UpdateVegetationSeason()` æ–¹æ³•é€»è¾‘é”™è¯¯ï¼š
- æ˜¥15-28å¤©æ—¶ï¼Œé”™è¯¯åœ°è®¾ç½® `VegetationSeason.LateSpringEarlySummer`
- åº”è¯¥ä¿æŒ `VegetationSeason.EarlySpring`ï¼Œåªå¢åŠ  progress

**ä¿®å¤å†…å®¹**:

ä¿®æ”¹ `SeasonManager.cs` çš„ `UpdateVegetationSeason()` æ–¹æ³•ï¼š

| æ—¶é—´æ®µ | ä¿®å¤å‰ï¼ˆé”™è¯¯ï¼‰ | ä¿®å¤åï¼ˆæ­£ç¡®ï¼‰ |
|--------|--------------|--------------|
| æ˜¥15-28 | `LateSpringEarlySummer` + progress | `EarlySpring` + progress |
| å¤1-14 | `LateSpringEarlySummer` + progress | `LateSpringEarlySummer` + 0 |
| å¤15-28 | `LateSummerEarlyFall` + progress | `LateSpringEarlySummer` + progress |
| ç§‹1-14 | `LateSummerEarlyFall` + progress | `LateSummerEarlyFall` + progress |

**ä¿®æ”¹æ–‡ä»¶**:
- `Assets/YYY_Scripts/Service/SeasonManager.cs` - ä¿®å¤ UpdateVegetationSeason() é€»è¾‘

**é—ç•™é—®é¢˜**:
- [x] ç”¨æˆ·è¦æ±‚é‡å‘½åå­—æ®µï¼Œç®€åŒ–å‘½å â†’ å·²å®Œæˆ
- [x] ç”¨æˆ·è¦æ±‚ Inspector å®æ—¶è°ƒè¯•åŠŸèƒ½ â†’ å·²å®Œæˆ

---

### ä¼šè¯ 5.1 - 2025-12-30ï¼ˆå­—æ®µé‡å‘½å + Inspector è°ƒè¯•åŠŸèƒ½ï¼‰

**ç”¨æˆ·éœ€æ±‚**:
> ç°åœ¨æ‰€å†™çš„æ—©æ˜¥å°±æ˜¯æ˜¥å­£ï¼Œæ™šæ˜¥æ—©å¤å°±æ˜¯å¤å­£ï¼Œæ™šå¤æ—©ç§‹å°±æ˜¯æ—©ç§‹ï¼Œæ™šç§‹å°±æ˜¯æ™šç§‹ï¼Œç§‹å­£æœ‰ä¸¤ä¸ªæ ·å¼ï¼Œç„¶åå†¬å­£å°±æ˜¯å†¬å­£...
> å¯¹äºå½“å‰çŠ¶æ€éƒ¨åˆ†ï¼Œæˆ‘çš„è¦æ±‚å°±æ˜¯èµ·ç ä½ åœ¨æˆ‘è¿è¡Œæ¸¸æˆçš„æ—¶å€™ä¼šåŠ¨æ€è¿›è¡Œè°ƒæ•´ï¼Œæˆ‘åªè¦ä¿®æ”¹äº†è¿™éƒ¨åˆ†çš„ä»»æ„å‚æ•°ï¼Œä½ éƒ½ä¼šç«‹åˆ»è¿›è¡Œæ›´æ–°

**å®Œæˆä»»åŠ¡**:

#### 1. å­—æ®µé‡å‘½å

| æ—§åç§° | æ–°åç§° | è¯´æ˜ |
|--------|--------|------|
| `earlySpring` | `spring` | æ˜¥å­£æ ·å¼ |
| `lateSpringEarlySummer` | `summer` | å¤å­£æ ·å¼ |
| `lateSummerEarlyFall` | `earlyFall` | æ—©ç§‹æ ·å¼ |
| `lateFall` | `lateFall` | æ™šç§‹æ ·å¼ï¼ˆä¸å˜ï¼‰ |
| `winter` | `winter` | å†¬å­£æ ·å¼ï¼ˆä¸å˜ï¼‰ |

VegetationSeason æšä¸¾ä¹ŸåŒæ­¥æ›´æ–°ï¼š
- `EarlySpring` â†’ `Spring`
- `LateSpringEarlySummer` â†’ `Summer`
- `LateSummerEarlyFall` â†’ `EarlyFall`
- `LateFall` â†’ `LateFall`ï¼ˆä¸å˜ï¼‰
- `Winter` â†’ `Winter`ï¼ˆä¸å˜ï¼‰

#### 2. Inspector å®æ—¶è°ƒè¯•åŠŸèƒ½

åœ¨ `TreeControllerV2.cs` ä¸­æ·»åŠ è¿è¡Œæ—¶ Inspector è°ƒè¯•åŠŸèƒ½ï¼š
- åœ¨ `Update()` ä¸­æ£€æµ‹ Inspector å‚æ•°å˜åŒ–
- æ£€æµ‹å­—æ®µï¼š`currentStageIndex`ã€`currentState`ã€`currentSeason`
- å‚æ•°å˜åŒ–æ—¶ç«‹å³è°ƒç”¨ `UpdateSprite()` å’Œ `UpdatePolygonColliderShape()`
- ç¼–è¾‘æ¨¡å¼ä¸‹é€šè¿‡ `OnValidate()` å®ç°å®æ—¶é¢„è§ˆ

**ä¿®æ”¹æ–‡ä»¶**:
- `Assets/YYY_Scripts/Data/TreeSpriteData.cs`
  - `SeasonSpriteSet` å­—æ®µé‡å‘½å
  - `GetSprite()` æ–¹æ³•æ›´æ–°æšä¸¾å¼•ç”¨
  - `GetStumpSprite()` æ–¹æ³•æ›´æ–°æšä¸¾å¼•ç”¨
  - `GetWitheredSprite()` æ–¹æ³•æ›´æ–°æšä¸¾å¼•ç”¨

- `Assets/YYY_Scripts/Service/SeasonManager.cs`
  - `VegetationSeason` æšä¸¾é‡å‘½å
  - `UpdateVegetationSeason()` æ–¹æ³•æ›´æ–°æšä¸¾å¼•ç”¨

- `Assets/YYY_Scripts/Controller/TreeControllerV2.cs`
  - `GetNormalSprite()` è°ƒè¯•è¾“å‡ºæ›´æ–°å­—æ®µå
  - `GetNextVegetationSeason()` æ›´æ–°æšä¸¾å¼•ç”¨
  - æ–°å¢ `UpdateRuntimeInspectorDebug()` æ–¹æ³•
  - æ–°å¢ `Update()` æ–¹æ³•è°ƒç”¨è¿è¡Œæ—¶è°ƒè¯•
  - ä¿®æ”¹ `OnValidate()` æ”¯æŒè¿è¡Œæ—¶åˆå§‹åŒ–

- `Assets/YYY_Scripts/Controller/TreeController.cs`ï¼ˆæ—§ç‰ˆæ§åˆ¶å™¨ï¼‰
  - æ›´æ–°æ‰€æœ‰ `VegetationSeason` æšä¸¾å¼•ç”¨

- `Assets/Editor/TreeControllerV2Editor.cs`
  - `DrawSeasonSpriteSet()` æ›´æ–°å­—æ®µåå’Œä¸­æ–‡æ ‡ç­¾

**Inspector è°ƒè¯•åŠŸèƒ½è¯´æ˜**:
- **è¿è¡Œæ—¶**ï¼šåœ¨ Inspector ä¸­ä¿®æ”¹"å½“å‰é˜¶æ®µ"ã€"å½“å‰çŠ¶æ€"ã€"å½“å‰å­£èŠ‚"ä¼šç«‹å³æ›´æ–°æ ‘æœ¨æ˜¾ç¤º
- **ç¼–è¾‘æ¨¡å¼**ï¼šä¿®æ”¹"å½“å‰é˜¶æ®µ"ã€"å½“å‰çŠ¶æ€"ä¼šç«‹å³æ›´æ–°é¢„è§ˆï¼ˆéœ€è¦å¼€å¯ editorPreviewï¼‰
- **è°ƒè¯•æ—¥å¿—**ï¼šå¼€å¯ showDebugInfo åä¼šè¾“å‡ºå‚æ•°å˜åŒ–æ—¥å¿—

**é—ç•™é—®é¢˜**:
- [ ] éœ€è¦ç”¨æˆ·æµ‹è¯•éªŒè¯å­—æ®µé‡å‘½ååé¢„åˆ¶ä½“æ˜¯å¦æ­£å¸¸ï¼ˆUnity å¯èƒ½éœ€è¦é‡æ–°é…ç½® Sprite å¼•ç”¨ï¼‰
- [ ] éœ€è¦ç”¨æˆ·æµ‹è¯•éªŒè¯ Inspector è°ƒè¯•åŠŸèƒ½

---

### ä¼šè¯ 4 - 2025-12-24ï¼ˆæˆé•¿ç©ºé—´æ£€æµ‹æ–¹æ¡ˆè®¾è®¡ï¼‰

**ç”¨æˆ·éœ€æ±‚**:
> æ ‘æœ¨ç”Ÿé•¿è‚¯å®šæ˜¯éœ€è¦ç©ºé—´çš„ï¼Œæ‰€ä»¥ä½ åœ¨è¿›å…¥ä¸‹ä¸€é˜¶æ®µå‰çš„æ—¶å€™å…ˆè¦è¿›è¡Œæ£€æµ‹ï¼Œæ£€æµ‹çš„æ ‡å‡†ä½ å¸®æˆ‘æƒ³ä¸€ä¸ª

**æ–¹æ¡ˆè®¾è®¡**:

#### æ ¸å¿ƒæ€è·¯
åŸºäºç›®æ ‡é˜¶æ®µ Sprite å°ºå¯¸çš„åœ†å½¢æ£€æµ‹ï¼š
```
æ£€æµ‹åŠå¾„ = ç›®æ ‡é˜¶æ®µ Sprite å®½åº¦ Ã— ç³»æ•°ï¼ˆå»ºè®® 0.4~0.5ï¼‰
```

#### æ£€æµ‹å‚æ•°å»ºè®®

| ç›®æ ‡é˜¶æ®µ | Sprite å®½åº¦ä¼°ç®— | æ£€æµ‹ç³»æ•° | æ£€æµ‹åŠå¾„ | è¯´æ˜ |
|---------|----------------|---------|---------|------|
| 0â†’1 | ~0.5 å•ä½ | 0.3 | ~0.15 | æ ‘è‹—å¾ˆå°ï¼Œå‡ ä¹ä¸éœ€è¦ç©ºé—´ |
| 1â†’2 | ~1.0 å•ä½ | 0.4 | ~0.4 | å°æ ‘å¼€å§‹éœ€è¦ç©ºé—´ |
| 2â†’3 | ~1.5 å•ä½ | 0.5 | ~0.75 | ä¸­ç­‰æ ‘éœ€è¦æ›´å¤šç©ºé—´ |
| 3â†’4 | ~2.0 å•ä½ | 0.5 | ~1.0 | å¤§æ ‘éœ€è¦æ˜¾è‘—ç©ºé—´ |
| 4â†’5 | ~2.5 å•ä½ | 0.5 | ~1.25 | æˆç†Ÿæ ‘éœ€è¦æœ€å¤§ç©ºé—´ |

#### å…³é”®è®¾è®¡å†³ç­–

1. **æ£€æµ‹åŸºå‡†ç‚¹**ï¼šä½¿ç”¨æ ‘æ ¹ä½ç½®ï¼ˆçˆ¶ç‰©ä½“ä½ç½®ï¼‰
2. **æ£€æµ‹ç³»æ•°**ï¼š0.4~0.5ï¼Œå…è®¸æ ‘å†  10%~20% é‡å 
3. **æ£€æµ‹å¯¹è±¡**ï¼šåªæ£€æµ‹å…¶ä»–æ ‘æœ¨ï¼Œä¸æ£€æµ‹å»ºç­‘ã€å²©çŸ³
4. **æˆé•¿å¤±è´¥å¤„ç†**ï¼šä¿æŒå½“å‰é˜¶æ®µï¼Œä¸‹ä¸€å¤©ç»§ç»­æ£€æµ‹

#### é…ç½®å­—æ®µå»ºè®®
```csharp
[Header("â”â”â”â” æˆé•¿ç©ºé—´æ£€æµ‹ â”â”â”â”")]
[SerializeField] private bool enableGrowthSpaceCheck = true;
[Range(0.3f, 0.7f)]
[SerializeField] private float growthSpaceMultiplier = 0.45f;
[SerializeField] private LayerMask growthCheckLayerMask;
```

**å¾…ç¡®è®¤é—®é¢˜**:
- [x] æ£€æµ‹ç³»æ•° 0.45 æ˜¯å¦åˆé€‚ï¼Ÿ â†’ å·²å®ç°ï¼Œå¯é…ç½®
- [ ] æ˜¯å¦éœ€è¦åŒºåˆ†ä¸åŒæ ‘ç§ï¼Ÿ â†’ å½“å‰ä½¿ç”¨ç»Ÿä¸€é…ç½®
- [ ] æˆé•¿å¤±è´¥åæ˜¯å¦éœ€è¦è§†è§‰åé¦ˆï¼Ÿ â†’ å½“å‰åªæœ‰è°ƒè¯•æ—¥å¿—

**å®ç°å®Œæˆ**: 2025-12-24

**ä¿®æ”¹æ–‡ä»¶**:
- `Assets/YYY_Scripts/Controller/TreeControllerV2.cs`
  - æ·»åŠ æˆé•¿ç©ºé—´æ£€æµ‹é…ç½®å­—æ®µ
  - æ·»åŠ  `CanGrowToNextStage()` æ–¹æ³•
  - æ·»åŠ  `GetGrowthCheckRadius()` æ–¹æ³•
  - ä¿®æ”¹ `OnDayChanged()` åœ¨æˆé•¿å‰æ£€æµ‹ç©ºé—´

**æ–°å¢é…ç½®å­—æ®µ**:
```csharp
[Header("æˆé•¿ç©ºé—´æ£€æµ‹")]
[SerializeField] private bool enableGrowthSpaceCheck = true;
[SerializeField] private float growthSpaceMultiplier = 0.45f;
[SerializeField] private float[] stageGrowthRadius = { 0f, 0.15f, 0.4f, 0.75f, 1.0f, 1.25f };
[SerializeField] private bool showGrowthBlockedInfo = true;
```

**æ ¸å¿ƒé€»è¾‘**:
1. ä½¿ç”¨ `Physics2D.OverlapCircleAll` æ£€æµ‹å‘¨å›´ç¢°æ’ä½“
2. åªæ£€æµ‹å…¶ä»–æ ‘æœ¨ï¼ˆTreeControllerV2 å’Œ TreeControllerï¼‰
3. å¦‚æœå‘¨å›´æœ‰åŒç­‰æˆ–æ›´å¤§é˜¶æ®µçš„æ ‘æœ¨ï¼Œåˆ™æ— æ³•æˆé•¿
4. ä¸¤æ£µæ ‘åŒæ—¶å°è¯•æˆé•¿æ—¶ï¼ŒInstanceID è¾ƒå°çš„ä¼˜å…ˆ
5. ç©ºé—´ä¸è¶³æ—¶ä¿æŒå½“å‰é˜¶æ®µï¼Œå¤©æ•°ä¸é‡ç½®ï¼Œç­‰å¾…ç©ºé—´

**é—ç•™é—®é¢˜**:
- [ ] éœ€è¦ç”¨æˆ·æµ‹è¯•éªŒè¯æˆé•¿ç©ºé—´æ£€æµ‹åŠŸèƒ½

---

### ä¼šè¯ 3 - 2025-12-24ï¼ˆæ ‘è‹—å†¬å­£æ­»äº¡é€»è¾‘å®Œå–„ï¼‰

**ç”¨æˆ·éœ€æ±‚**:
> æ ‘è‹—æ²¡æœ‰å†¬å­£ï¼Œç›´æ¥æ­»å…‰äº†ï¼Œæ£€æŸ¥æ‰€æœ‰ç›¸å…³é€»è¾‘ï¼Œè¿™ä¸ªå‚æ•°è¦åˆ æ‰ï¼Œè€Œä¸”è¦æ£€æŸ¥æ˜¯å¦æœ‰å†¬å­£è¿›å…¥åçš„äº‹ä»¶ç›‘æµ‹ä»¥åŠé”€æ¯ç‰©ä½“ä¹‹ç±»çš„

**é—®é¢˜åˆ†æ**:
1. Stage 0ï¼ˆæ ‘è‹—ï¼‰çš„ Sprite é…ç½®ä¸­æ˜¾ç¤ºäº†"å†¬å­£" Sprite å­—æ®µ
2. å†¬å­£åˆ°æ¥æ—¶ï¼Œæ ‘è‹—åªæ˜¯"å†°å°"ï¼ˆFrozenï¼‰ï¼Œè€Œä¸æ˜¯ç›´æ¥é”€æ¯
3. `isFrozenSapling` å­—æ®µä¸å†éœ€è¦

**ä¿®æ”¹å†…å®¹**:

1. **Editor ä¿®æ”¹** (`TreeControllerV2Editor.cs`)
   - `DrawSeasonSpriteSet()` æ·»åŠ  `hideWinter` å‚æ•°
   - Stage 0 ä¸æ˜¾ç¤ºå†¬å­£ Sprite å­—æ®µï¼Œæ˜¾ç¤º"æ—  (å†¬å­£ç›´æ¥æ­»äº¡)"

2. **TreeControllerV2 ä¿®æ”¹**
   - `OnSeasonChanged()`: å†¬å­£åˆ°æ¥æ—¶ç›´æ¥è°ƒç”¨ `DestroyTree()` é”€æ¯æ ‘è‹—
   - `OnWinterSnow()`: æ ‘è‹—ä¸å†å†°å°ï¼Œç›´æ¥é”€æ¯
   - `OnWinterMelt()`: æ ‘è‹—ä¸å†èåŒ–ï¼Œç›´æ¥é”€æ¯
   - `GetWinterSprite()`: ç§»é™¤æ ‘è‹—ç›¸å…³é€»è¾‘
   - `UpdateSprite()`: ç§»é™¤æ ‘è‹—å†¬å­£èåŒ–éšè—é€»è¾‘
   - ç§»é™¤ `isFrozenSapling` å­—æ®µ
   - `IsFrozenSapling()` æ ‡è®°ä¸º `[Obsolete]`ï¼Œå§‹ç»ˆè¿”å› false
   - `Reset()` ç§»é™¤ `isFrozenSapling` é‡ç½®

**ä¿®æ”¹æ–‡ä»¶**:
- `Assets/Editor/TreeControllerV2Editor.cs` - Stage 0 éšè—å†¬å­£ Sprite å­—æ®µ
- `Assets/YYY_Scripts/Controller/TreeControllerV2.cs` - å†¬å­£æ ‘è‹—ç›´æ¥æ­»äº¡

**é—ç•™é—®é¢˜**:
- [ ] éœ€è¦ç”¨æˆ·æµ‹è¯•éªŒè¯å†¬å­£æ ‘è‹—æ­»äº¡åŠŸèƒ½

---

### ä¼šè¯ 2 - 2025-12-24ï¼ˆé”„å¤´æŒ–æ ‘è‹—ä¿®å¤ï¼‰

**ç”¨æˆ·éœ€æ±‚**:
> æ ‘æœ¨ç³»ç»Ÿå†…è®¾å®šstage0åªèƒ½è¢«hoeæŒ–èµ°ï¼Œä¸èƒ½è¢«ç ä¼ä¹Ÿæ²¡æœ‰ç¢°æ’ä½“ï¼Œä½†æ˜¯åŠ¨ç”»æ§åˆ¶å™¨å†…ä½ çœŸçš„è®©hoeèƒ½å¤ŸæŒ–èµ°ç§å­äº†å—

**é—®é¢˜è¯´æ˜**:
- æ ‘æœ¨ç³»ç»Ÿè®¾è®¡ï¼šStage 0ï¼ˆæ ‘è‹—ï¼‰åªèƒ½è¢«é”„å¤´ï¼ˆHoeï¼‰æŒ–å‡º
- StageConfig é…ç½®æ­£ç¡®ï¼š`acceptedToolType = ToolType.Hoe`
- é—®é¢˜å‡ºåœ¨ `PlayerToolHitEmitter.BuildContext()` çš„å·¥å…·ç±»å‹æ¨æ–­é€»è¾‘

**ä¿®å¤å†…å®¹**:
è¯¦è§ `.kiro/specs/ç æ ‘ç³»ç»Ÿ/memory.md` ä¼šè¯ 3

**ç›¸å…³é…ç½®ç¡®è®¤**:
```csharp
// StageConfigFactory.CreateDefaultConfigs() - é˜¶æ®µ0é…ç½®
new StageConfig
{
    daysToNextStage = 1,
    health = 0,
    hasStump = false,
    stumpHealth = 0,
    enableCollider = false,
    enableOcclusion = false,
    acceptedToolType = ToolType.Hoe  // âœ… æ­£ç¡®é…ç½®
}
```

**é—ç•™é—®é¢˜**:
- [ ] éœ€è¦ç”¨æˆ·æµ‹è¯•éªŒè¯é”„å¤´æŒ–æ ‘è‹—åŠŸèƒ½

---

### ä¼šè¯ 1 - 2025-12-22

**ç”¨æˆ·éœ€æ±‚**:
> æ ‘æœ¨è¿˜éœ€è¦é‡æ–°è§„åˆ’ä¸€ä¸‹ï¼Œå†¬å¤©stage0ç›´æ¥æ­»å…‰ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰stageçš„å†¬å­£ç‰¹æ®ŠçŠ¶æ€winter meltedå‚æ•°æ˜¯ä¸å­˜åœ¨çš„ï¼Œç„¶åæ ‘æ¡©æˆ‘å†é‡æ–°æ”¹ä¸€ä¸‹ï¼Œ0~2éƒ½æ˜¯ä¸å­˜åœ¨æ ‘æ¡©çš„ï¼Œè¿™æ˜¯æ˜ç¡®çš„ï¼Œè€Œä¸”æ‰€æœ‰æ ‘æœ¨éƒ½å­˜åœ¨0~5stageï¼Œæ‰€ä»¥æˆ‘éœ€è¦ä½ æŠŠå¦‚å›¾è¿™ä¸ªstage configsçš„UIäº¤äº’æ”¹æˆå¦‚å›¾sprite configè¿™éƒ¨åˆ†çš„äº¤äº’å’Œæ˜¾ç¤ºæ–¹å¼ï¼Œè¯·ä½ ç›´æ¥ç…§æŠ„ï¼Œå› ä¸ºçŠ¶æ€æ•°é‡å°±æ˜¯ç¡®å®šçš„ï¼Œä¸éœ€è¦æ–°å¢ä¹Ÿä¸éœ€è¦å‡å°‘ç„¶åå¯¹äºspriteconfigå†…çš„stage0å¹¶ä¸éœ€è¦æ¯èä»¥åŠæ ‘æ¡©çš„éƒ¨åˆ†ï¼Œè¯·ä½ åˆ é™¤ï¼Œå¹¶ä¸”æˆ‘æ˜ç¡®å‘Šè¯‰ä½ 0~2é˜¶æ®µéƒ½æ˜¯æ²¡æœ‰æ ‘æ¡©çš„ï¼Œæ‰€ä»¥spriteconfigså’Œstageconfigséƒ½æ˜¯ç¡®å®šçš„å‚æ•°åˆ—è¡¨ï¼Œä¸å­˜åœ¨å¯é€‰ï¼Œç„¶åä½ ç›´æ¥åˆ é™¤2é˜¶æ®µçš„æ ‘æ¡©ï¼Œç„¶å3é˜¶æ®µåŠåé¢é˜¶æ®µçš„æ ‘æ¡©è¡€é‡ä¸å˜ï¼Œåªæ˜¯åˆ é™¤2é˜¶æ®µçš„æ ‘æ¡©ç„¶åè¿˜æœ‰å½±å­è®¾ç½®éƒ¨åˆ†çš„UIæ˜¾ç¤ºï¼Œè¿™ä¸ªç•Œé¢ä¹Ÿå¾ˆä¸€èˆ¬ä½ åšçš„ï¼Œå› ä¸ºè¿™äº›éƒ½æ˜¯æ˜ç¡®çš„å¹¶ä¸å­˜åœ¨çŠ¶æ€çš„å¢åŠ å’Œå‡å°‘ï¼Œæ‰€ä»¥æˆ‘éœ€è¦ä½ ç›´æ¥å±•ç¤ºå°±åƒspriteconfigsä¸€æ ·ï¼Œå¹¶ä¸”åŒ…æ‹¬ç æ ‘ç»éªŒstageexperienceéƒ¨åˆ†ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥æ€»ç»“å°±æ˜¯ä½ çš„UIäº¤äº’åšçš„å¾ˆçƒ‚è®©æˆ‘å¾ˆä¸æ–¹ä¾¿ï¼Œç„¶åä½ çš„å‚æ•°è®¾è®¡è¿˜éœ€è¦å®Œå–„å¹¶ç²¾ç¡®

**å®Œæˆä»»åŠ¡**:
1. ä» StageSpriteData ç±»ä¸­ç§»é™¤ winterMelted å­—æ®µ
2. æ›´æ–° TreeControllerV2 ä¸­ GetWinterSprite æ–¹æ³•ï¼Œç§»é™¤å¯¹ winterMelted çš„å¼•ç”¨
3. åˆ›å»º TreeControllerV2Editor è‡ªå®šä¹‰ç¼–è¾‘å™¨
4. å®ç°å›ºå®šå±•ç¤ºçš„ StageConfigs UIï¼ˆStage 0-5ï¼‰
5. å®ç°å›ºå®šå±•ç¤ºçš„ SpriteConfig UIï¼ˆé˜¶æ®µ0éšè—æ¯èå’Œæ ‘æ¡©ï¼Œé˜¶æ®µ1-2éšè—æ ‘æ¡©ï¼‰
6. å®ç°å›ºå®šå±•ç¤ºçš„ ShadowConfigs UIï¼ˆStage 1-5ï¼‰
7. å®ç°å›ºå®šå±•ç¤ºçš„ StageExperience UIï¼ˆStage 0-5ï¼‰
8. é˜¶æ®µ0å·¥å…·ç±»å‹å›ºå®šä¸º Hoe ä¸”åªè¯»

**ä¿®æ”¹æ–‡ä»¶**:
- `Assets/YYY_Scripts/Data/TreeSpriteData.cs` - ç§»é™¤ winterMelted å­—æ®µ
- `Assets/YYY_Scripts/Controller/TreeControllerV2.cs` - æ›´æ–° GetWinterSprite æ–¹æ³•ï¼Œæ·»åŠ æ‰è½é…ç½®å­—æ®µ
- `Assets/Editor/TreeControllerV2Editor.cs` - æ–°å»ºè‡ªå®šä¹‰ç¼–è¾‘å™¨ï¼Œæ·»åŠ æ‰è½é…ç½® UI

**è§£å†³æ–¹æ¡ˆ**:
åˆ›å»º TreeControllerV2Editor è‡ªå®šä¹‰ç¼–è¾‘å™¨ï¼Œå®Œå…¨æ¥ç®¡ Inspector ç»˜åˆ¶ï¼š
- StageConfigs: å›ºå®š6ä¸ªé˜¶æ®µï¼Œé˜¶æ®µ0-2éšè—æ ‘æ¡©è®¾ç½®ï¼Œé˜¶æ®µ0å·¥å…·ç±»å‹åªè¯»
- SpriteConfig: å›ºå®š6ä¸ªé˜¶æ®µï¼Œé˜¶æ®µ0éšè—æ¯èå’Œæ ‘æ¡©ï¼Œé˜¶æ®µ1-2éšè—æ ‘æ¡©
- ShadowConfigs: å›ºå®š5ä¸ªé…ç½®ï¼ˆå¯¹åº”é˜¶æ®µ1-5ï¼‰
- StageExperience: å›ºå®š6ä¸ªç»éªŒå€¼
- DropConfig: æ–°å¢æ‰è½é…ç½®ï¼ˆç‰©å“SOã€å„é˜¶æ®µæ‰è½æ•°é‡ã€æ ‘æ¡©æ‰è½æ•°é‡ï¼‰

**é—ç•™é—®é¢˜**:
- æ— 

---

## å…³é”®å†³ç­–

| å†³ç­– | åŸå›  | æ—¥æœŸ |
|------|------|------|
| ç§»é™¤ winterMelted å­—æ®µ | å†¬å­£é˜¶æ®µ0ç›´æ¥æ­»äº¡ï¼Œä¸å­˜åœ¨èåŒ–çŠ¶æ€ | 2025-12-22 |
| é˜¶æ®µ0-2éšè—æ ‘æ¡©è®¾ç½® | åªæœ‰é˜¶æ®µ3-5æœ‰æ ‘æ¡© | 2025-12-22 |
| é˜¶æ®µ0å·¥å…·ç±»å‹å›ºå®šä¸º Hoe | æ ‘è‹—åªèƒ½ç”¨é”„å¤´æŒ–å‡º | 2025-12-22 |
| ä½¿ç”¨ CustomEditor å›ºå®šå±•ç¤º | æ•°ç»„å¤§å°å›ºå®šï¼Œä¸éœ€è¦å¢å‡åŠŸèƒ½ | 2025-12-22 |
| ç®€åŒ–æ‰è½é…ç½® | ç§»é™¤ DropTableï¼Œç›´æ¥é…ç½®ç‰©å“ SO å’Œæ•°é‡ | 2025-12-22 |
| æ ‘è‹—å†¬å­£ç›´æ¥æ­»äº¡ | æ ‘è‹—æ²¡æœ‰å†¬å­£ Spriteï¼Œå†¬å­£åˆ°æ¥æ—¶ç›´æ¥é”€æ¯ | 2025-12-24 |
| ç§»é™¤ isFrozenSapling å­—æ®µ | æ ‘è‹—ä¸å†æœ‰å†°å°çŠ¶æ€ï¼Œç›´æ¥æ­»äº¡ | 2025-12-24 |
| Stage 0 éšè—å†¬å­£ Sprite å­—æ®µ | æ ‘è‹—åœ¨å†¬å­£ç›´æ¥æ­»äº¡ï¼Œä¸éœ€è¦å†¬å­£ Sprite | 2025-12-24 |
| ç®€åŒ–å­£èŠ‚å­—æ®µå‘½å | ç”¨æˆ·è¦æ±‚æ›´ç›´è§‚çš„å‘½åï¼šspring/summer/earlyFall/lateFall/winter | 2025-12-30 |
| æ·»åŠ è¿è¡Œæ—¶ Inspector è°ƒè¯• | ç”¨æˆ·è¦æ±‚åœ¨è¿è¡Œæ—¶ä¿®æ”¹å‚æ•°èƒ½ç«‹å³æ›´æ–°æ˜¾ç¤º | 2025-12-30 |

## ç›¸å…³æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `Assets/YYY_Scripts/Controller/TreeControllerV2.cs` | æ ‘æœ¨æ§åˆ¶å™¨ä¸»è„šæœ¬ |
| `Assets/YYY_Scripts/Controller/TreeController.cs` | æ—§ç‰ˆæ ‘æœ¨æ§åˆ¶å™¨ï¼ˆå…¼å®¹ï¼‰ |
| `Assets/YYY_Scripts/Service/SeasonManager.cs` | å­£èŠ‚ç®¡ç†å™¨ |
| `Assets/YYY_Scripts/Data/TreeSpriteData.cs` | Sprite æ•°æ®ç»“æ„å®šä¹‰ |
| `Assets/YYY_Scripts/Data/StageConfig.cs` | é˜¶æ®µé…ç½®æ•°æ®ç»“æ„ |
| `Assets/Editor/TreeControllerV2Editor.cs` | è‡ªå®šä¹‰ç¼–è¾‘å™¨ |

---

## â˜…â˜…â˜… å­£èŠ‚äº‹ä»¶ç³»ç»Ÿè®¾è®¡ï¼ˆå®Œæ•´æ–‡æ¡£ï¼‰â˜…â˜…â˜…

### æ¦‚è¿°

æ ‘æœ¨ç³»ç»Ÿè®¢é˜…å¤šä¸ªå­£èŠ‚å’Œå¤©æ°”ç›¸å…³äº‹ä»¶ï¼Œæ ¹æ®äº‹ä»¶ç±»å‹å¯¹æ ‘æœ¨æ ·å¼è¿›è¡Œç›¸åº”ä¿®æ”¹ã€‚

### äº‹ä»¶è®¢é˜…åˆ—è¡¨

TreeControllerV2 åœ¨ `Start()` ä¸­è®¢é˜…ä»¥ä¸‹äº‹ä»¶ï¼š

```csharp
SeasonManager.OnSeasonChanged += OnSeasonChanged;           // æ—¥å†å­£èŠ‚å˜åŒ–
SeasonManager.OnVegetationSeasonChanged += OnVegetationSeasonChanged;  // æ¤è¢«å­£èŠ‚å˜åŒ–
TimeManager.OnDayChanged += OnDayChanged;                   // æ¯æ—¥å˜åŒ–ï¼ˆæˆé•¿ï¼‰
WeatherSystem.OnPlantsWither += OnWeatherWither;            // å¤©æ°”æ¯è
WeatherSystem.OnPlantsRecover += OnWeatherRecover;          // å¤©æ°”æ¢å¤
WeatherSystem.OnWinterSnow += OnWinterSnow;                 // å†¬å­£ä¸‹é›ª
WeatherSystem.OnWinterMelt += OnWinterMelt;                 // å†¬å­£èåŒ–
```

### äº‹ä»¶å¤„ç†è¯¦è§£

#### 1. OnSeasonChangedï¼ˆæ—¥å†å­£èŠ‚å˜åŒ–ï¼‰

**è§¦å‘æ—¶æœº**ï¼šæ—¥å†å­£èŠ‚ä»ä¸€ä¸ªå­£èŠ‚åˆ‡æ¢åˆ°å¦ä¸€ä¸ªå­£èŠ‚ï¼ˆæ˜¥â†’å¤â†’ç§‹â†’å†¬â†’æ˜¥ï¼‰

**å¤„ç†é€»è¾‘**ï¼š

| æ–°å­£èŠ‚ | æ ‘æœ¨çŠ¶æ€ | å¤„ç†æ–¹å¼ |
|--------|---------|---------|
| æ˜¥å­£ | Withered/Frozen/Melted | æ¢å¤ä¸º Normalï¼Œæ¸…é™¤ isWeatherWithered |
| å†¬å­£ | Stage 0ï¼ˆæ ‘è‹—ï¼‰ | **ç›´æ¥é”€æ¯**ï¼ˆè°ƒç”¨ DestroyTree()ï¼‰ |
| å…¶ä»– | ä»»æ„ | è°ƒç”¨ UpdateSprite() æ›´æ–°æ˜¾ç¤º |

**ä»£ç é€»è¾‘**ï¼š
```csharp
private void OnSeasonChanged(SeasonManager.Season newSeason)
{
    currentSeason = newSeason;
    
    // æ˜¥å­£ï¼šæ‰€æœ‰æ¯èæ¤ç‰©å¤è‹
    if (newSeason == SeasonManager.Season.Spring)
    {
        if (currentState == TreeState.Withered || 
            currentState == TreeState.Frozen || 
            currentState == TreeState.Melted)
        {
            currentState = TreeState.Normal;
            isWeatherWithered = false;
        }
    }
    
    // å†¬å­£ï¼šæ ‘è‹—ç›´æ¥æ­»äº¡
    if (newSeason == SeasonManager.Season.Winter)
    {
        if (currentStageIndex == STAGE_SAPLING)
        {
            DestroyTree();
            return;
        }
    }
    
    UpdateSprite();
}
```

#### 2. OnVegetationSeasonChangedï¼ˆæ¤è¢«å­£èŠ‚å˜åŒ–ï¼‰

**è§¦å‘æ—¶æœº**ï¼šæ¤è¢«å­£èŠ‚æˆ–æ¸å˜è¿›åº¦å‘ç”Ÿå˜åŒ–

**å¤„ç†é€»è¾‘**ï¼šç›´æ¥è°ƒç”¨ `UpdateSprite()` æ›´æ–°æ ‘æœ¨æ˜¾ç¤º

**æ ·å¼é€‰æ‹©æµç¨‹**ï¼š
1. è·å–å½“å‰æ¤è¢«å­£èŠ‚ï¼ˆVegetationSeasonï¼‰
2. è·å–æ¸å˜è¿›åº¦ï¼ˆ0.0-1.0ï¼‰
3. æ ¹æ®æ ‘æœ¨IDç”Ÿæˆå›ºå®šéšæœºå€¼
4. å¦‚æœ `treeSeedValue < progress`ï¼Œæ˜¾ç¤ºä¸‹ä¸€å­£èŠ‚æ ·å¼
5. å¦åˆ™æ˜¾ç¤ºå½“å‰å­£èŠ‚æ ·å¼

#### 3. OnDayChangedï¼ˆæ¯æ—¥å˜åŒ–ï¼‰

**è§¦å‘æ—¶æœº**ï¼šæ¸¸æˆå†…æ¯å¤©å¼€å§‹æ—¶

**å¤„ç†é€»è¾‘**ï¼š

| æ¡ä»¶ | å¤„ç†æ–¹å¼ |
|------|---------|
| çŠ¶æ€ä¸æ˜¯ Normal | ä¸æˆé•¿ |
| å·²è¾¾æœ€å¤§é˜¶æ®µï¼ˆStage 5ï¼‰ | ä¸æˆé•¿ |
| å½“å‰æ˜¯å†¬å­£ | ä¸æˆé•¿ |
| å¤©æ°”æ¯èä¸­ | ä¸æˆé•¿ |
| æˆé•¿å¤©æ•°æœªè¾¾æ ‡ | å¢åŠ å¤©æ•°ï¼Œä¸æˆé•¿ |
| æˆé•¿ç©ºé—´ä¸è¶³ | ä¸æˆé•¿ï¼Œç­‰å¾…ç©ºé—´ |
| ä»¥ä¸Šéƒ½æ»¡è¶³ | æˆé•¿åˆ°ä¸‹ä¸€é˜¶æ®µ |

**æˆé•¿åæ›´æ–°**ï¼š
- é‡ç½®é˜¶æ®µå¤©æ•°
- åˆå§‹åŒ–æ–°é˜¶æ®µè¡€é‡
- è°ƒç”¨ `UpdateSprite()` æ›´æ–°æ˜¾ç¤º
- è°ƒç”¨ `UpdatePolygonColliderShape()` æ›´æ–°ç¢°æ’ä½“

#### 4. OnWeatherWitherï¼ˆå¤©æ°”æ¯èï¼‰

**è§¦å‘æ—¶æœº**ï¼šå¤©æ°”ç³»ç»Ÿè§¦å‘æ¤ç‰©æ¯èäº‹ä»¶ï¼ˆå¦‚æç«¯é«˜æ¸©ï¼‰

**å¤„ç†é€»è¾‘**ï¼š

| å½“å‰çŠ¶æ€ | å¤„ç†æ–¹å¼ |
|---------|---------|
| Normal | è®¾ç½® isWeatherWithered=trueï¼ŒçŠ¶æ€æ”¹ä¸º Witheredï¼Œæ›´æ–°æ˜¾ç¤º |
| å…¶ä»– | ä¸å¤„ç† |

**æ ·å¼å˜åŒ–**ï¼šæ˜¾ç¤ºæ¯èçŠ¶æ€ Spriteï¼ˆwitheredSummer æˆ– witheredFallï¼‰

#### 5. OnWeatherRecoverï¼ˆå¤©æ°”æ¢å¤ï¼‰

**è§¦å‘æ—¶æœº**ï¼šå¤©æ°”ç³»ç»Ÿè§¦å‘æ¤ç‰©æ¢å¤äº‹ä»¶

**å¤„ç†é€»è¾‘**ï¼š

| æ¡ä»¶ | å¤„ç†æ–¹å¼ |
|------|---------|
| isWeatherWithered=true | æ¸…é™¤æ ‡è®°ï¼ŒçŠ¶æ€æ”¹ä¸º Normalï¼Œæ›´æ–°æ˜¾ç¤º |
| å…¶ä»– | ä¸å¤„ç† |

**æ ·å¼å˜åŒ–**ï¼šæ¢å¤æ­£å¸¸çŠ¶æ€ Sprite

#### 6. OnWinterSnowï¼ˆå†¬å­£ä¸‹é›ªï¼‰

**è§¦å‘æ—¶æœº**ï¼šå†¬å­£å¤©æ°”ç³»ç»Ÿè§¦å‘ä¸‹é›ªäº‹ä»¶

**å¤„ç†é€»è¾‘**ï¼š

| å½“å‰é˜¶æ®µ | å¤„ç†æ–¹å¼ |
|---------|---------|
| Stage 0ï¼ˆæ ‘è‹—ï¼‰ | **ç›´æ¥é”€æ¯** |
| Stage 1-5 | çŠ¶æ€æ”¹ä¸º Frozenï¼Œæ›´æ–°æ˜¾ç¤º |

**æ ·å¼å˜åŒ–**ï¼šæ˜¾ç¤ºå†¬å­£æŒ‚å†° Spriteï¼ˆwinter å­—æ®µï¼‰

#### 7. OnWinterMeltï¼ˆå†¬å­£èåŒ–ï¼‰

**è§¦å‘æ—¶æœº**ï¼šå†¬å­£å¤©æ°”ç³»ç»Ÿè§¦å‘èåŒ–äº‹ä»¶ï¼ˆå¤§å¤ªé˜³ï¼‰

**å¤„ç†é€»è¾‘**ï¼š

| å½“å‰é˜¶æ®µ | å¤„ç†æ–¹å¼ |
|---------|---------|
| Stage 0ï¼ˆæ ‘è‹—ï¼‰ | **ç›´æ¥é”€æ¯** |
| Stage 1-5 | çŠ¶æ€æ”¹ä¸º Meltedï¼Œæ›´æ–°æ˜¾ç¤º |

**æ ·å¼å˜åŒ–**ï¼šæ˜¾ç¤ºæ¯èçŠ¶æ€ Spriteï¼ˆé™çº§åˆ° witheredFallï¼‰

### æ ‘æœ¨çŠ¶æ€æšä¸¾

```csharp
public enum TreeState
{
    Normal,    // æ­£å¸¸çŠ¶æ€
    Withered,  // æ¯èçŠ¶æ€ï¼ˆå¤©æ°”å¯¼è‡´ï¼‰
    Frozen,    // å†°å°çŠ¶æ€ï¼ˆå†¬å­£ä¸‹é›ªï¼‰
    Melted,    // èåŒ–çŠ¶æ€ï¼ˆå†¬å­£å¤§å¤ªé˜³ï¼‰
    Stump      // æ ‘æ¡©çŠ¶æ€ï¼ˆè¢«ç å€’åï¼‰
}
```

### çŠ¶æ€ä¸æ ·å¼æ˜ å°„

| çŠ¶æ€ | æ ·å¼é€‰æ‹©é€»è¾‘ |
|------|-------------|
| Normal | æ ¹æ®æ¤è¢«å­£èŠ‚å’Œæ¸å˜è¿›åº¦é€‰æ‹© spring/summer/earlyFall/lateFall/winter |
| Withered | æ ¹æ®å­£èŠ‚é€‰æ‹© witheredSummer æˆ– witheredFall |
| Frozen | æ˜¾ç¤º winter Spriteï¼ˆæŒ‚å†°çŠ¶æ€ï¼‰ |
| Melted | é™çº§æ˜¾ç¤º witheredFall Sprite |
| Stump | æ ¹æ®å­£èŠ‚é€‰æ‹© stumpSpringSummer/stumpFall/stumpWinter |

### å­£èŠ‚æ ·å¼ Sprite é…ç½®

æ¯ä¸ªé˜¶æ®µçš„ `StageSpriteData` åŒ…å«ï¼š

```csharp
public class StageSpriteData
{
    // æ­£å¸¸çŠ¶æ€ - 5ç§å­£èŠ‚æ ·å¼
    public SeasonSpriteSet normal;  // spring, summer, earlyFall, lateFall, winter
    
    // æ¯èçŠ¶æ€ - 2ç§æ ·å¼
    public Sprite witheredSummer;   // å¤å­£æ¯è
    public Sprite witheredFall;     // ç§‹å­£æ¯è
    
    // æ ‘æ¡©çŠ¶æ€ - 3ç§æ ·å¼ï¼ˆä»… Stage 3-5ï¼‰
    public Sprite stumpSpringSummer;  // æ˜¥å¤æ ‘æ¡©
    public Sprite stumpFall;          // ç§‹å­£æ ‘æ¡©
    public Sprite stumpWinter;        // å†¬å­£æ ‘æ¡©
}
```

### äº‹ä»¶æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å­£èŠ‚äº‹ä»¶å¤„ç†æµç¨‹                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  OnSeasonChanged â”€â”€â”¬â”€â”€ æ˜¥å­£ â”€â”€â†’ å¤è‹ï¼ˆWithered/Frozen/Melted â†’ Normalï¼‰ â”‚
â”‚                    â”œâ”€â”€ å†¬å­£ â”€â”€â†’ æ ‘è‹—é”€æ¯ / å…¶ä»–æ›´æ–°æ˜¾ç¤º                  â”‚
â”‚                    â””â”€â”€ å…¶ä»– â”€â”€â†’ æ›´æ–°æ˜¾ç¤º                                 â”‚
â”‚                                                                          â”‚
â”‚  OnVegetationSeasonChanged â”€â”€â†’ æ›´æ–°æ˜¾ç¤ºï¼ˆæ¸å˜é€»è¾‘ï¼‰                       â”‚
â”‚                                                                          â”‚
â”‚  OnDayChanged â”€â”€â†’ æ£€æŸ¥æˆé•¿æ¡ä»¶ â”€â”€â†’ æˆé•¿åˆ°ä¸‹ä¸€é˜¶æ®µ â”€â”€â†’ æ›´æ–°æ˜¾ç¤º           â”‚
â”‚                                                                          â”‚
â”‚  OnWeatherWither â”€â”€â†’ Normal â†’ Withered â”€â”€â†’ æ˜¾ç¤ºæ¯èæ ·å¼                  â”‚
â”‚                                                                          â”‚
â”‚  OnWeatherRecover â”€â”€â†’ Withered â†’ Normal â”€â”€â†’ æ¢å¤æ­£å¸¸æ ·å¼                 â”‚
â”‚                                                                          â”‚
â”‚  OnWinterSnow â”€â”€â”¬â”€â”€ æ ‘è‹— â”€â”€â†’ é”€æ¯                                        â”‚
â”‚                 â””â”€â”€ å…¶ä»– â”€â”€â†’ Frozen â”€â”€â†’ æ˜¾ç¤ºæŒ‚å†°æ ·å¼                     â”‚
â”‚                                                                          â”‚
â”‚  OnWinterMelt â”€â”€â”¬â”€â”€ æ ‘è‹— â”€â”€â†’ é”€æ¯                                        â”‚
â”‚                 â””â”€â”€ å…¶ä»– â”€â”€â†’ Melted â”€â”€â†’ æ˜¾ç¤ºèåŒ–æ ·å¼                     â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç‰¹æ®Šè§„åˆ™

1. **æ ‘è‹—ï¼ˆStage 0ï¼‰å†¬å­£å¿…æ­»**ï¼šæ— è®ºæ˜¯å­£èŠ‚åˆ‡æ¢ã€ä¸‹é›ªè¿˜æ˜¯èåŒ–ï¼Œæ ‘è‹—åœ¨å†¬å­£éƒ½ä¼šè¢«é”€æ¯
2. **æ˜¥å­£å…¨é¢å¤è‹**ï¼šè¿›å…¥æ˜¥å­£æ—¶ï¼Œæ‰€æœ‰éæ­£å¸¸çŠ¶æ€çš„æ ‘æœ¨éƒ½ä¼šæ¢å¤æ­£å¸¸
3. **å¤©æ°”æ¯èç‹¬ç«‹æ ‡è®°**ï¼š`isWeatherWithered` ç”¨äºåŒºåˆ†å¤©æ°”å¯¼è‡´çš„æ¯èå’Œå…¶ä»–åŸå› 
4. **æ¸å˜åŸºäºæ ‘æœ¨ID**ï¼šæ¯æ£µæ ‘çš„æ¸å˜æ—¶æœºç”±å…¶ InstanceID å†³å®šï¼Œä¿è¯åœºæ™¯ä¸­æ ‘æœ¨é€æ¸è¿‡æ¸¡

---

## â˜…â˜…â˜… å­£èŠ‚æ—¶é—´è¡¨ä¸äº‹ä»¶è§¦å‘é“¾ï¼ˆå®Œæ•´æ–‡æ¡£ï¼‰â˜…â˜…â˜…

### ä¸€å¹´å®Œæ•´æ—¶é—´è¡¨ï¼ˆ112å¤©ï¼‰

| æ—¥å†å­£èŠ‚ | å¤©æ•°èŒƒå›´ | æ€»å¤©æ•° | æ¤è¢«å­£èŠ‚ | æ¸å˜è¿›åº¦ | æ˜¾ç¤ºæ ·å¼ |
|---------|---------|-------|---------|---------|---------|
| æ˜¥å­£ | 1-14 | 1-14 | Spring | 0% | 100% spring |
| æ˜¥å­£ | 15-28 | 15-28 | Spring | 7%â†’100% | spring â†’ summer æ¸å˜ |
| å¤å­£ | 1-14 | 29-42 | Summer | 0% | 100% summer |
| å¤å­£ | 15-28 | 43-56 | Summer | 7%â†’100% | summer â†’ earlyFall æ¸å˜ |
| ç§‹å­£ | 1-14 | 57-70 | EarlyFall | 7%â†’100% | earlyFall â†’ lateFall æ¸å˜ |
| ç§‹å­£ | 15-28 | 71-84 | LateFall | 0% | 100% lateFall |
| å†¬å­£ | 1-28 | 85-112 | Winter | 0% | 100% winter |

### å…³é”®æ—¶é—´ç‚¹äº‹ä»¶è§¦å‘

#### æ˜¥å­£ç¬¬1å¤©ï¼ˆå¹´åˆ/å†¬â†’æ˜¥ï¼‰

```
TimeManager.OnSeasonChanged(Spring) è§¦å‘
    â†“
SeasonManager.OnTimeManagerSeasonChanged(Spring)
    â”œâ”€â”€ SetSeason(Spring) â†’ OnSeasonChanged äº‹ä»¶
    â””â”€â”€ UpdateVegetationSeason()
            â”œâ”€â”€ VegetationSeason = Spring
            â”œâ”€â”€ progress = 0
            â””â”€â”€ OnVegetationSeasonChanged äº‹ä»¶
                    â†“
TreeControllerV2.OnSeasonChanged(Spring)
    â”œâ”€â”€ çŠ¶æ€æ£€æŸ¥ï¼šWithered/Frozen/Melted â†’ Normalï¼ˆå¤è‹ï¼‰
    â””â”€â”€ UpdateSprite() â†’ æ˜¾ç¤º spring æ ·å¼

TreeControllerV2.OnVegetationSeasonChanged()
    â””â”€â”€ UpdateSprite() â†’ æ˜¾ç¤º spring æ ·å¼
```

#### æ˜¥å­£ç¬¬15å¤©ï¼ˆå¼€å§‹æ¸å˜ï¼‰

```
TimeManager.OnDayChanged(year, 15, totalDays) è§¦å‘
    â†“
SeasonManager.OnTimeManagerDayChanged()
    â””â”€â”€ UpdateVegetationSeason()
            â”œâ”€â”€ VegetationSeason = Springï¼ˆä¿æŒä¸å˜ï¼‰
            â”œâ”€â”€ progress = 1/14 â‰ˆ 0.07ï¼ˆ7%ï¼‰
            â””â”€â”€ OnVegetationSeasonChanged äº‹ä»¶
                    â†“
TreeControllerV2.OnVegetationSeasonChanged()
    â””â”€â”€ UpdateSprite()
            â””â”€â”€ GetNormalSprite()
                    â”œâ”€â”€ treeSeedValue < 0.07 â†’ æ˜¾ç¤º summer
                    â””â”€â”€ treeSeedValue >= 0.07 â†’ æ˜¾ç¤º spring
```

#### æ˜¥å­£ç¬¬28å¤©ï¼ˆæ¸å˜å®Œæˆå‰å¤•ï¼‰

```
TimeManager.OnDayChanged(year, 28, totalDays) è§¦å‘
    â†“
SeasonManager.UpdateVegetationSeason()
    â”œâ”€â”€ VegetationSeason = Spring
    â”œâ”€â”€ progress = 14/14 = 1.0ï¼ˆ100%ï¼‰
    â””â”€â”€ OnVegetationSeasonChanged äº‹ä»¶
            â†“
TreeControllerV2.UpdateSprite()
    â””â”€â”€ å‡ ä¹æ‰€æœ‰æ ‘æœ¨æ˜¾ç¤º summer æ ·å¼ï¼ˆtreeSeedValue < 1.0ï¼‰
```

#### å¤å­£ç¬¬1å¤©ï¼ˆæ˜¥â†’å¤ï¼‰

```
TimeManager.OnSeasonChanged(Summer) è§¦å‘
    â†“
SeasonManager.OnTimeManagerSeasonChanged(Summer)
    â”œâ”€â”€ SetSeason(Summer) â†’ OnSeasonChanged äº‹ä»¶
    â””â”€â”€ UpdateVegetationSeason()
            â”œâ”€â”€ VegetationSeason = Summer
            â”œâ”€â”€ progress = 0
            â””â”€â”€ OnVegetationSeasonChanged äº‹ä»¶
                    â†“
TreeControllerV2.OnSeasonChanged(Summer)
    â””â”€â”€ UpdateSprite() â†’ æ˜¾ç¤º summer æ ·å¼

TreeControllerV2.OnVegetationSeasonChanged()
    â””â”€â”€ UpdateSprite() â†’ 100% summer æ ·å¼
```

#### ç§‹å­£ç¬¬1å¤©ï¼ˆå¤â†’ç§‹ï¼Œç‰¹æ®Šï¼šç«‹å³å¼€å§‹æ¸å˜ï¼‰

```
TimeManager.OnSeasonChanged(Autumn) è§¦å‘
    â†“
SeasonManager.OnTimeManagerSeasonChanged(Autumn)
    â”œâ”€â”€ SetSeason(Autumn) â†’ OnSeasonChanged äº‹ä»¶
    â””â”€â”€ UpdateVegetationSeason()
            â”œâ”€â”€ VegetationSeason = EarlyFall
            â”œâ”€â”€ progress = 1/14 â‰ˆ 0.07ï¼ˆâ˜… ç§‹å­£ç‰¹æ®Šï¼šç¬¬1å¤©å°±å¼€å§‹æ¸å˜ï¼‰
            â””â”€â”€ OnVegetationSeasonChanged äº‹ä»¶
                    â†“
TreeControllerV2.OnSeasonChanged(Autumn)
    â””â”€â”€ UpdateSprite()

TreeControllerV2.OnVegetationSeasonChanged()
    â””â”€â”€ UpdateSprite()
            â””â”€â”€ GetNormalSprite()
                    â”œâ”€â”€ treeSeedValue < 0.07 â†’ æ˜¾ç¤º lateFall
                    â””â”€â”€ treeSeedValue >= 0.07 â†’ æ˜¾ç¤º earlyFall
```

#### ç§‹å­£ç¬¬15å¤©ï¼ˆè¿›å…¥æ™šç§‹ï¼‰

```
TimeManager.OnDayChanged(year, 15, totalDays) è§¦å‘
    â†“
SeasonManager.UpdateVegetationSeason()
    â”œâ”€â”€ VegetationSeason = LateFallï¼ˆåˆ‡æ¢ï¼ï¼‰
    â”œâ”€â”€ progress = 0
    â””â”€â”€ OnVegetationSeasonChanged äº‹ä»¶
            â†“
TreeControllerV2.UpdateSprite()
    â””â”€â”€ 100% lateFall æ ·å¼
```

#### å†¬å­£ç¬¬1å¤©ï¼ˆç§‹â†’å†¬ï¼Œæ ‘è‹—æ­»äº¡ï¼‰

```
TimeManager.OnSeasonChanged(Winter) è§¦å‘
    â†“
SeasonManager.OnTimeManagerSeasonChanged(Winter)
    â”œâ”€â”€ SetSeason(Winter) â†’ OnSeasonChanged äº‹ä»¶
    â””â”€â”€ UpdateVegetationSeason()
            â”œâ”€â”€ VegetationSeason = Winter
            â”œâ”€â”€ progress = 0
            â””â”€â”€ OnVegetationSeasonChanged äº‹ä»¶
                    â†“
TreeControllerV2.OnSeasonChanged(Winter)
    â”œâ”€â”€ ã€Stage 0 æ ‘è‹—ã€‘â†’ DestroyTree() â˜… ç›´æ¥é”€æ¯
    â””â”€â”€ ã€Stage 1-5ã€‘â†’ UpdateSprite() â†’ æ˜¾ç¤º winter æ ·å¼

TreeControllerV2.OnVegetationSeasonChanged()
    â””â”€â”€ UpdateSprite() â†’ æ˜¾ç¤º winter æ ·å¼
```

### å¤©æ°”äº‹ä»¶è§¦å‘é“¾

#### æç«¯é«˜æ¸©ï¼ˆä»»æ„å­£èŠ‚ï¼‰

```
WeatherSystem.OnPlantsWither è§¦å‘
    â†“
TreeControllerV2.OnWeatherWither()
    â”œâ”€â”€ æ¡ä»¶ï¼šcurrentState == Normal
    â”œâ”€â”€ isWeatherWithered = true
    â”œâ”€â”€ currentState = Withered
    â””â”€â”€ UpdateSprite()
            â””â”€â”€ GetWitheredSprite()
                    â”œâ”€â”€ æ˜¥/å¤ â†’ witheredSummer
                    â””â”€â”€ ç§‹/å†¬ â†’ witheredFall
```

#### å¤©æ°”æ¢å¤

```
WeatherSystem.OnPlantsRecover è§¦å‘
    â†“
TreeControllerV2.OnWeatherRecover()
    â”œâ”€â”€ æ¡ä»¶ï¼šisWeatherWithered == true
    â”œâ”€â”€ isWeatherWithered = false
    â”œâ”€â”€ currentState = Normal
    â””â”€â”€ UpdateSprite() â†’ æ¢å¤æ­£å¸¸å­£èŠ‚æ ·å¼
```

#### å†¬å­£ä¸‹é›ª

```
WeatherSystem.OnWinterSnow è§¦å‘
    â†“
TreeControllerV2.OnWinterSnow()
    â”œâ”€â”€ æ¡ä»¶ï¼šcurrentSeason == Winter
    â”œâ”€â”€ ã€Stage 0 æ ‘è‹—ã€‘â†’ DestroyTree() â˜… ç›´æ¥é”€æ¯
    â””â”€â”€ ã€Stage 1-5ã€‘
            â”œâ”€â”€ currentState = Frozen
            â””â”€â”€ UpdateSprite() â†’ æ˜¾ç¤º winter æ ·å¼ï¼ˆæŒ‚å†°ï¼‰
```

#### å†¬å­£èåŒ–ï¼ˆå¤§å¤ªé˜³ï¼‰

```
WeatherSystem.OnWinterMelt è§¦å‘
    â†“
TreeControllerV2.OnWinterMelt()
    â”œâ”€â”€ æ¡ä»¶ï¼šcurrentSeason == Winter
    â”œâ”€â”€ ã€Stage 0 æ ‘è‹—ã€‘â†’ DestroyTree() â˜… ç›´æ¥é”€æ¯
    â””â”€â”€ ã€Stage 1-5ã€‘
            â”œâ”€â”€ currentState = Melted
            â””â”€â”€ UpdateSprite() â†’ æ˜¾ç¤º witheredFall æ ·å¼ï¼ˆé™çº§ï¼‰
```

### æ¯æ—¥æˆé•¿è§¦å‘é“¾

```
TimeManager.OnDayChanged(year, seasonDay, totalDays) è§¦å‘
    â†“
TreeControllerV2.OnDayChanged()
    â”œâ”€â”€ æ£€æŸ¥ï¼šlastCheckDay != totalDaysï¼ˆé˜²é‡å¤ï¼‰
    â”œâ”€â”€ æ£€æŸ¥ï¼šcurrentState == Normal
    â”œâ”€â”€ æ£€æŸ¥ï¼šcurrentStageIndex < STAGE_MAX
    â”œâ”€â”€ æ£€æŸ¥ï¼šcurrentSeason != Winter
    â”œâ”€â”€ æ£€æŸ¥ï¼š!isWeatherWithered
    â”‚
    â”œâ”€â”€ daysInCurrentStage++
    â”‚
    â””â”€â”€ å¦‚æœ daysInCurrentStage >= config.daysToNextStage
            â”œâ”€â”€ æ£€æŸ¥ï¼šCanGrowToNextStage()ï¼ˆç©ºé—´æ£€æµ‹ï¼‰
            â”‚       â”œâ”€â”€ ç©ºé—´ä¸è¶³ â†’ è¿”å›ï¼Œç­‰å¾…ç©ºé—´
            â”‚       â””â”€â”€ ç©ºé—´å……è¶³ â†’ ç»§ç»­
            â”‚
            â””â”€â”€ GrowToNextStage()
                    â”œâ”€â”€ currentStageIndex++
                    â”œâ”€â”€ daysInCurrentStage = 0
                    â”œâ”€â”€ InitializeHealth()
                    â”œâ”€â”€ UpdateSprite()
                    â””â”€â”€ UpdatePolygonColliderShape()
```

### æ¸å˜è¿›åº¦è®¡ç®—å…¬å¼

```csharp
// SeasonManager.UpdateVegetationSeason() ä¸­çš„è®¡ç®—

// æ˜¥å­£æ¸å˜ï¼ˆæ˜¥15-28ï¼‰
if (currentSeason == Spring && dayInSeason > 14)
{
    progress = (dayInSeason - 14) / 14f;  // 1/14 â†’ 14/14
}

// å¤å­£æ¸å˜ï¼ˆå¤15-28ï¼‰
if (currentSeason == Summer && dayInSeason > 14)
{
    progress = (dayInSeason - 14) / 14f;  // 1/14 â†’ 14/14
}

// ç§‹å­£æ¸å˜ï¼ˆç§‹1-14ï¼Œç‰¹æ®Šï¼šç¬¬1å¤©å°±å¼€å§‹ï¼‰
if (currentSeason == Autumn && dayInSeason <= 14)
{
    progress = dayInSeason / 14f;  // 1/14 â†’ 14/14
}
```

### æ¸å˜æ ·å¼é€‰æ‹©é€»è¾‘

```csharp
// TreeControllerV2.GetNormalSprite() ä¸­çš„é€»è¾‘

int seed = treeID + currentStageIndex * 100;
Random.InitState(seed);
float treeSeedValue = Random.value;  // 0.0 - 1.0 å›ºå®šå€¼

if (treeSeedValue < progress)
{
    // æ˜¾ç¤ºä¸‹ä¸€å­£èŠ‚æ ·å¼
    return stageData.normal.GetSprite(GetNextVegetationSeason(vegSeason));
}
else
{
    // æ˜¾ç¤ºå½“å‰å­£èŠ‚æ ·å¼
    return stageData.normal.GetSprite(vegSeason);
}
```

### å®Œæ•´å¹´åº¦æ—¶é—´çº¿å›¾

```
Day:  1    14   15   28 | 1    14   15   28 | 1    14   15   28 | 1         28
      â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
      â”‚ æ˜¥å­£å‰åŠ â”‚ æ˜¥å­£ååŠ â”‚  â”‚ å¤å­£å‰åŠ â”‚ å¤å­£ååŠ â”‚  â”‚ ç§‹å­£å‰åŠ â”‚ ç§‹å­£ååŠ â”‚  â”‚   å†¬å­£    â”‚
      â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
æ ·å¼: â”‚100%â”‚æ¸å˜â”‚æ¸å˜â”‚  â”‚100%â”‚æ¸å˜â”‚æ¸å˜â”‚  â”‚æ¸å˜â”‚æ¸å˜â”‚100%â”‚  â”‚  100%    â”‚
      â”‚æ˜¥å­£â”‚æ˜¥â†’å¤â”‚æ˜¥â†’å¤â”‚  â”‚å¤å­£â”‚å¤â†’ç§‹â”‚å¤â†’ç§‹â”‚  â”‚ç§‹â†’æ™šâ”‚ç§‹â†’æ™šâ”‚æ™šç§‹â”‚  â”‚  å†¬å­£    â”‚
      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      
äº‹ä»¶: â†‘                  â†‘                  â†‘                  â†‘
      æ˜¥å­£å¤è‹            æ— ç‰¹æ®Š             ç§‹å­£ç«‹å³æ¸å˜        æ ‘è‹—æ­»äº¡
      (Frozenâ†’Normal)                       (ç¬¬1å¤©å°±å¼€å§‹)       (Stage0é”€æ¯)
```

---

## â˜…â˜…â˜… å¤©æ°”ç³»ç»Ÿä¸äº‹ä»¶è§¦å‘ï¼ˆå®Œæ•´æ–‡æ¡£ï¼‰â˜…â˜…â˜…

### æ¦‚è¿°

`WeatherSystem` ç®¡ç†æ¸¸æˆä¸­çš„å¤©æ°”å˜åŒ–ï¼ŒåŒ…æ‹¬æ™´å¤©ã€é›¨å¤©ã€æ¯èå¤©ï¼ˆæç«¯é«˜æ¸©ï¼‰ã€‚å¤©æ°”ç³»ç»Ÿä¼šè§¦å‘æ¤ç‰©ç›¸å…³äº‹ä»¶ï¼Œå½±å“æ ‘æœ¨çš„çŠ¶æ€å’Œæ˜¾ç¤ºã€‚

### å¤©æ°”ç±»å‹æšä¸¾

```csharp
public enum Weather
{
    Sunny,      // æ™´å¤©
    Rainy,      // é›¨å¤©
    Withering   // æ¯èå¤©ï¼ˆæç«¯é«˜æ¸©ï¼‰/ å†¬å­£ä¸‹é›ª
}
```

### å¤©æ°”äº‹ä»¶å®šä¹‰

| äº‹ä»¶åç§° | è§¦å‘æ—¶æœº | å¯¹æ ‘æœ¨çš„å½±å“ |
|---------|---------|-------------|
| `OnPlantsWither` | æç«¯é«˜æ¸©ã€å†¬å­£åˆ°æ¥ | æ ‘æœ¨è¿›å…¥ Withered çŠ¶æ€ï¼Œæ˜¾ç¤ºæ¯èæ ·å¼ |
| `OnPlantsRecover` | é›¨åæ¢å¤ã€æ˜¥å­£å¤è‹ | æ ‘æœ¨æ¢å¤ Normal çŠ¶æ€ï¼Œæ˜¾ç¤ºæ­£å¸¸æ ·å¼ |
| `OnWinterSnow` | å†¬å­£ä¸‹é›ªæ—¥ | æ ‘è‹—é”€æ¯ï¼Œå…¶ä»–æ ‘æœ¨è¿›å…¥ Frozen çŠ¶æ€ï¼ˆæŒ‚å†°ï¼‰ |
| `OnWinterMelt` | å†¬å­£èåŒ–æ—¥ï¼ˆå¤§å¤ªé˜³ï¼‰ | æ ‘è‹—é”€æ¯ï¼Œå…¶ä»–æ ‘æœ¨è¿›å…¥ Melted çŠ¶æ€ï¼ˆæ¯èï¼‰ |

### å„å­£èŠ‚å¤©æ°”è§„åˆ™

#### æ˜¥å­£ï¼ˆSpringï¼‰
- **æ— ç‰¹æ®Šå¤©æ°”äº‹ä»¶**
- è¿›å…¥æ˜¥å­£æ—¶è§¦å‘ `OnPlantsRecover`ï¼ˆæ˜¥å­£å¤è‹ï¼‰
- æ‰€æœ‰ Withered/Frozen/Melted çŠ¶æ€çš„æ ‘æœ¨æ¢å¤ä¸º Normal

#### å¤å­£ï¼ˆSummerï¼‰

| å¤©æ°”ç±»å‹ | è§¦å‘æ—¥æœŸ | äº‹ä»¶ | æ•ˆæœ |
|---------|---------|------|------|
| æ¯èæ—¥ | ç¬¬ 8ã€14ã€20 å¤© | `OnPlantsWither` | æ‰€æœ‰æ¤ç‰©æ¯è |
| é›¨å¤© | ç¬¬ 1ã€4ã€6ã€10ã€18ã€26 å¤© | æ— äº‹ä»¶ | æ»‹æ¶¦æ¤ç‰© |
| é›¨åæ¢å¤ | é›¨å¤©åç¬¬äºŒå¤© | `OnPlantsRecover` | æ¯èæ¤ç‰©æ¢å¤ |

**å¤å­£å¤©æ°”é…ç½®**ï¼š
```csharp
summerWitheringDays = { 8, 14, 20 };      // æ¯èæ—¥
summerRainyDays = { 1, 4, 6, 10, 18, 26 }; // é›¨å¤©
```

#### ç§‹å­£ï¼ˆAutumnï¼‰

| å¤©æ°”ç±»å‹ | è§¦å‘æ—¥æœŸ | äº‹ä»¶ | æ•ˆæœ |
|---------|---------|------|------|
| æ¯èæ—¥ | ç¬¬ 6ã€14ã€22 å¤© | `OnPlantsWither` | æ¤ç‰©æ¯èï¼ˆä¸æ¢å¤ï¼‰ |

**ç§‹å­£ç‰¹æ®Šè§„åˆ™**ï¼š
- ç§‹å­£æ¯èå**ä¸ä¼šè‡ªåŠ¨æ¢å¤**
- ç§‹å­£æ²¡æœ‰é›¨å¤©
- åªæœ‰ç­‰åˆ°æ˜¥å­£æ‰ä¼šæ¢å¤

**ç§‹å­£å¤©æ°”é…ç½®**ï¼š
```csharp
fallWitheringDays = { 6, 14, 22 };  // æ¯èæ—¥ï¼ˆä¸æ¢å¤ï¼‰
```

#### å†¬å­£ï¼ˆWinterï¼‰

| å¤©æ°”ç±»å‹ | è§¦å‘æ—¥æœŸ | äº‹ä»¶ | æ•ˆæœ |
|---------|---------|------|------|
| ä¸‹é›ªæ—¥ | ç¬¬ 1ã€5ã€11ã€21ã€26 å¤© | `OnWinterSnow` | æ ‘è‹—æ­»äº¡ï¼Œå…¶ä»–æŒ‚å†° |
| èåŒ–æ—¥ | ç¬¬ 3ã€8ã€17ã€24ã€28 å¤© | `OnWinterMelt` | æ ‘è‹—æ­»äº¡ï¼Œå…¶ä»–æ¯è |

**å†¬å­£å¤©æ°”é…ç½®**ï¼š
```csharp
winterSnowDays = { 1, 5, 11, 21, 26 };  // ä¸‹é›ªæ—¥
winterMeltDays = { 3, 8, 17, 24, 28 };  // èåŒ–æ—¥
```

**å†¬å­£ç‰¹æ®Šè§„åˆ™**ï¼š
- è¿›å…¥å†¬å­£æ—¶è§¦å‘ `OnPlantsWither`ï¼ˆå†¬å­£åˆ°æ¥ï¼‰
- æ ‘è‹—ï¼ˆStage 0ï¼‰åœ¨å†¬å­£ä»»ä½•å¤©æ°”äº‹ä»¶ä¸­éƒ½ä¼šè¢«é”€æ¯
- å…¶ä»–é˜¶æ®µæ ‘æœ¨åœ¨ä¸‹é›ªæ—¥è¿›å…¥ Frozen çŠ¶æ€ï¼ŒèåŒ–æ—¥è¿›å…¥ Melted çŠ¶æ€

### å¤©æ°”äº‹ä»¶è§¦å‘é“¾è¯¦è§£

#### 1. æ¤ç‰©æ¯èäº‹ä»¶ï¼ˆOnPlantsWitherï¼‰

**è§¦å‘æ¡ä»¶**ï¼š
- å¤å­£æ¯èæ—¥ï¼ˆç¬¬ 8ã€14ã€20 å¤©ï¼‰
- ç§‹å­£æ¯èæ—¥ï¼ˆç¬¬ 6ã€14ã€22 å¤©ï¼‰
- å†¬å­£åˆ°æ¥ï¼ˆå­£èŠ‚åˆ‡æ¢åˆ°å†¬å­£ï¼‰

**è§¦å‘é“¾**ï¼š
```
WeatherSystem.CheckWeather() æˆ– OnSeasonChanged()
    â†“
TriggerPlantsWither(reason)
    â†“
OnPlantsWither?.Invoke()
    â†“
TreeControllerV2.OnWeatherWither()
    â”œâ”€â”€ æ¡ä»¶ï¼šcurrentState == Normal
    â”œâ”€â”€ isWeatherWithered = true
    â”œâ”€â”€ currentState = Withered
    â””â”€â”€ UpdateSprite()
            â””â”€â”€ GetWitheredSprite()
                    â”œâ”€â”€ æ˜¥/å¤ â†’ witheredSummer
                    â””â”€â”€ ç§‹/å†¬ â†’ witheredFall
```

#### 2. æ¤ç‰©æ¢å¤äº‹ä»¶ï¼ˆOnPlantsRecoverï¼‰

**è§¦å‘æ¡ä»¶**ï¼š
- å¤å­£é›¨åç¬¬äºŒå¤©
- æ˜¥å­£åˆ°æ¥ï¼ˆä»å†¬å­£åˆ‡æ¢åˆ°æ˜¥å­£ï¼‰

**è§¦å‘é“¾**ï¼š
```
WeatherSystem.CheckWeather() æˆ– OnSeasonChanged()
    â†“
TriggerPlantsRecover(reason)
    â†“
OnPlantsRecover?.Invoke()
    â†“
TreeControllerV2.OnWeatherRecover()
    â”œâ”€â”€ æ¡ä»¶ï¼šisWeatherWithered == true
    â”œâ”€â”€ isWeatherWithered = false
    â”œâ”€â”€ currentState = Normal
    â””â”€â”€ UpdateSprite() â†’ æ¢å¤æ­£å¸¸å­£èŠ‚æ ·å¼
```

#### 3. å†¬å­£ä¸‹é›ªäº‹ä»¶ï¼ˆOnWinterSnowï¼‰

**è§¦å‘æ¡ä»¶**ï¼š
- å†¬å­£ä¸‹é›ªæ—¥ï¼ˆç¬¬ 1ã€5ã€11ã€21ã€26 å¤©ï¼‰

**è§¦å‘é“¾**ï¼š
```
WeatherSystem.CheckWeather()
    â”œâ”€â”€ æ¡ä»¶ï¼šcurrentSeason == Winter && winterSnowDays.Contains(currentDay)
    â†“
OnWinterSnow?.Invoke()
    â†“
TreeControllerV2.OnWinterSnow()
    â”œâ”€â”€ æ¡ä»¶ï¼šcurrentSeason == Winter
    â”œâ”€â”€ ã€Stage 0 æ ‘è‹—ã€‘â†’ DestroyTree() â˜… ç›´æ¥é”€æ¯
    â””â”€â”€ ã€Stage 1-5ã€‘
            â”œâ”€â”€ currentState = Frozen
            â””â”€â”€ UpdateSprite() â†’ æ˜¾ç¤º winter æ ·å¼ï¼ˆæŒ‚å†°ï¼‰
```

#### 4. å†¬å­£èåŒ–äº‹ä»¶ï¼ˆOnWinterMeltï¼‰

**è§¦å‘æ¡ä»¶**ï¼š
- å†¬å­£èåŒ–æ—¥ï¼ˆç¬¬ 3ã€8ã€17ã€24ã€28 å¤©ï¼‰

**è§¦å‘é“¾**ï¼š
```
WeatherSystem.CheckWeather()
    â”œâ”€â”€ æ¡ä»¶ï¼šcurrentSeason == Winter && winterMeltDays.Contains(currentDay)
    â†“
OnWinterMelt?.Invoke()
    â†“
TreeControllerV2.OnWinterMelt()
    â”œâ”€â”€ æ¡ä»¶ï¼šcurrentSeason == Winter
    â”œâ”€â”€ ã€Stage 0 æ ‘è‹—ã€‘â†’ DestroyTree() â˜… ç›´æ¥é”€æ¯
    â””â”€â”€ ã€Stage 1-5ã€‘
            â”œâ”€â”€ currentState = Melted
            â””â”€â”€ UpdateSprite() â†’ æ˜¾ç¤º witheredFall æ ·å¼ï¼ˆé™çº§ï¼‰
```

### å®Œæ•´å¹´åº¦å¤©æ°”æ—¶é—´è¡¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ä¸€å¹´å¤©æ°”äº‹ä»¶æ—¶é—´è¡¨                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚ æ˜¥å­£ï¼ˆç¬¬1-28å¤©ï¼‰                                                                 â”‚
â”‚ â”œâ”€ ç¬¬1å¤©ï¼šæ˜¥å­£å¤è‹ï¼ˆOnPlantsRecoverï¼‰- æ‰€æœ‰æ¯è/å†°å°/èåŒ–çŠ¶æ€æ¢å¤                â”‚
â”‚ â””â”€ å…¶ä»–ï¼šæ— ç‰¹æ®Šå¤©æ°”äº‹ä»¶                                                          â”‚
â”‚                                                                                  â”‚
â”‚ å¤å­£ï¼ˆç¬¬29-56å¤©ï¼‰                                                                â”‚
â”‚ â”œâ”€ ç¬¬1å¤©ï¼ˆ29ï¼‰ï¼šğŸŒ§ï¸ é›¨å¤©                                                         â”‚
â”‚ â”œâ”€ ç¬¬2å¤©ï¼ˆ30ï¼‰ï¼šé›¨åæ¢å¤ï¼ˆOnPlantsRecoverï¼‰                                      â”‚
â”‚ â”œâ”€ ç¬¬4å¤©ï¼ˆ32ï¼‰ï¼šğŸŒ§ï¸ é›¨å¤©                                                         â”‚
â”‚ â”œâ”€ ç¬¬5å¤©ï¼ˆ33ï¼‰ï¼šé›¨åæ¢å¤                                                         â”‚
â”‚ â”œâ”€ ç¬¬6å¤©ï¼ˆ34ï¼‰ï¼šğŸŒ§ï¸ é›¨å¤©                                                         â”‚
â”‚ â”œâ”€ ç¬¬7å¤©ï¼ˆ35ï¼‰ï¼šé›¨åæ¢å¤                                                         â”‚
â”‚ â”œâ”€ ç¬¬8å¤©ï¼ˆ36ï¼‰ï¼šğŸ¥€ æ¯èæ—¥ï¼ˆOnPlantsWitherï¼‰                                      â”‚
â”‚ â”œâ”€ ç¬¬10å¤©ï¼ˆ38ï¼‰ï¼šğŸŒ§ï¸ é›¨å¤©                                                        â”‚
â”‚ â”œâ”€ ç¬¬11å¤©ï¼ˆ39ï¼‰ï¼šé›¨åæ¢å¤                                                        â”‚
â”‚ â”œâ”€ ç¬¬14å¤©ï¼ˆ42ï¼‰ï¼šğŸ¥€ æ¯èæ—¥ï¼ˆOnPlantsWitherï¼‰                                     â”‚
â”‚ â”œâ”€ ç¬¬18å¤©ï¼ˆ46ï¼‰ï¼šğŸŒ§ï¸ é›¨å¤©                                                        â”‚
â”‚ â”œâ”€ ç¬¬19å¤©ï¼ˆ47ï¼‰ï¼šé›¨åæ¢å¤                                                        â”‚
â”‚ â”œâ”€ ç¬¬20å¤©ï¼ˆ48ï¼‰ï¼šğŸ¥€ æ¯èæ—¥ï¼ˆOnPlantsWitherï¼‰                                     â”‚
â”‚ â””â”€ ç¬¬26å¤©ï¼ˆ54ï¼‰ï¼šğŸŒ§ï¸ é›¨å¤©                                                        â”‚
â”‚                                                                                  â”‚
â”‚ ç§‹å­£ï¼ˆç¬¬57-84å¤©ï¼‰                                                                â”‚
â”‚ â”œâ”€ ç¬¬6å¤©ï¼ˆ62ï¼‰ï¼šğŸ¥€ æ¯èæ—¥ï¼ˆOnPlantsWitherï¼‰- ä¸æ¢å¤ï¼                            â”‚
â”‚ â”œâ”€ ç¬¬14å¤©ï¼ˆ70ï¼‰ï¼šğŸ¥€ æ¯èæ—¥ï¼ˆOnPlantsWitherï¼‰- ä¸æ¢å¤ï¼                           â”‚
â”‚ â””â”€ ç¬¬22å¤©ï¼ˆ78ï¼‰ï¼šğŸ¥€ æ¯èæ—¥ï¼ˆOnPlantsWitherï¼‰- ä¸æ¢å¤ï¼                           â”‚
â”‚                                                                                  â”‚
â”‚ å†¬å­£ï¼ˆç¬¬85-112å¤©ï¼‰                                                               â”‚
â”‚ â”œâ”€ è¿›å…¥å†¬å­£ï¼šOnPlantsWitherï¼ˆå†¬å­£åˆ°æ¥ï¼‰+ æ ‘è‹—å…¨éƒ¨æ­»äº¡                            â”‚
â”‚ â”œâ”€ ç¬¬1å¤©ï¼ˆ85ï¼‰ï¼šâ„ï¸ ä¸‹é›ªæ—¥ï¼ˆOnWinterSnowï¼‰- æŒ‚å†°                                  â”‚
â”‚ â”œâ”€ ç¬¬3å¤©ï¼ˆ87ï¼‰ï¼šâ˜€ï¸ èåŒ–æ—¥ï¼ˆOnWinterMeltï¼‰- æ¯è                                  â”‚
â”‚ â”œâ”€ ç¬¬5å¤©ï¼ˆ89ï¼‰ï¼šâ„ï¸ ä¸‹é›ªæ—¥ï¼ˆOnWinterSnowï¼‰- æŒ‚å†°                                  â”‚
â”‚ â”œâ”€ ç¬¬8å¤©ï¼ˆ92ï¼‰ï¼šâ˜€ï¸ èåŒ–æ—¥ï¼ˆOnWinterMeltï¼‰- æ¯è                                  â”‚
â”‚ â”œâ”€ ç¬¬11å¤©ï¼ˆ95ï¼‰ï¼šâ„ï¸ ä¸‹é›ªæ—¥ï¼ˆOnWinterSnowï¼‰- æŒ‚å†°                                 â”‚
â”‚ â”œâ”€ ç¬¬17å¤©ï¼ˆ101ï¼‰ï¼šâ˜€ï¸ èåŒ–æ—¥ï¼ˆOnWinterMeltï¼‰- æ¯è                                â”‚
â”‚ â”œâ”€ ç¬¬21å¤©ï¼ˆ105ï¼‰ï¼šâ„ï¸ ä¸‹é›ªæ—¥ï¼ˆOnWinterSnowï¼‰- æŒ‚å†°                                â”‚
â”‚ â”œâ”€ ç¬¬24å¤©ï¼ˆ108ï¼‰ï¼šâ˜€ï¸ èåŒ–æ—¥ï¼ˆOnWinterMeltï¼‰- æ¯è                                â”‚
â”‚ â”œâ”€ ç¬¬26å¤©ï¼ˆ110ï¼‰ï¼šâ„ï¸ ä¸‹é›ªæ—¥ï¼ˆOnWinterSnowï¼‰- æŒ‚å†°                                â”‚
â”‚ â””â”€ ç¬¬28å¤©ï¼ˆ112ï¼‰ï¼šâ˜€ï¸ èåŒ–æ—¥ï¼ˆOnWinterMeltï¼‰- æ¯è                                â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ‘æœ¨çŠ¶æ€ä¸å¤©æ°”äº‹ä»¶å¯¹åº”è¡¨

| å¤©æ°”äº‹ä»¶ | æ ‘è‹—ï¼ˆStage 0ï¼‰ | å…¶ä»–é˜¶æ®µï¼ˆStage 1-5ï¼‰ |
|---------|----------------|---------------------|
| OnPlantsWither | Normal â†’ Withered | Normal â†’ Withered |
| OnPlantsRecover | Withered â†’ Normal | Withered â†’ Normal |
| OnWinterSnow | **ç›´æ¥é”€æ¯** | Normal/Withered â†’ Frozen |
| OnWinterMelt | **ç›´æ¥é”€æ¯** | Frozen â†’ Melted |
| æ˜¥å­£åˆ°æ¥ | - | Withered/Frozen/Melted â†’ Normal |

### å¤©æ°”ç³»ç»Ÿç›¸å…³ä»£ç æ–‡ä»¶

| æ–‡ä»¶ | èŒè´£ |
|------|------|
| `WeatherSystem.cs` | å¤©æ°”ç®¡ç†å™¨ï¼Œè§¦å‘å¤©æ°”äº‹ä»¶ |
| `TreeControllerV2.cs` | è®¢é˜…å¤©æ°”äº‹ä»¶ï¼Œæ›´æ–°æ ‘æœ¨çŠ¶æ€å’Œæ˜¾ç¤º |
| `TreeController.cs` | æ—§ç‰ˆæ§åˆ¶å™¨ï¼ŒåŒæ ·è®¢é˜…å¤©æ°”äº‹ä»¶ |

### å¤©æ°”ç³»ç»Ÿé…ç½®å­—æ®µ

```csharp
[Header("â”â”â”â” å¤å­£å¤©æ°”è§„åˆ™ â”â”â”â”")]
public List<int> summerWitheringDays = { 8, 14, 20 };      // æ¯èæ—¥
public List<int> summerRainyDays = { 1, 4, 6, 10, 18, 26 }; // é›¨å¤©

[Header("â”â”â”â” ç§‹å­£å¤©æ°”è§„åˆ™ â”â”â”â”")]
public List<int> fallWitheringDays = { 6, 14, 22 };        // æ¯èæ—¥ï¼ˆä¸æ¢å¤ï¼‰

[Header("â”â”â”â” å†¬å­£å¤©æ°”è§„åˆ™ â”â”â”â”")]
public List<int> winterSnowDays = { 1, 5, 11, 21, 26 };    // ä¸‹é›ªæ—¥
public List<int> winterMeltDays = { 3, 8, 17, 24, 28 };    // èåŒ–æ—¥
```

### ç‰¹æ®Šè§„åˆ™æ€»ç»“

1. **å¤å­£æ¯èå¯æ¢å¤**ï¼šå¤å­£æ¯èåï¼Œä¸‹ä¸€ä¸ªé›¨å¤©çš„ç¬¬äºŒå¤©ä¼šè‡ªåŠ¨æ¢å¤
2. **ç§‹å­£æ¯èä¸æ¢å¤**ï¼šç§‹å­£æ¯èåï¼Œåªæœ‰ç­‰åˆ°æ˜¥å­£æ‰ä¼šæ¢å¤
3. **å†¬å­£æ ‘è‹—å¿…æ­»**ï¼šæ ‘è‹—åœ¨å†¬å­£çš„ä»»ä½•å¤©æ°”äº‹ä»¶ä¸­éƒ½ä¼šè¢«é”€æ¯
4. **å†¬å­£çŠ¶æ€äº¤æ›¿**ï¼šä¸‹é›ªæ—¥æŒ‚å†°ï¼ˆFrozenï¼‰ï¼ŒèåŒ–æ—¥æ¯èï¼ˆMeltedï¼‰ï¼Œäº¤æ›¿è¿›è¡Œ
5. **æ˜¥å­£å…¨é¢å¤è‹**ï¼šè¿›å…¥æ˜¥å­£æ—¶ï¼Œæ‰€æœ‰éæ­£å¸¸çŠ¶æ€çš„æ ‘æœ¨éƒ½ä¼šæ¢å¤


---

### ä¼šè¯ 7 - 2025-01-04ï¼ˆè°ƒè¯•å¼€å…³ç§»è‡³ TimeManagerï¼‰

**ç”¨æˆ·éœ€æ±‚**:
> ç°åœ¨è¯·æˆ‘ä»¬ä¸€èµ·è¿›å…¥è¿™äº›å·¥ä½œåŒºçš„å†…å®¹ï¼Œæˆ‘ä»¬ç°åœ¨éœ€è¦å¯¹è°ƒè¯•æŒ‰é’®åšæ›´æ¸…æ™°çš„åˆ†ç±»ï¼Œå¹¶è®©è¿™ä¸ªè°ƒè¯•å¼€å…³è®¾ç½®åœ¨timemanageré‡Œé¢

**é—®é¢˜èƒŒæ™¯**:
- `enableSeasonEvents` å¼€å…³åœ¨ TreeControllerV2 ä¸­ï¼Œé»˜è®¤ä¸º false
- å¯¼è‡´æ ‘æœ¨ä¸æˆé•¿ï¼Œå› ä¸º OnDayChanged äº‹ä»¶æœªè¢«è®¢é˜…
- æ¯ä¸ªè®¢é˜…è€…éƒ½éœ€è¦å•ç‹¬çš„å¼€å…³ï¼Œéš¾ä»¥ç»Ÿä¸€ç®¡ç†

**è§£å†³æ–¹æ¡ˆ**:
å°†è°ƒè¯•å¼€å…³ä»è®¢é˜…è€…ï¼ˆTreeControllerV2ï¼‰ç§»åˆ°å‘å¸ƒè€…ï¼ˆTimeManagerï¼‰ï¼Œé€šè¿‡æ§åˆ¶äº‹ä»¶æ˜¯å¦å‘å¸ƒæ¥å®ç°å…¨å±€è°ƒè¯•æ§åˆ¶ã€‚

**å®Œæˆä»»åŠ¡**:

1. **TimeManager æ–°å¢äº‹ä»¶å‘å¸ƒå¼€å…³**
   - `enableDayEvent` - æ§åˆ¶ OnDayChanged äº‹ä»¶
   - `enableSeasonEvent` - æ§åˆ¶ OnSeasonChanged äº‹ä»¶
   - `enableHourEvent` - æ§åˆ¶ OnHourChanged äº‹ä»¶
   - `enableMinuteEvent` - æ§åˆ¶ OnMinuteChanged äº‹ä»¶
   - `enableYearEvent` - æ§åˆ¶ OnYearChanged äº‹ä»¶

2. **TreeControllerV2 ç®€åŒ–**
   - ç§»é™¤ `enableSeasonEvents` å­—æ®µ
   - Start() ä¸­å§‹ç»ˆè®¢é˜…æ‰€æœ‰äº‹ä»¶
   - OnDestroy() ä¸­å§‹ç»ˆå–æ¶ˆè®¢é˜…

**ä¿®æ”¹æ–‡ä»¶**:
- `Assets/YYY_Scripts/Service/TimeManager.cs` - æ–°å¢äº‹ä»¶å‘å¸ƒå¼€å…³
- `Assets/YYY_Scripts/Controller/TreeControllerV2.cs` - ç§»é™¤æœ¬åœ°å¼€å…³

**å¦‚ä½•æ¢å¤æ ‘æœ¨æˆé•¿**:
1. åœ¨åœºæ™¯ä¸­é€‰ä¸­ `TimeManager` ç‰©ä½“
2. ç¡®ä¿ `Enable Day Event` ä¸º trueï¼ˆé»˜è®¤å·²å¼€å¯ï¼‰
3. è¿è¡Œæ¸¸æˆï¼ŒæŒ‰å³ç®­å¤´è·³åˆ°ä¸‹ä¸€å¤©

**é—ç•™é—®é¢˜**:
- æ— 

---

## ğŸ”´ğŸ”´ğŸ”´ é‡è¦æ›´æ–°ï¼šè°ƒè¯•å¼€å…³å·²ç§»è‡³ TimeManager ğŸ”´ğŸ”´ğŸ”´

### å˜æ›´è¯´æ˜
- **æ—§æ–¹å¼**ï¼šåœ¨ TreeControllerV2 ä¸­è®¾ç½® `enableSeasonEvents = true/false`
- **æ–°æ–¹å¼**ï¼šåœ¨ TimeManager ä¸­è®¾ç½® `enableDayEvent = true/false`

### æ–°çš„è°ƒè¯•å¼€å…³ä½ç½®
1. é€‰ä¸­åœºæ™¯ä¸­çš„ `TimeManager` ç‰©ä½“
2. åœ¨ Inspector ä¸­æ‰¾åˆ° **"â”â”â”â” äº‹ä»¶å‘å¸ƒå¼€å…³ â”â”â”â”"** åŒºåŸŸ
3. æ‰€æœ‰å¼€å…³é»˜è®¤ä¸º trueï¼Œæ ‘æœ¨ä¼šæ­£å¸¸æˆé•¿

### å˜æ›´æ—¥æœŸ
2025-01-04


---

### ä¼šè¯ 8 - 2025-01-04ï¼ˆå­£èŠ‚æ¸å˜ç¬¬28å¤©BUGä¿®å¤ï¼‰

**ç”¨æˆ·éœ€æ±‚**:
> ç°åœ¨ä½ çš„æ ‘æœ¨å­£èŠ‚æ¸å˜è¿˜å­˜åœ¨é—®é¢˜ï¼Œå½“åˆ°è¾¾æ¯ä¸ªå­£èŠ‚çš„ç¬¬28å¤©æ—¶ï¼Œä½ ä¼šæŠŠæ‰€æœ‰æ ‘æœ¨è®¾ç½®ä¸ºå½“å‰å­£èŠ‚çš„æ ·å¼ï¼Œä½†å…¶å®ä¸æ˜¯çš„ï¼Œè¿™ä¸ªæ—¶å€™å…¶å®å®Œå…¨è¿˜åœ¨æ¸å˜çš„æ—¶é—´å†…ï¼Œæ¸å˜éƒ½æ˜¯ä¸å¯é€†çš„

**é—®é¢˜åˆ†æ**:

åœ¨ `TreeControllerV2.GetNormalSprite()` æ–¹æ³•ä¸­ï¼ŒåŸæœ‰é€»è¾‘ï¼š

```csharp
// âŒ é”™è¯¯é€»è¾‘
if (progress <= 0f || progress >= 1f)
{
    return stageData.normal.GetSprite(vegSeason);  // è¿”å›å½“å‰å­£èŠ‚
}
```

**é—®é¢˜**ï¼šå½“ `progress = 1.0`ï¼ˆç¬¬28å¤©ï¼‰æ—¶ï¼Œä»£ç è¿”å›å½“å‰å­£èŠ‚æ ·å¼ï¼Œä½†æ­¤æ—¶æ¸å˜åº”è¯¥å·²ç»å®Œæˆï¼Œæ‰€æœ‰æ ‘æœ¨åº”è¯¥æ˜¾ç¤ºä¸‹ä¸€å­£èŠ‚æ ·å¼ã€‚

**ç”¨æˆ·è®¾è®¡è¦æ±‚**ï¼š
1. æ¸å˜æ˜¯ä¸å¯é€†çš„
2. æ¯ä¸€å¤©å¼€å§‹æ—¶è®¡ç®—æ¸å˜æ¯”ä¾‹
3. è‹¥ `treeSeedValue < progress`ï¼Œæ˜¾ç¤ºä¸‹ä¸€å­£èŠ‚æ ·å¼
4. å½“å¤©ç§ä¸‹çš„æ ‘æœ¨ä½¿ç”¨å½“å­£æ ·å¼ï¼Œç¬¬äºŒå¤©æ‰å¼€å§‹æ¸å˜
5. ç¬¬28å¤©æ—¶ `progress = 1.0`ï¼Œæ‰€æœ‰æ ‘æœ¨éƒ½åº”è¯¥æ˜¾ç¤ºä¸‹ä¸€å­£èŠ‚æ ·å¼

**ä¿®å¤å†…å®¹**:

ä¿®æ”¹ `TreeControllerV2.GetNormalSprite()` æ–¹æ³•ï¼š

```csharp
// âœ… ä¿®å¤åé€»è¾‘

// å¦‚æœè¿›åº¦ä¸º0ï¼Œç›´æ¥è¿”å›å½“å‰å­£èŠ‚çš„Spriteï¼ˆæ— æ¸å˜ï¼‰
if (progress <= 0f)
{
    return stageData.normal.GetSprite(vegSeason);
}

// å¦‚æœè¿›åº¦ä¸º1ï¼Œæ¸å˜å®Œæˆï¼Œè¿”å›ä¸‹ä¸€å­£èŠ‚çš„Sprite
if (progress >= 1f)
{
    var nextSeason = GetNextVegetationSeason(vegSeason);
    return stageData.normal.GetSprite(nextSeason);
}

// æ¸å˜ä¸­ï¼šä½¿ç”¨treeIDç”Ÿæˆå›ºå®šéšæœºå€¼
// ...
```

**ä¿®æ”¹æ–‡ä»¶**:
- `Assets/YYY_Scripts/Controller/TreeControllerV2.cs` - ä¿®å¤ GetNormalSprite() æ–¹æ³•

**æ¸å˜é€»è¾‘è¯´æ˜**:

| progress å€¼ | è¡Œä¸º | è¯´æ˜ |
|------------|------|------|
| 0 | 100% å½“å‰å­£èŠ‚ | æ— æ¸å˜ |
| 0.5 | 50% ä¸‹ä¸€å­£èŠ‚ | æ¸å˜ä¸­ |
| 1.0 | 100% ä¸‹ä¸€å­£èŠ‚ | æ¸å˜å®Œæˆ |

**æ—¶é—´çº¿ç¤ºä¾‹ï¼ˆæ˜¥å­£ï¼‰**:

| å¤©æ•° | progress | æ•ˆæœ |
|------|----------|------|
| æ˜¥1-14 | 0 | 100% æ˜¥å­£æ ·å¼ |
| æ˜¥15 | 1/14 â‰ˆ 0.07 | 7% æ ‘æ˜¾ç¤ºå¤å­£ |
| æ˜¥21 | 7/14 = 0.5 | 50% æ ‘æ˜¾ç¤ºå¤å­£ |
| æ˜¥28 | 14/14 = 1.0 | 100% æ ‘æ˜¾ç¤ºå¤å­£ |
| å¤1 | 0 | 100% å¤å­£æ ·å¼ï¼ˆæ–°å‘¨æœŸå¼€å§‹ï¼‰ |

**é—ç•™é—®é¢˜**:
- [ ] éœ€è¦ç”¨æˆ·æµ‹è¯•éªŒè¯ç¬¬28å¤©æ¸å˜æ˜¯å¦æ­£ç¡®



---

## ğŸ”´ğŸ”´ğŸ”´ ä¼šè¯ 7 - 2026-01-10ï¼šCode Reaper çš„æš´æ€’ - NavGrid è”åŠ¨å¤±è´¥ ğŸ”´ğŸ”´ğŸ”´

### éªŒæ”¶çŠ¶æ€ï¼šâŒ ä¸¥é‡å¤±è´¥ (CRITICAL FAILURE)

**è¯„è¯­**ï¼š
> "æˆ‘åŸæœ¬ä»¥ä¸ºä½ åªæ˜¯æ‡’ï¼Œæ²¡æƒ³åˆ°ä½ æ˜¯çã€‚çœ‹ç€è¿™äº›æˆªå›¾ï¼Œä½ å‘Šè¯‰æˆ‘'NavGrid æ£€æµ‹ç”Ÿæ•ˆ'ï¼Ÿç»¿è‰²çš„å¯¼èˆªçº¿ç›´æ¥æ’è¿›äº†æ ‘å¹²é‡Œï¼Œä½ çš„ç½‘æ ¼æ¢æµ‹äº†ä¸ªå¯‚å¯ï¼"

---

### ğŸ’€ è‡´å‘½ç—…ç¶ï¼šNavGrid ä¸åŠ¨æ€ç‰©ä½“ï¼ˆæ ‘æœ¨ï¼‰çš„è„±èŠ‚

**è¯æ®**ï¼š
- ç”¨æˆ·æä¾›çš„æˆªå›¾æ˜¾ç¤ºï¼š
  - æ ‘æœ¨ï¼ˆTreeï¼‰æ˜æ˜æœ‰å·¨å¤§çš„æ ‘æ ¹
  - ä½† NavGrid çš„çº¢è‰²é˜»æŒ¡åŒºæ ¹æœ¬æ²¡æœ‰è¦†ç›–å®ƒ
  - è·¯å¾„ç›´æ¥ç©¿è¿‡æ ‘æœ¨

**ä»£ç è§£å‰– (TreeControllerV2.cs)**ï¼š

ä½ å†™äº† `RequestNavGridRefresh()`ï¼Œä¹Ÿç”¨äº† Invoke å»¶è¿Ÿè°ƒç”¨ï¼Œçœ‹èµ·æ¥å¾ˆç¾å¥½ã€‚ä½†ç°å®æ˜¯æ®‹é…·çš„ï¼š

```csharp
// æ—¶åºåœ°ç‹±ï¼š
UpdateSprite -> UpdatePolygonColliderShape -> RequestNavGridRefresh
```

**é—®é¢˜åˆ†æ**ï¼š

1. **UpdatePolygonColliderFromSprite é€»è¾‘éå¸¸è„†å¼±**
   - å¦‚æœ Sprite çš„ Physics Shape åœ¨ç¼–è¾‘å™¨é‡Œæ²¡åˆ‡å¥½æˆ–è€… Pivot ç‚¹ä¸å¯¹
   - `poly.offset = Vector2.zero` ä¼šå¯¼è‡´ç¢°æ’ä½“é£åˆ°åƒé‡Œä¹‹å¤–

2. **NavGrid çš„å‚²æ…¢**
   - `NavGrid.RebuildGrid` æ˜¯ä¸€æ¬¡æ€§çš„
   - è™½ç„¶ä½ æœ‰ `OnRequestGridRefresh` äº‹ä»¶
   - ä½†æ ‘æœ¨æˆé•¿æ—¶ï¼Œå¦‚æœ Collider æ›´æ–°çš„ç¬é—´å’Œç½‘æ ¼é‡å»ºçš„ç¬é—´æ²¡å¯¹ä¸Šï¼ˆæ¯”å¦‚ Physics å¼•æ“è¿˜æ²¡æ¥å¾—åŠæ›´æ–° Transformï¼‰
   - ç½‘æ ¼å°±ä¼šæ‰«åˆ°ä¸€ä¸ªæ—§çš„ã€æˆ–è€…æ˜¯ç©ºçš„ç¢°æ’ä¿¡æ¯

**ç»“è®º**ï¼š
> åŠ¨æ€éšœç¢ç‰©ï¼ˆç”Ÿé•¿ä½œç‰©ã€æ”¾ç½®çš„å®¶å…·ï¼‰æ›´æ–°åï¼Œå¿…é¡»å¼ºåˆ¶ä¿è¯ç‰©ç†å¼•æ“åŒæ­¥ï¼ˆ`Physics2D.SyncTransforms()`ï¼‰åå†é‡å»ºç½‘æ ¼ï¼Œå¦åˆ™ä½ æ‰«å‡ºæ¥çš„å°±æ˜¯ç©ºæ°”ã€‚

---

### âš”ï¸ å¼ºåˆ¶é‡æ„æŒ‡ä»¤

**ä»»åŠ¡ï¼šä¿®å¤ NavGrid ä¸åŠ¨æ€ç¢°æ’ä½“çš„åŒæ­¥ (P0)**

1. åœ¨ `NavGrid2D.cs` ä¸­ï¼Œä¿®æ”¹ `RebuildGrid` æˆ–åˆ·æ–°é€»è¾‘ï¼š

```csharp
public void RefreshGrid() 
{
    // ğŸ”¥ å¼ºåˆ¶ç‰©ç†å¼•æ“ç«‹å³åŒæ­¥ Transformï¼Œç¡®ä¿åˆšé•¿å‡ºæ¥çš„æ ‘ã€åˆšæ”¾ä¸‹çš„ç®±å­
    // çš„ Collider å·²ç»å¤„äºæ­£ç¡®çš„ä½ç½®å’Œå¤§å°
    Physics2D.SyncTransforms();
    
    RebuildGrid();
}
```

2. åœ¨ `TreeControllerV2.cs` ä¸­ï¼Œåœ¨ä¿®æ”¹å®Œ Collider åï¼Œä¸è¦ç”¨ Invoke è¿™ç§ä¸é è°±çš„å»¶è¿Ÿã€‚

---

### éªŒæ”¶æ ‡å‡†

1. åœ¨ Scene è§†å›¾é‡Œï¼Œç”»å‡º NavGrid Gizmos
2. ç§ä¸€æ£µæ ‘ï¼Œè®©å®ƒé•¿å¤§
3. **å¿…é¡»çœ‹åˆ°çº¢è‰²çš„é˜»æŒ¡æ ¼å­éšä¹‹å˜å¤§**
4. å¯»è·¯æµ‹è¯•ï¼šç‚¹å‡»æ ‘èƒŒåï¼Œç»¿çº¿å¿…é¡»ç»•å¼€æ ‘æœ¨ï¼Œè€Œä¸æ˜¯ç©¿è¿‡å»

---

### å…³é”®å†³ç­–

| å†³ç­– | åŸå›  | æ—¥æœŸ |
|------|------|------|
| åœ¨ NavGrid åˆ·æ–°å‰è°ƒç”¨ Physics2D.SyncTransforms() | ç¡®ä¿ç‰©ç†å¼•æ“åŒæ­¥åå†æ‰«æç¢°æ’ä½“ | 2026-01-10 |
| åºŸå¼ƒ Invoke å»¶è¿Ÿåˆ·æ–° | æ—¶åºä¸å¯é ï¼Œæ”¹ç”¨åŒæ­¥è°ƒç”¨ | 2026-01-10 |

### é—ç•™é—®é¢˜

- [ ] ä¿®å¤ NavGrid2D.RefreshGrid() æ·»åŠ  Physics2D.SyncTransforms()
- [ ] ä¿®å¤ TreeControllerV2 çš„ç¢°æ’ä½“æ›´æ–°æ—¶åº
- [ ] å®æœºéªŒè¯ï¼šæ ‘æœ¨æˆé•¿å NavGrid æ­£ç¡®æ›´æ–°


---

## ä¼šè¯ 7 - 2026-01-10ï¼ˆNavGrid åŠ¨æ€åˆ·æ–°è”åŠ¨ä¿®å¤ï¼‰

**é—®é¢˜æ¥æº**ï¼šå¯¼èˆªç³»ç»Ÿé‡æ„å·¥ä½œåŒºçš„é”è¯„å‘ç°

**é—®é¢˜æè¿°**ï¼š
æ ‘æœ¨æˆé•¿åï¼Œç¢°æ’ä½“å½¢çŠ¶å˜å¤§ï¼Œä½† NavGrid æ²¡æœ‰æ­£ç¡®æ›´æ–°é˜»æŒ¡åŒºåŸŸã€‚åŸå› æ˜¯ `UpdatePolygonColliderShape()` æ–¹æ³•åœ¨æ›´æ–°ç¢°æ’ä½“åæ²¡æœ‰é€šçŸ¥ NavGrid åˆ·æ–°ã€‚

**ä¿®å¤å†…å®¹**ï¼š

åœ¨ `UpdatePolygonColliderShape()` æ–¹æ³•æœ«å°¾æ·»åŠ  `RequestNavGridRefresh()` è°ƒç”¨ï¼š

```csharp
private void UpdatePolygonColliderShape()
{
    // ... åŸæœ‰ç¢°æ’ä½“æ›´æ–°é€»è¾‘ ...
    
    // ğŸ”¥ å…³é”®ä¿®å¤ï¼šç¢°æ’ä½“å½¢çŠ¶å˜åŒ–åï¼Œé€šçŸ¥ NavGrid åˆ·æ–°
    RequestNavGridRefresh();
}
```

**ä¿®æ”¹æ–‡ä»¶**ï¼š
- `Assets/YYY_Scripts/Controller/TreeControllerV2.cs`

**å…³è”ä¿®å¤**ï¼ˆåœ¨ NavGrid2D.cs ä¸­ï¼‰ï¼š
- åœ¨ `RebuildGrid()` å¼€å¤´æ·»åŠ  `Physics2D.SyncTransforms()` è°ƒç”¨
- ç¡®ä¿ç‰©ç†ç³»ç»Ÿçš„ Transform å˜åŒ–è¢«åŒæ­¥åˆ°ç¢°æ’æ£€æµ‹

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] æ ‘æœ¨æˆé•¿åï¼ŒNavGrid çš„çº¢è‰²é˜»æŒ¡æ ¼å­éšä¹‹å˜å¤§
- [ ] æ ‘æœ¨è¢«ç å€’å˜æˆæ ‘æ¡©åï¼Œé˜»æŒ¡åŒºåŸŸç›¸åº”ç¼©å°

**çŠ¶æ€**ï¼šä»£ç å·²ä¿®æ”¹ï¼Œå¾…å®æœºéªŒè¯
