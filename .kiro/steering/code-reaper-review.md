# 锐评处理规范

**创建日期**: 2026-01-27
**适用范围**: 所有来自外部架构师/Code Reaper 的锐评文档
**优先级**: P0（最高优先级）

---

## 核心原则

锐评是来自外部架构师的专业审计报告，需要严肃对待、独立思考、规范执行。

---

## 锐评处理流程

### 第一步：创建/更新 Memory（必须先做！）

**在阅读锐评之前**，必须先确保工作区的 memory 文件存在：

1. **主工作区 memory**：`.kiro/specs/{工作区名}/memory.md`
2. **子工作区 memory**：`.kiro/specs/{工作区名}/{子工作区}/memory.md`

如果 memory 不存在，**立即创建**，记录：
- 工作区概述
- 当前状态
- 会话开始时间

### 第二步：阅读锐评

1. **完整阅读**：不要跳读，逐段理解
2. **记录要点**：在 memory 中记录锐评的核心指令
3. **标注疑虑**：对有疑问的指令做标记

### 第三步：独立思考与审视

**必须进行独立思考**，不能盲目执行：

1. **验证可行性**：检查指令涉及的文件是否存在
2. **评估影响**：删除/重命名操作会影响哪些代码
3. **识别风险**：是否会导致编译错误、Missing Script 等问题
4. **提出疑虑**：如果发现问题，必须中断并向用户反馈

### 第四步：回复用户

回复必须包含以下内容：

```markdown
## 锐评审视报告

### 锐评概述
- 锐评编号：XXX
- 核心指令：[简述]

### 我的独立思考
- 认同的部分：[列出]
- 疑虑/异议：[列出，如果有]

### 执行计划
- [如果无异议] 按以下顺序执行：...
- [如果有异议] 需要用户确认：...

### 风险提示
- [列出可能的风险]
```

### 第五步：执行（用户确认后）

1. **按顺序执行**：不要跳过任何步骤
2. **每步汇报**：完成一个战场后简短汇报
3. **遇错中断**：如果执行过程中发现问题，立即中断并报告

### 第六步：更新 Memory

执行完成后，**必须更新 memory**：

```markdown
### 会话 N - YYYY-MM-DD（锐评执行）

**锐评来源**: 锐评XXX

**执行内容**:
1. [已完成的操作]
2. [已完成的操作]

**修改文件**:
- `path/to/file` - [操作说明]

**遗留问题**:
- [ ] [如果有]
```

---

## 锐评类型与处理方式

### 类型 A：分析型锐评

**特征**：对代码库进行深度分析，指出问题和风险
**处理**：
- 仔细阅读，理解问题本质
- 记录到 memory 作为技术债务清单
- 不需要立即执行，但需要规划

### 类型 B：指令型锐评

**特征**：给出具体的执行指令（删除、重命名、重构）
**处理**：
- 验证指令的可行性
- 检查依赖关系
- 有疑虑时必须中断并反馈
- 用户确认后按顺序执行

### 类型 C：混合型锐评

**特征**：既有分析也有指令
**处理**：
- 分析部分记录到 memory
- 指令部分按类型 B 处理

---

## 异议处理规范

### 何时提出异议

1. **指令涉及的文件不存在**
2. **删除操作会导致编译错误**（有代码依赖被删除的类）
3. **重命名操作会导致 Missing Script**
4. **指令与项目实际情况不符**
5. **指令之间存在矛盾**

### 如何提出异议

```markdown
## 🔴 异议：[简述问题]

**锐评指令**：[原文引用]

**我的发现**：
- [具体问题描述]
- [证据/代码引用]

**影响评估**：
- [如果执行会发生什么]

**我的建议**：
- [替代方案]

**请用户确认**：
1. [选项 A]
2. [选项 B]
```

---

## 汇报格式

### 战场完成汇报

```markdown
## 第 N 战场完成：[战场名称]

**Deleted**:
- `path/to/file1.cs`
- `path/to/file2.cs`

**Renamed**:
- `OldName.cs` → `NewName.cs`

**Refactored**:
- `GameInputManager.cs` - 修复引用
- `SomeEditor.cs` - 更新类名

**编译状态**: ✅ 成功 / ❌ 失败（原因）
```

### 全部完成汇报

```markdown
## 锐评执行完成

**执行时间**: YYYY-MM-DD
**锐评编号**: XXX

**总结**:
- 删除文件：N 个
- 重命名文件：N 个
- 修复引用：N 处

**验证状态**: ✅ 编译通过 / ⚠️ 需要用户验证

**下一步**:
- [建议的后续操作]
```

---

## 禁止事项

1. ❌ **不创建 memory 就开始执行**
2. ❌ **不阅读完整锐评就开始执行**
3. ❌ **不验证可行性就盲目执行**
4. ❌ **发现问题不中断继续执行**
5. ❌ **执行完成不更新 memory**
6. ❌ **跳过用户确认直接执行有风险的操作**

---

## 检查清单

每次处理锐评时，必须确认：

- [ ] memory 文件已创建/更新
- [ ] 锐评已完整阅读
- [ ] 独立思考已完成
- [ ] 疑虑已向用户反馈（如果有）
- [ ] 用户已确认执行（如果有风险操作）
- [ ] 执行过程已汇报
- [ ] memory 已更新执行结果

---

**文档维护者**: Kiro
**最后更新**: 2026-01-27
