# Sunset 第二阶段初步规划

**规划时间**: 2024年12月1日  
**执行阶段**: 第二阶段（玩法系统实现）  
**预计周期**: 第11-20天（约10个工作日）  
**核心目标**: 实现完整的种植循环、场景搭建和基础战斗系统

---

## 🎯 阶段目标

### 总体目标
从第一阶段的**框架搭建**转向**玩法实现**，建立玩家核心游戏循环：
1. 种植循环：锄地 → 种植 → 浇水 → 生长 → 收获
2. 场景完善：完整的世界地图与资源分布
3. 反馈系统：音效、粒子效果、UI反馈
4. 战斗系统：基础生命值与怪物AI

### 关键里程碑
- **里程碑1**（第15天）：完整的种田循环可玩
- **里程碑2**（第17天）：完整的场景与资源分布
- **里程碑3**（第20天）：基础战斗系统运行

---

## 📅 周计划概览

### 第三周：种植系统（第11-15天）
- **第11天**：锄地系统（耕地Tilemap、锄头动画、FarmingSystem.cs）
- **第12天**：种子与种植系统（CropData、种子物品、种植逻辑）
- **第13天**：浇水与作物护理（浇水壶动画、浇水系统、作物需水管理）
- **第14天**：收获系统（收获动画、收获逻辑、可重复收获、作物质量）
- **第15天**：农业系统综合测试（完整流程测试、平衡性调整、UI优化、Bug修复）

### 第四周：场景与战斗（第16-20天）
- **第16天**：主场景规划与地形搭建（场景设计、Tilemap绘制、碰撞设置）
- **第17天**：资源点分布与场景完善（树木/岩石分布、装饰、导航验证）
- **第18天**：音效系统集成（AudioManager、BGM、SFX、环境音）
- **第19天**：生命值系统（HealthSystem、血量UI、受伤反馈、死亡机制）
- **第20天**：基础怪物系统（EnemyData、怪物预制体、EnemyAI、战斗逻辑）

---

## 📋 详细任务分解

### 第11天：锄地系统

**核心目标**：实现土地耕作功能

**关键产出**：
- 耕地Tilemap层（未耕作/已耕作/湿润）
- 锄头动画（3方向，0.3-0.4秒）
- `FarmingSystem.cs`（检测地面、切换Tile、耕地记录、精力消耗）
- `FarmlandData.cs`（位置、状态、浇水记录）
- 泥土飞溅粒子效果

**测试标准**：
- 可对草地/泥土使用锄头，Tile变为耕地
- 不能对水域/石头等不可耕作区域使用
- 消耗精力正确（3点）

---

### 第12天：种子与种植系统

**核心目标**：实现种子数据与种植功能

**关键产出**：
- `CropData.cs` ScriptableObject（cropID、生长阶段sprite、天数、季节限制、收获物品）
- 种子ItemData（2000-2999 ID范围）
- 基础种子5种：萝卜、番茄、小麦、南瓜、草莓
- `Crop.prefab`预制体 + `CropGrowth.cs`脚本
- `PlantSeed()`方法（季节检查、生成作物、从背包移除种子）

**测试标准**：
- 可在耕地上种植种子
- 不同种子种植正确的作物
- 非耕地或已有作物的地方不能种植

---

### 第13天：浇水与作物护理

**核心目标**：完善作物管理系统

**关键产出**：
- 浇水壶动画（3方向，0.5-0.6秒）+ 水流粒子效果
- `WateringSystem.cs`（检测耕地/作物、改变湿润状态、切换Tile、消耗精力2点）
- 土地湿度系统（24小时后变干，自动切换Tile）
- 作物需水逻辑（连续2天未浇水→停滞，3天→枯萎）
- 枯萎系统（枯萎sprite、可清除不可收获）
- 浇水状态UI（水滴图标）

**测试标准**：
- 可给作物和土地浇水，Tile变湿润
- 24小时后土地自动变干
- 未浇水作物会枯萎，枯萎作物可清除

---

### 第14天：收获系统与作物完善

**核心目标**：完整的作物生命周期

**关键产出**：
- 作物成熟判定（isHarvestable标记、闪烁效果）
- 收获动画（玩家弯腰、作物消失、物品掉落）
- `HarvestCrop()`方法（检查成熟、生成掉落物品、重生或销毁）
- 可重复收获系统（番茄/草莓回到第2阶段）
- 作物质量系统（普通/优质/完美，影响收获数量）
- 季节限制（非适宜季节生长减半或失败）

**测试标准**：
- 成熟作物可收获，获得正确物品
- 可重复收获作物正确重生
- 一次性作物收获后消失，土地可重新使用

---

### 第15天：农业系统综合测试

**核心目标**：完整的种田循环测试与优化

**关键任务**：
1. **完整流程测试**（2h）：耕地→种植→浇水→生长→收获→重新种植，测试5种作物
2. **平衡性调整**（2h）：生长时间（5-15天）、精力消耗、收获数量、种子价格
3. **UI优化**（2h）：新手引导、Tooltip（季节/生长时间）、作物信息（生长阶段/浇水状态）
4. **Bug修复**（1h）：生长异常、浇水判定、收获逻辑、性能优化
5. **数据完善**（1h）：10种作物（春/夏/秋/冬各2-3种）

**测试标准**：
- 所有作物正常生长和收获
- 季节限制正确生效
- 无严重Bug，性能良好（30+ FPS）

**里程碑达成**：完整的种田循环可玩 ✅

---

### 第16天：主场景规划与地形搭建

**核心目标**：完成游戏主场景的基础地形

**关键产出**：
- 场景布局设计（100x80格）：农场区、森林区、矿洞区、湖泊区、村庄区、山地区
- Tilemap层级（Ground_Base/Detail、Farmland、Paths、Water、Cliff）
- 基础地形绘制（草地、森林、矿区）
- 细节绘制（道路、水域、悬崖、过渡）
- 碰撞层设置（Tilemap Collider2D）
- 场景美化（草丛、花朵、石头）

**测试标准**：
- 场景布局合理，各区域清晰
- 各区域过渡自然，碰撞正确无穿模
- 玩家可到达所有区域

---

### 第17天：资源点分布与场景完善

**核心目标**：合理分布游戏资源，完善场景细节

**关键产出**：
- 树木分布（森林40-60棵、农场5-10棵、山地10-15棵）
- 岩石/矿石分布（矿区30-50个，比例：普通60%/铁30%/金8%/稀有2%）
- 功能性建筑（玩家小屋、工具棚、井、邮箱、指示牌）
- 场景装饰（前景/背景装饰、粒子效果、光照）
- 场景过渡处理（视觉风格区分、区域指示）
- 导航网格验证（确认覆盖整个场景）

**测试标准**：
- 资源点分布合理，场景美观不杂乱
- 性能稳定（30+ FPS）
- 导航网格覆盖整个场景

**里程碑达成**：完整的场景与资源分布 ✅

---

### 第18天：音效系统集成

**核心目标**：为游戏添加基础音效和背景音乐

**关键产出**：
- 音效文件夹结构（BGM、SFX/Actions/UI/Environment/Character）
- `AudioManager.cs`单例（BGM播放/切换、SFX播放、音量控制、音效池）
- 动作音效集成（砍树、挖矿、锄地、浇水、收获、脚步）
- UI音效（按钮点击、背包开关、拾取、拖动）
- 环境音效（风声、鸟叫、水流）
- BGM整合（白天/夜晚切换、季节主题）

**测试标准**：
- 所有动作有对应音效
- BGM平滑切换无卡顿
- 音量可调节

---

### 第19天：生命值系统

**核心目标**：实现玩家血量和受伤机制

**关键产出**：
- `HealthSystem.cs`（currentHealth、maxHealth、TakeDamage、Heal、OnDeath）
- 玩家血量UI（左上角，心形图标+红色血条，5个心=100HP）
- 受伤反馈（角色闪红、屏幕闪烁、音效、击退）
- 死亡机制（死亡动画、Game Over界面、重生/读档选项）
- 治疗系统（食物物品、治疗动画）
- 无敌时间（1.5秒，角色闪烁）

**测试标准**：
- 受伤后血量减少，UI正确更新
- 血量为0时触发死亡
- 治疗物品正常工作，无敌时间生效

---

### 第20天：基础怪物系统

**核心目标**：实现简单的敌人AI

**关键产出**：
- `EnemyData.cs` ScriptableObject（名称、血量、速度、攻击、检测范围、掉落表）
- 基础怪物预制体（Enemy_Slime.prefab + 组件）
- 怪物动画（Idle、Move、Attack、Hurt、Death）
- `EnemyAI.cs`状态机（Idle/巡逻、Chase追击、Attack攻击、Hurt受伤、Death死亡）
- 攻击检测与伤害计算
- 怪物掉落系统（死亡后掉落物品）

**测试标准**：
- 怪物能检测玩家并追击
- 进入攻击范围后能攻击玩家
- 受伤后有反馈，死亡后掉落物品

**里程碑达成**：基础战斗系统运行 ✅

---

## 🛠️ 技术准备

### 资源需求
- **音效资源**：BGM（4首）、SFX（20+个）
- **作物素材**：10种作物 × 4-5个生长阶段 = 40-50个sprite
- **怪物素材**：史莱姆动画（5个状态 × 4帧 = 20帧）
- **粒子效果**：泥土飞溅、水流、破碎、治疗光圈
- **UI素材**：血量心形、水滴图标、指示牌

### 工具插件
- **DOTween**：动画缓动（收获动画、UI动画）
- **Cinemachine**：摄像机跟随与震动（可选）
- **Particle System**：粒子效果（已有）

### 依赖系统
- 时间系统（已完成）✅
- 背包系统（已完成）✅
- 导航系统（已完成）✅
- 掉落物系统（需在第11-12天之间实现）⚠️
- 精力系统数据结构（需添加）⚠️

---

## 📊 预期成果

### 功能完成度
- 种植系统：100%
- 场景搭建：100%
- 音效系统：80%（缺乏部分音效资源）
- 战斗系统：60%（基础AI，未完善）

### 可玩性
- 玩家可以体验完整的种田循环
- 玩家可以在完整的世界地图中探索和导航
- 玩家可以与简单的怪物战斗
- 游戏有基础的音效反馈

### 下一阶段铺垫
- 为第三阶段的NPC系统预留村庄区域
- 为钓鱼系统预留湖泊区域
- 为商店系统建立物品价格体系
- 为任务系统预留邮箱交互点

---

## 🎓 风险与挑战

### 已知风险
1. **资源准备不足**：音效、作物sprite、怪物动画可能需要外包或购买
2. **性能优化**：大量作物和树木可能影响性能
3. **平衡性调整**：生长时间、精力消耗、物品价格需反复调整
4. **AI复杂度**：怪物AI可能比预期复杂

### 缓解措施
1. 提前准备资源清单，寻找免费/付费素材库
2. 使用对象池优化作物和掉落物
3. 预留第15天和第20天作为测试与调整时间
4. AI先实现基础功能，复杂行为后续迭代

---

## 📝 每日工作流

### 标准工作日流程
1. **上午**（4小时）：核心功能开发
2. **下午**（4小时）：完善细节 + 测试
3. **每日结束**：提交代码 + 更新文档

### 每周检查点
- **周三**（第13天）：种植系统中期检查
- **周五**（第15天）：种植系统完整测试 → 里程碑1
- **下周三**（第18天）：音效系统集成
- **下周五**（第20天）：战斗系统基础完成 → 里程碑3

---

## 🚀 第二阶段成功标准

1. ✅ 玩家可以完整体验：耕地→种植→浇水→生长→收获
2. ✅ 至少10种作物，覆盖春夏秋三个季节
3. ✅ 完整的世界地图（100x80格），包含6个主要区域
4. ✅ 40-60棵树木，30-50个岩石/矿石，分布合理
5. ✅ 基础音效系统运行，BGM可切换
6. ✅ 玩家有血量系统，可受伤和治疗
7. ✅ 至少1种怪物，具备基础AI（检测、追击、攻击）
8. ✅ 性能稳定（30+ FPS）

---

**规划完成时间**: 2024年12月1日  
**预计开始时间**: 2024年12月2日  
**预计完成时间**: 2024年12月11日
