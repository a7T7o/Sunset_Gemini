# ä¿®å¤æ€»ç»“ - Orderè‡ªåŠ¨è°ƒæ•´ + æµ‹è¯•æŒ‰é”®ä¼˜åŒ–

## ğŸ“‹ ä¿®å¤å†…å®¹

### 1ï¸âƒ£ **LayerAnimSync - è‡ªåŠ¨Orderè°ƒæ•´**

**é—®é¢˜**ï¼š
- Handçš„Orderéœ€è¦æ‰‹åŠ¨è®¾ç½®ä¸ºæ¯”Playeré«˜
- ä½¿ç”¨002å·¥å…·åŠ¨æ€æ’åºåï¼ŒHandçš„Orderå¯èƒ½ä¸æ­£ç¡®
- å·¥å…·è¢«è§’è‰²èº«ä½“é®æŒ¡

**ä¿®å¤**ï¼š
```csharp
// LayerAnimSync.UpdateToolVisibility()
if (shouldShowTool)
{
    // è‡ªåŠ¨è°ƒæ•´Orderï¼ˆç¡®ä¿Toolæ˜¾ç¤ºåœ¨Playerå‰é¢ï¼‰
    toolSpriteRenderer.sortingLayerID = playerSpriteRenderer.sortingLayerID;
    toolSpriteRenderer.sortingOrder = playerSpriteRenderer.sortingOrder + 1;
}
```

**æ•ˆæœ**ï¼š
- âœ… Handè‡ªåŠ¨ä½¿ç”¨Playerçš„Sorting Layer
- âœ… Handçš„Orderè‡ªåŠ¨è®¾ä¸º Playerçš„Order + 1
- âœ… å®Œå…¨é€‚é…002å·¥å…·çš„åŠ¨æ€æ’åº
- âœ… æ— éœ€ä»»ä½•æ‰‹åŠ¨é…ç½®

---

### 2ï¸âƒ£ **PlayerToolController - æµ‹è¯•æŒ‰é”®ä¼˜åŒ–**

**é—®é¢˜**ï¼š
- åŸæŒ‰é”®æ–¹æ¡ˆï¼ˆQ/W/E/R/T/Yï¼‰ä¸ç°æœ‰æ“ä½œå†²çª
  - W = è¡Œèµ°
  - E = æ‹¾å–ï¼ˆCollectï¼‰
  
**ä¿®å¤**ï¼š
```csharp
// æ”¹ä¸ºQé”®å¾ªç¯åˆ‡æ¢
if (Input.GetKeyDown(KeyCode.Q))
{
    // å¾ªç¯ï¼š0(æœ¨) â†’ 1(çŸ³) â†’ 2(ç£¨çŸ³) â†’ 3(é“œ) â†’ 4(é“) â†’ 5(é‡‘) â†’ 0
    currentToolQuality = (currentToolQuality + 1) % 6;
    EquipTool(currentToolType, currentToolQuality);
}
```

**æ•ˆæœ**ï¼š
- âœ… é¿å…æŒ‰é”®å†²çª
- âœ… å¾ªç¯åˆ‡æ¢æ›´æ–¹ä¾¿æµ‹è¯•
- âœ… ä»…ç”¨äºç¼–è¾‘å™¨æµ‹è¯•ï¼ˆ#if UNITY_EDITORï¼‰

---

## ğŸ“š æ–°å¢æ–‡æ¡£

### 1. `002å·¥å…·é…åˆ_Handæ’åºè®¾ç½®.md`

**å†…å®¹**ï¼š
- è¯¦ç»†è¯´æ˜002å·¥å…·ä¸Handæ’åºçš„é…åˆ
- ä¸‰ç§Orderè®¾ç½®æ–¹æ³•å¯¹æ¯”
- å®Œæ•´çš„è°ƒè¯•å’ŒéªŒè¯æµç¨‹

**æ ¸å¿ƒè¦ç‚¹**ï¼š
```
Playerçš„Orderï¼ˆ002å·¥å…·è®¡ç®—ï¼‰ï¼š-1000
Handçš„Orderï¼ˆLayerAnimSyncè‡ªåŠ¨ï¼‰ï¼š-999ï¼ˆæ¯”Playeré«˜1ï¼‰
```

### 2. æ›´æ–°æ‰€æœ‰ç›¸å…³æ–‡æ¡£

**ä¿®æ”¹çš„æ–‡æ¡£**ï¼š
- `å·¥å…·åŒæ­¥ç³»ç»Ÿ_è®¾ç½®æŒ‡å—.md`
  - æ·»åŠ Orderè®¾ç½®çš„è¯¦ç»†è¯´æ˜
  - æ›´æ–°æµ‹è¯•æŒ‰é”®è¯´æ˜

- `å¿«é€Ÿæµ‹è¯•_å·¥å…·åŒæ­¥ç³»ç»Ÿ.md`
  - æ›´æ–°æµ‹è¯•æ­¥éª¤ï¼ˆQé”®ï¼‰

- `å·¥å…·åŠ¨ç”»ç³»ç»Ÿä½¿ç”¨æŒ‡å—.md`
  - æ·»åŠ Orderè‡ªåŠ¨è°ƒæ•´è¯´æ˜
  - æ·»åŠ 002å·¥å…·é…åˆè¯´æ˜
  - æ›´æ–°è„šæœ¬åŠŸèƒ½è¯´æ˜

---

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### å›ºå®šåœºæ™¯ï¼ˆä¸ä½¿ç”¨002å·¥å…·ï¼‰

```
1. Player: Order = 0ï¼ˆæ‰‹åŠ¨è®¾ç½®ï¼‰
2. Hand: Order = ä»»æ„å€¼ï¼ˆLayerAnimSyncä¼šè‡ªåŠ¨è°ƒæ•´ä¸º1ï¼‰
3. è¿è¡Œæ¸¸æˆï¼ŒLayerAnimSyncè‡ªåŠ¨è®¾ç½®Hand.Order = 1
```

### åŠ¨æ€æ’åºï¼ˆä½¿ç”¨002å·¥å…·ï¼‰

```
1. ä½¿ç”¨002å·¥å…·è®¾ç½®Playerçš„Order
   â†’ Player.Order = -1000ï¼ˆåŸºäºYåæ ‡è®¡ç®—ï¼‰

2. Handçš„Orderå¯ä»¥ä¸ç®¡
   â†’ å¯ä»¥æ˜¯é»˜è®¤å€¼
   â†’ ä¹Ÿå¯ä»¥è®¾ä¸º -9999ï¼ˆç‰¹æ®Šæ ‡è®°ï¼Œé˜²æ­¢è¢«002ä¿®æ”¹ï¼‰

3. è¿è¡Œæ¸¸æˆï¼ŒLayerAnimSyncè‡ªåŠ¨è°ƒæ•´
   â†’ Hand.Order = Player.Order + 1 = -999

4. å·¥å…·æ­£ç¡®æ˜¾ç¤ºåœ¨Playerå‰é¢ âœ…
```

---

## ğŸ§ª æµ‹è¯•æµç¨‹

### æ­¥éª¤1ï¼šå‡†å¤‡åœºæ™¯
```
1. åˆ›å»ºPlayerå’ŒHandå±‚çº§
2. ç¦ç”¨Handçš„SpriteRenderer
3. ï¼ˆå¯é€‰ï¼‰ä½¿ç”¨002å·¥å…·è®¾ç½®Playerçš„Order
```

### æ­¥éª¤2ï¼šæ·»åŠ è„šæœ¬
```
1. Playerä¸Šæ·»åŠ LayerAnimSync
2. æ­£ç¡®é…ç½®æ‰€æœ‰å¼•ç”¨
3. è®¾ç½®Tool Active States = [6]
```

### æ­¥éª¤3ï¼šè¿è¡Œæµ‹è¯•
```
è¿è¡Œæ¸¸æˆ

æµ‹è¯•1ï¼šå·¥å…·é»˜è®¤éšè—
  â†’ âœ… åªæ˜¾ç¤ºPlayer

æµ‹è¯•2ï¼šåˆ‡æ¢å·¥å…·
  â†’ æŒ‰Qé”®å¾ªç¯åˆ‡æ¢
  â†’ âœ… Consoleæ˜¾ç¤ºå“è´¨å˜åŒ–

æµ‹è¯•3ï¼šæ‰§è¡ŒSlice
  â†’ æŒ‰2é”®
  â†’ âœ… Handæ˜¾ç¤º
  â†’ âœ… Handåœ¨Playerå‰é¢ï¼ˆOrderæ›´é«˜ï¼‰
  â†’ âœ… åŠ¨ç”»å®Œå…¨åŒæ­¥
  â†’ âœ… åŠ¨ç”»ç»“æŸHandæ¶ˆå¤±
```

---

## ğŸ“Š Orderè§„åˆ™æ€»ç»“

### æ ¸å¿ƒè§„åˆ™

```
Orderå€¼è¶Šå¤§ = æ˜¾ç¤ºè¶Šé å‰

ç¤ºä¾‹ï¼š
  Order = -1000  â† Playerï¼ˆåé¢ï¼‰
  Order = -999   â† Handï¼ˆå‰é¢ï¼Œæ˜¾ç¤ºåœ¨Playerä¸Šå±‚ï¼‰
  
å¦‚æœè®¾ç½®é”™è¯¯ï¼š
  Order = -1000  â† Playerï¼ˆå‰é¢ï¼‰
  Order = -1001  â† Handï¼ˆåé¢ï¼Œè¢«Playeré®æŒ¡ï¼‰âŒ
```

### LayerAnimSyncè‡ªåŠ¨è°ƒæ•´

```csharp
// æ¯æ¬¡æ˜¾ç¤ºToolæ—¶è‡ªåŠ¨æ‰§è¡Œ
Hand.sortingLayerID = Player.sortingLayerID;  // åŒå±‚
Hand.sortingOrder = Player.sortingOrder + 1;  // Order +1
```

**ä¼˜åŠ¿**ï¼š
- Playerçš„Orderæ”¹å˜ï¼ˆå¦‚002å·¥å…·é‡æ–°è®¡ç®—ï¼‰
- Handçš„Orderè‡ªåŠ¨è·Ÿéšè°ƒæ•´
- å§‹ç»ˆä¿æŒHandåœ¨Playerå‰é¢

---

## âœ… é…ç½®æ£€æŸ¥æ¸…å•

### ç¼–è¾‘å™¨è®¾ç½®

- [ ] Handçš„SpriteRendereré»˜è®¤**ç¦ç”¨**
- [ ] Handçš„Sorting Layerä¸Player**ç›¸åŒ**ï¼ˆæˆ–ç•™ç©ºï¼Œè¿è¡Œæ—¶è‡ªåŠ¨åŒæ­¥ï¼‰
- [ ] Handçš„Orderå¯ä»¥æ˜¯ä»»æ„å€¼ï¼ˆè¿è¡Œæ—¶è‡ªåŠ¨è°ƒæ•´ï¼‰

### è„šæœ¬é…ç½®

- [ ] LayerAnimSyncæ­£ç¡®å¼•ç”¨Playerçš„Animatorå’ŒSpriteRenderer
- [ ] LayerAnimSyncæ­£ç¡®å¼•ç”¨Handçš„Animatorå’ŒSpriteRenderer
- [ ] Tool Active StatesåŒ…å« [6]ï¼ˆSliceï¼‰
- [ ] PlayerToolControlleræ­£ç¡®é…ç½®Controllerå¼•ç”¨

### è¿è¡Œæ—¶éªŒè¯

- [ ] æŒ‰Qé”®å¯ä»¥åˆ‡æ¢å·¥å…·å“è´¨
- [ ] æŒ‰2é”®Handæ˜¾ç¤ºå¹¶åŒæ­¥åŠ¨ç”»
- [ ] Handæ˜¾ç¤ºåœ¨Player**å‰é¢**ï¼ˆä¸è¢«é®æŒ¡ï¼‰
- [ ] åŠ¨ç”»ç»“æŸåHandæ¶ˆå¤±
- [ ] Consoleæ— é”™è¯¯

**å…¨éƒ¨å‹¾é€‰å³é…ç½®æ­£ç¡®ï¼** âœ¨

---

## ğŸ¯ å…³é”®æ”¹è¿›ç‚¹

### 1. è‡ªåŠ¨åŒ–Orderç®¡ç†

**ä¹‹å‰**ï¼š
- âŒ éœ€è¦æ‰‹åŠ¨è®¾ç½®Handçš„Order
- âŒ 002å·¥å…·å¯èƒ½è¯¯ä¿®æ”¹Hand
- âŒ Playerçš„Orderå˜åŒ–åéœ€æ‰‹åŠ¨è°ƒæ•´Hand

**ç°åœ¨**ï¼š
- âœ… LayerAnimSyncè‡ªåŠ¨ç®¡ç†Order
- âœ… å®Œå…¨é€‚é…åŠ¨æ€æ’åº
- âœ… æ— éœ€ä»»ä½•æ‰‹åŠ¨å¹²é¢„

### 2. æµ‹è¯•ä½“éªŒä¼˜åŒ–

**ä¹‹å‰**ï¼š
- âŒ Q/W/E/R/T/Yåˆ‡æ¢ï¼Œä¸æ“ä½œå†²çª
- âŒ éœ€è¦è®°6ä¸ªæŒ‰é”®

**ç°åœ¨**ï¼š
- âœ… Qé”®å¾ªç¯åˆ‡æ¢ï¼Œé¿å…å†²çª
- âœ… åªéœ€è®°1ä¸ªæŒ‰é”®
- âœ… æ›´ç¬¦åˆæµ‹è¯•ä¹ æƒ¯

### 3. æ–‡æ¡£å®Œå–„

**æ–°å¢**ï¼š
- âœ… 002å·¥å…·é…åˆä¸“é—¨æŒ‡å—
- âœ… Orderè‡ªåŠ¨è°ƒæ•´æœºåˆ¶è¯´æ˜
- âœ… å®Œæ•´çš„æµ‹è¯•å’ŒéªŒè¯æµç¨‹

**æ›´æ–°**ï¼š
- âœ… æ‰€æœ‰ç›¸å…³æ–‡æ¡£åŒæ­¥æ›´æ–°
- âœ… æ·»åŠ è¯¦ç»†çš„é…ç½®è¯´æ˜
- âœ… å¢åŠ è°ƒè¯•æ–¹æ³•

---

## ğŸš€ ä¸‹ä¸€æ­¥

### ç”Ÿäº§ç¯å¢ƒé›†æˆ

```csharp
// åˆ é™¤PlayerToolControllerçš„æµ‹è¯•ä»£ç 
void Update()
{
    // ç”Ÿäº§ç¯å¢ƒï¼šåˆ é™¤æµ‹è¯•ä»£ç 
}

// é›†æˆåˆ°UIç³»ç»Ÿ
public void OnToolSelected(int toolType, int toolQuality)
{
    playerToolController.EquipTool(toolType, toolQuality);
}
```

### æ‰©å±•å…¶ä»–å·¥å…·åŠ¨ä½œ

```csharp
// åœ¨LayerAnimSyncä¸­æ·»åŠ æ›´å¤šState
[SerializeField] private int[] toolActiveStates = new int[] 
{ 
    6,  // Sliceï¼ˆæ–§å¤´ï¼‰
    7,  // Pierceï¼ˆå‰‘/çŸ›ï¼‰
    8,  // Crushï¼ˆé”¤å­ï¼‰
    // æ·»åŠ æ›´å¤š...
};
```

---

## ğŸ’¡ æ ¸å¿ƒç†å¿µ

**å®Œå…¨è‡ªåŠ¨åŒ–çš„å·¥å…·ç³»ç»Ÿ**ï¼š

1. **æ˜¾ç¤ºæ§åˆ¶** - è‡ªåŠ¨æ˜¾ç¤º/éšè—
2. **Orderç®¡ç†** - è‡ªåŠ¨è°ƒæ•´æ’åº
3. **åŠ¨ç”»åŒæ­¥** - è‡ªåŠ¨æ—¶é—´åŒ¹é…
4. **å‚æ•°ä¼ é€’** - è‡ªåŠ¨å‚æ•°åŒæ­¥

**å¼€å‘è€…åªéœ€è¦**ï¼š
- é…ç½®å¥½å¼•ç”¨
- è®¾ç½®Tool Active States
- å…¶ä»–å…¨éƒ¨è‡ªåŠ¨å®Œæˆ

**å®Œç¾é›†æˆ002å·¥å…·ï¼Œæ”¯æŒåŠ¨æ€æ’åºï¼** ğŸ‰


