# å¿«é€Ÿæµ‹è¯• - å·¥å…·åŒæ­¥ç³»ç»Ÿ

## âš¡ 5åˆ†é’Ÿæµ‹è¯•æ¸…å•

### æ­¥éª¤1ï¼šåœºæ™¯å‡†å¤‡ (1åˆ†é’Ÿ)

1. **åˆ›å»ºPlayer**
   - æ·»åŠ SpriteRenderer + Animator
   - è®¾ç½®Player.controller

2. **åˆ›å»ºHandå­ç‰©ä½“**
   - Player â†’ å³é”® â†’ Create Empty â†’ é‡å‘½åä¸º"Hand"
   - æ·»åŠ SpriteRenderer + Animator
   - è®¾ç½®Tool_Axe.controller
   - **âš ï¸ ç¦ç”¨Handçš„SpriteRendererï¼**

3. **è®¾ç½®Sorting**
   - Player: Order in Layer = 0
   - Hand: Order in Layer = 1

### æ­¥éª¤2ï¼šæ·»åŠ è„šæœ¬ (2åˆ†é’Ÿ)

åœ¨Player GameObjectä¸Šæ·»åŠ ï¼š

1. **LayerAnimSync**
   - Player Animator â†’ Playerçš„Animator
   - Player Sprite Renderer â†’ Playerçš„SpriteRenderer
   - Tool Animator â†’ Handçš„Animator
   - Tool Sprite Renderer â†’ Handçš„SpriteRenderer
   - Tool Active States: [6] (åªå¡«6å³å¯)

2. **PlayerToolController**
   - Player Animator â†’ Playerçš„Animator
   - Tool Animator â†’ Handçš„Animator
   - Axe Controller â†’ Tool_Axe.controller
   - Current Tool Type: 0
   - Current Tool Quality: 0

### æ­¥éª¤3ï¼šè¿è¡Œæµ‹è¯• (2åˆ†é’Ÿ)

**è¿è¡Œæ¸¸æˆ**

**æµ‹è¯•1ï¼šå·¥å…·é»˜è®¤éšè—**
- âœ… åº”è¯¥çœ‹åˆ°ï¼šåªæœ‰Playerï¼ŒHandä¸å¯è§
- âŒ å¦‚æœHandå¯è§ï¼šæ£€æŸ¥SpriteRendereræ˜¯å¦ç¦ç”¨

**æµ‹è¯•2ï¼šåˆ‡æ¢å·¥å…·å“è´¨**
- æŒ‰Qé”®ï¼ˆå¾ªç¯åˆ‡æ¢ï¼šæœ¨â†’çŸ³â†’ç£¨çŸ³â†’é“œâ†’é“â†’é‡‘â†’æœ¨ï¼‰
- âœ… åº”è¯¥çœ‹åˆ°ï¼šConsoleæ˜¾ç¤º"[è£…å¤‡å·¥å…·] ç±»å‹=æ–§å¤´, å“è´¨=xxx"
- âŒ å¦‚æœæ— ååº”ï¼šæ£€æŸ¥PlayerToolControlleræ˜¯å¦æ·»åŠ 

**æµ‹è¯•3ï¼šæ‰§è¡ŒSliceåŠ¨ä½œ**
- æŒ‰2é”®
- âœ… åº”è¯¥çœ‹åˆ°ï¼š
  1. Handç¬é—´æ˜¾ç¤º
  2. Playerå’ŒHandåŒæ—¶å¼€å§‹æŒ¥ç 
  3. åŠ¨ç”»å®Œå…¨åŒæ­¥
  4. åŠ¨ç”»ç»“æŸåHandæ¶ˆå¤±
- âŒ å¦‚æœHandä¸æ˜¾ç¤ºï¼šæ£€æŸ¥Tool Active Statesæ˜¯å¦åŒ…å«6
- âŒ å¦‚æœHandä¸€ç›´æ˜¾ç¤ºï¼šæ£€æŸ¥Stateæ˜¯å¦æ­£ç¡®åˆ‡æ¢å›0
- âŒ å¦‚æœä¸åŒæ­¥ï¼šæ£€æŸ¥LayerAnimSyncçš„æ‰€æœ‰å¼•ç”¨

---

## ğŸ” å¿«é€Ÿè¯Šæ–­

### é—®é¢˜ï¼šHandä¸€ç›´ä¸æ˜¾ç¤º

**å¯èƒ½åŸå› **ï¼š
1. SpriteRendererè¢«ç¦ç”¨äº†ï¼ˆâœ… æ­£ç¡®ï¼‰ä½†Tool Active Statesæ²¡æœ‰åŒ…å«6
2. LayerAnimSyncçš„Tool Sprite Rendererå¼•ç”¨é”™è¯¯

**æ£€æŸ¥**ï¼š
- LayerAnimSync â†’ Tool Active States â†’ Element 0: 6
- LayerAnimSync â†’ Tool Sprite Renderer â†’ æ‹–å…¥Handçš„SpriteRenderer

### é—®é¢˜ï¼šHandä¸€ç›´æ˜¾ç¤ºä¸æ¶ˆå¤±

**å¯èƒ½åŸå› **ï¼š
1. SpriteRendereré»˜è®¤å¯ç”¨äº†ï¼ˆâŒ é”™è¯¯ï¼‰
2. Stateæ²¡æœ‰æ­£ç¡®åˆ‡æ¢

**è§£å†³**ï¼š
1. é€‰ä¸­Hand â†’ åœ¨Inspectorä¸­ç¦ç”¨SpriteRenderer
2. æ£€æŸ¥PlayerAnimControlleræ˜¯å¦æ­£ç¡®ç®¡ç†State

### é—®é¢˜ï¼šåŠ¨ç”»ä¸åŒæ­¥

**å¯èƒ½åŸå› **ï¼š
1. LayerAnimSyncçš„å¼•ç”¨é”™è¯¯
2. AnimatorExtensions.csç¼ºå¤±

**æ£€æŸ¥**ï¼š
1. ç¡®è®¤LayerAnimSyncçš„æ‰€æœ‰å¼•ç”¨éƒ½æ­£ç¡®
2. ç¡®è®¤Assets/Scripts/Anim/AnimatorExtensions.cså­˜åœ¨
3. æŸ¥çœ‹Consoleæ˜¯å¦æœ‰æŠ¥é”™

---

## ğŸ“Š é¢„æœŸæ•ˆæœå¯¹æ¯”

### âœ… æ­£ç¡®æ•ˆæœ

```
æ¸¸æˆè¿è¡Œ
  â†“
åªæ˜¾ç¤ºPlayerï¼ˆHandéšè—ï¼‰
  â†“
æŒ‰2é”®æ‰§è¡ŒSlice
  â†“
Handç¬é—´æ˜¾ç¤ºï¼Œä»0å¸§å¼€å§‹
  â†“
Playerå’ŒHandå®Œå…¨åŒæ­¥æŒ¥ç 
  â†“
åŠ¨ç”»ç»“æŸ
  â†“
Handç¬é—´æ¶ˆå¤±
  â†“
åªæ˜¾ç¤ºPlayer
```

### âŒ é”™è¯¯æ•ˆæœ

**æƒ…å†µ1ï¼šHandä¸€ç›´æ˜¾ç¤º**
- åŸå› ï¼šSpriteRendereré»˜è®¤å¯ç”¨
- è§£å†³ï¼šç¦ç”¨SpriteRenderer

**æƒ…å†µ2ï¼šHandæ˜¾ç¤ºä½†ä¸åŠ¨**
- åŸå› ï¼šAnimatoré…ç½®é”™è¯¯
- è§£å†³ï¼šæ£€æŸ¥Tool_Axe.controlleræ˜¯å¦æ­£ç¡®

**æƒ…å†µ3ï¼šåŠ¨ç”»å»¶è¿Ÿ**
- åŸå› ï¼šåŒæ­¥é€»è¾‘é—®é¢˜
- è§£å†³ï¼šæ£€æŸ¥LayerAnimSyncè„šæœ¬

**æƒ…å†µ4ï¼šHandåœ¨Playeråé¢**
- åŸå› ï¼šSorting Orderé”™è¯¯
- è§£å†³ï¼šHandçš„Orderå¿…é¡» > Player

---

## ğŸ¯ æµ‹è¯•å®Œæˆæ ‡å‡†

**âœ… é€šè¿‡æµ‹è¯•éœ€æ»¡è¶³**ï¼š

1. [ ] Handé»˜è®¤éšè—
2. [ ] æŒ‰Q-Yå¯ä»¥åˆ‡æ¢å·¥å…·å“è´¨
3. [ ] æŒ‰2é”®Handç«‹å³æ˜¾ç¤ºå¹¶å¼€å§‹æŒ¥ç 
4. [ ] Playerå’ŒHandåŠ¨ç”»å®Œå…¨åŒæ­¥
5. [ ] åŠ¨ç”»ç»“æŸåHandæ¶ˆå¤±
6. [ ] Handå§‹ç»ˆæ˜¾ç¤ºåœ¨Playerå‰é¢
7. [ ] Consoleæ— é”™è¯¯

**å…¨éƒ¨å‹¾é€‰å³æµ‹è¯•é€šè¿‡ï¼** ğŸ‰

---

## ğŸ’¡ è°ƒè¯•æŠ€å·§

### 1. å¼€å¯Debugæ¨¡å¼

åœ¨LayerAnimSyncä¸­æ·»åŠ è°ƒè¯•ä¿¡æ¯ï¼š

```csharp
// LateUpdateå¼€å§‹å¤„
Debug.Log($"State={currentState}, Hand Visible={toolSpriteRenderer.enabled}");
```

### 2. æ£€æŸ¥åŠ¨ç”»æ—¶é—´

```csharp
// SyncAnimationTimeä¸­
Debug.Log($"Player Time={playerStateInfo.normalizedTime:F3}, Tool Time={toolStateInfo.normalizedTime:F3}");
```

### 3. ç›‘æ§Stateå˜åŒ–

```csharp
// UpdateToolVisibilityä¸­
if (currentState != lastState)
    Debug.Log($"State changed: {lastState} â†’ {currentState}");
```

---

## ğŸš€ æµ‹è¯•é€šè¿‡å

1. **ç§»é™¤æµ‹è¯•ä»£ç **
   - åˆ é™¤PlayerToolControllerçš„Updateä¸­çš„æµ‹è¯•æŒ‰é”®

2. **é›†æˆåˆ°é¡¹ç›®**
   - å°†EquipToolè¿æ¥åˆ°UIç³»ç»Ÿ
   - å°†SliceåŠ¨ä½œè¿æ¥åˆ°è¾“å…¥ç³»ç»Ÿ

3. **ä¼˜åŒ–æ€§èƒ½**
   - ç§»é™¤Debug.Log
   - ç¡®è®¤LateUpdateçš„æ‰§è¡Œé¡ºåº

**ç³»ç»Ÿå°±ç»ªï¼å¯ä»¥æŠ•å…¥ç”Ÿäº§ï¼** âœ¨

